{"version":3,"file":"indoor.js","sources":["../src/geometry/Point.js","../src/core/Constants.js","../node_modules/rollup-plugin-node-globals/src/global.js","../node_modules/process-es6/browser.js","../src/lib/ev-pos.js","../src/lib/impetus.js","../src/lib/MagicScroll.js","../src/lib/mumath/parse-unit.js","../src/lib/mumath/to-px.js","../src/lib/mouse-event-offset.js","../src/lib/touch-pinch.js","../src/lib/raf.js","../src/lib/panzoom.js","../src/lib/mumath/clamp.js","../src/lib/mumath/len.js","../src/lib/mumath/lerp.js","../src/lib/mumath/mod.js","../src/lib/mumath/almost.js","../src/lib/mumath/normalize.js","../src/lib/mumath/precision.js","../src/lib/mumath/round.js","../src/lib/mumath/range.js","../src/lib/mumath/order.js","../src/lib/mumath/log10.js","../src/lib/mumath/is-multiple.js","../src/lib/mumath/scale.js","../src/lib/mumath/is-plain-obj.js","../src/lib/mumath/index.js","../src/core/Base.js","../src/lib/color-alpha.js","../src/grid/gridStyle.js","../src/grid/Axis.js","../src/grid/Grid.js","../src/map/ModesMixin.js","../src/lib/mix.js","../src/map/Map.js","../src/layer/Group.js","../src/layer/Layer.js","../src/floorplan/Floor.js","../src/layer/vector/Line.js","../src/layer/Connector.js","../src/layer/marker/Marker.js","../src/layer/marker/Icon.js","../src/layer/vector/Polyline.js","../src/layer/vector/Circle.js","../src/layer/vector/Rect.js","../src/layer/marker/MarkerGroup.js","../src/paint/Canvas.js","../src/Indoor.js"],"sourcesContent":["export class Point extends fabric.Point {\n  constructor(...params) {\n    let x;\n    let y;\n    if (params.length > 1) {\n      [x, y] = params;\n    } else if (params.length === 0 || !params[0]) {\n      [x, y] = [0, 0];\n    } else if (Object.prototype.hasOwnProperty.call(params[0], 'x')) {\n      x = params[0].x;\n      y = params[0].y;\n    } else if (params[0].length) {\n      [[x, y]] = params;\n    } else {\n      console.error('Parameter for Point is not valid. Use Point(x,y) or Point({x,y}) or Point([x,y])', params);\n    }\n\n    super(x, y);\n  }\n\n  setX(x) {\n    this.x = x || 0;\n  }\n\n  setY(y) {\n    this.y = y || 0;\n  }\n\n  getArray() {\n    return [this.x, this.y];\n  }\n}\n\nexport const point = (...params) => new Point(...params);\n","import { Point } from '../geometry/Point.js';\n\nexport const Modes = {\n  SELECT: 'SELECT',\n  GRAB: 'GRAB',\n  DRAW: 'DRAW'\n};\n\nexport const MAP = {\n  center: new Point(),\n  zoom: 1,\n  minZoom: 0,\n  maxZoom: 20,\n  gridEnabled: true,\n  zoomEnabled: true,\n  selectEnabled: true,\n  mode: Modes.SELECT\n};\n\nexport const MARKER = {\n  position: new Point(),\n  minZoom: 1,\n  maxZoom: 20\n};\n\nexport const ICON = {\n  url:\n    'data:image/png;base64,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',\n  size: [128, 128],\n  anchor: [64, 64]\n};\n\nfabric.Object.prototype.originX = 'center';\nfabric.Object.prototype.originY = 'center';\n\nfabric.Object.prototype.lockUniScaling = true;\nfabric.Object.prototype.lockScalingFlip = true;\nfabric.Object.prototype.transparentCorners = false;\nfabric.Object.prototype.centeredScaling = true;\n// fabric.Object.prototype.cornerStyle = 'circle';\nfabric.Object.prototype.cornerColor = 'blue';\nfabric.Object.prototype.borderColor = 'blue';\nfabric.Object.prototype.borderOpacity = 0.7;\nfabric.Object.prototype.cornerOpacity = 0.7;\nfabric.Object.prototype.cornerStrokeColor = 'blue';\n\nfabric.Object.prototype.borderColor = '#ff0099';\nfabric.Object.prototype.cornerColor = '#00eaff';\nfabric.Object.prototype.cornerStrokeColor = '#00bbff';\n\nfabric.Object.prototype.objectCaching = false;\nfabric.Group.prototype.objectCaching = true;\n\nfabric.Group.prototype.selectionBackgroundColor = 'rgba(45,207,171,0.25)';\n\nfabric.Object.prototype.borderDashArray = [3, 3];\n\nfabric.Object.prototype.padding = 5;\n\nfabric.Object.prototype.getBounds = function getBounds() {\n  const coords = [];\n  coords.push(new Point(this.left - this.width / 2.0, this.top - this.height / 2.0));\n  coords.push(new Point(this.left + this.width / 2.0, this.top + this.height / 2.0));\n  return coords;\n};\n","export default (typeof global !== \"undefined\" ? global :\n            typeof self !== \"undefined\" ? self :\n            typeof window !== \"undefined\" ? window : {});\n","// shim for using process in browser\n// based off https://github.com/defunctzombie/node-process/blob/master/browser.js\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\nvar cachedSetTimeout = defaultSetTimout;\nvar cachedClearTimeout = defaultClearTimeout;\nif (typeof global.setTimeout === 'function') {\n    cachedSetTimeout = setTimeout;\n}\nif (typeof global.clearTimeout === 'function') {\n    cachedClearTimeout = clearTimeout;\n}\n\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\nexport function nextTick(fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n}\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nexport var title = 'browser';\nexport var platform = 'browser';\nexport var browser = true;\nexport var env = {};\nexport var argv = [];\nexport var version = ''; // empty string to avoid regexp issues\nexport var versions = {};\nexport var release = {};\nexport var config = {};\n\nfunction noop() {}\n\nexport var on = noop;\nexport var addListener = noop;\nexport var once = noop;\nexport var off = noop;\nexport var removeListener = noop;\nexport var removeAllListeners = noop;\nexport var emit = noop;\n\nexport function binding(name) {\n    throw new Error('process.binding is not supported');\n}\n\nexport function cwd () { return '/' }\nexport function chdir (dir) {\n    throw new Error('process.chdir is not supported');\n};\nexport function umask() { return 0; }\n\n// from https://github.com/kumavis/browser-process-hrtime/blob/master/index.js\nvar performance = global.performance || {}\nvar performanceNow =\n  performance.now        ||\n  performance.mozNow     ||\n  performance.msNow      ||\n  performance.oNow       ||\n  performance.webkitNow  ||\n  function(){ return (new Date()).getTime() }\n\n// generate timestamp or delta\n// see http://nodejs.org/api/process.html#process_process_hrtime\nexport function hrtime(previousTimestamp){\n  var clocktime = performanceNow.call(performance)*1e-3\n  var seconds = Math.floor(clocktime)\n  var nanoseconds = Math.floor((clocktime%1)*1e9)\n  if (previousTimestamp) {\n    seconds = seconds - previousTimestamp[0]\n    nanoseconds = nanoseconds - previousTimestamp[1]\n    if (nanoseconds<0) {\n      seconds--\n      nanoseconds += 1e9\n    }\n  }\n  return [seconds,nanoseconds]\n}\n\nvar startTime = new Date();\nexport function uptime() {\n  var currentTime = new Date();\n  var dif = currentTime - startTime;\n  return dif / 1000;\n}\n\nexport default {\n  nextTick: nextTick,\n  title: title,\n  browser: browser,\n  env: env,\n  argv: argv,\n  version: version,\n  versions: versions,\n  on: on,\n  addListener: addListener,\n  once: once,\n  off: off,\n  removeListener: removeListener,\n  removeAllListeners: removeAllListeners,\n  emit: emit,\n  binding: binding,\n  cwd: cwd,\n  chdir: chdir,\n  umask: umask,\n  hrtime: hrtime,\n  platform: platform,\n  release: release,\n  config: config,\n  uptime: uptime\n};\n","const isNum = function (val) {\n  return typeof val === 'number' && !isNaN(val);\n};\n\nexport default (ev, toElement) => {\n  toElement = toElement || ev.currentTarget;\n\n  const toElementBoundingRect = toElement.getBoundingClientRect();\n  const orgEv = ev.originalEvent || ev;\n  const hasTouches = ev.touches && ev.touches.length;\n  let pageX = 0;\n  let pageY = 0;\n\n  if (hasTouches) {\n    if (isNum(ev.touches[0].pageX) && isNum(ev.touches[0].pageY)) {\n      pageX = ev.touches[0].pageX;\n      pageY = ev.touches[0].pageY;\n    } else if (isNum(ev.touches[0].clientX) && isNum(ev.touches[0].clientY)) {\n      pageX = orgEv.touches[0].clientX;\n      pageY = orgEv.touches[0].clientY;\n    }\n  } else if (isNum(ev.pageX) && isNum(ev.pageY)) {\n    pageX = ev.pageX;\n    pageY = ev.pageY;\n  } else if (ev.currentPoint && isNum(ev.currentPoint.x) && isNum(ev.currentPoint.y)) {\n    pageX = ev.currentPoint.x;\n    pageY = ev.currentPoint.y;\n  }\n  let isRight = false;\n  if ('which' in ev) {\n    // Gecko (Firefox), WebKit (Safari/Chrome) & Opera\n    isRight = ev.which == 3;\n  } else if ('button' in ev) {\n    // IE, Opera\n    isRight = ev.button == 2;\n  }\n\n  return {\n    x: pageX - toElementBoundingRect.left,\n    y: pageY - toElementBoundingRect.top,\n    isRight\n  };\n};\n","const stopThresholdDefault = 0.3;\nconst bounceDeceleration = 0.04;\nconst bounceAcceleration = 0.11;\n\n// fixes weird safari 10 bug where preventDefault is prevented\n// @see https://github.com/metafizzy/flickity/issues/457#issuecomment-254501356\nwindow.addEventListener('touchmove', () => {});\n\nexport default class Impetus {\n  constructor({\n    source: sourceEl = document,\n    update: updateCallback,\n    stop: stopCallback,\n    multiplier = 1,\n    friction = 0.92,\n    initialValues,\n    boundX,\n    boundY,\n    bounce = true\n  }) {\n    let boundXmin;\n    let boundXmax;\n    let boundYmin;\n    let boundYmax;\n    let pointerLastX;\n    let pointerLastY;\n    let pointerCurrentX;\n    let pointerCurrentY;\n    let pointerId;\n    let decVelX;\n    let decVelY;\n    let targetX = 0;\n    let targetY = 0;\n    let stopThreshold = stopThresholdDefault * multiplier;\n    let ticking = false;\n    let pointerActive = false;\n    let paused = false;\n    let decelerating = false;\n    let trackingPoints = [];\n\n    /**\n     * Initialize instance\n     */\n    (function init() {\n      sourceEl = typeof sourceEl === 'string' ? document.querySelector(sourceEl) : sourceEl;\n      if (!sourceEl) {\n        throw new Error('IMPETUS: source not found.');\n      }\n\n      if (!updateCallback) {\n        throw new Error('IMPETUS: update function not defined.');\n      }\n\n      if (initialValues) {\n        if (initialValues[0]) {\n          targetX = initialValues[0];\n        }\n        if (initialValues[1]) {\n          targetY = initialValues[1];\n        }\n        callUpdateCallback();\n      }\n\n      // Initialize bound values\n      if (boundX) {\n        boundXmin = boundX[0];\n        boundXmax = boundX[1];\n      }\n      if (boundY) {\n        boundYmin = boundY[0];\n        boundYmax = boundY[1];\n      }\n\n      sourceEl.addEventListener('touchstart', onDown);\n      sourceEl.addEventListener('mousedown', onDown);\n    }());\n\n    /**\n     * In edge cases where you may need to\n     * reinstanciate Impetus on the same sourceEl\n     * this will remove the previous event listeners\n     */\n    this.destroy = function () {\n      sourceEl.removeEventListener('touchstart', onDown);\n      sourceEl.removeEventListener('mousedown', onDown);\n\n      cleanUpRuntimeEvents();\n\n      // however it won't \"destroy\" a reference\n      // to instance if you'd like to do that\n      // it returns null as a convinience.\n      // ex: `instance = instance.destroy();`\n      return null;\n    };\n\n    /**\n     * Disable movement processing\n     * @public\n     */\n    this.pause = function () {\n      cleanUpRuntimeEvents();\n\n      pointerActive = false;\n      paused = true;\n    };\n\n    /**\n     * Enable movement processing\n     * @public\n     */\n    this.resume = function () {\n      paused = false;\n    };\n\n    /**\n     * Update the current x and y values\n     * @public\n     * @param {Number} x\n     * @param {Number} y\n     */\n    this.setValues = function (x, y) {\n      if (typeof x === 'number') {\n        targetX = x;\n      }\n      if (typeof y === 'number') {\n        targetY = y;\n      }\n    };\n\n    /**\n     * Update the multiplier value\n     * @public\n     * @param {Number} val\n     */\n    this.setMultiplier = function (val) {\n      multiplier = val;\n      stopThreshold = stopThresholdDefault * multiplier;\n    };\n\n    /**\n     * Update boundX value\n     * @public\n     * @param {Number[]} boundX\n     */\n    this.setBoundX = function (boundX) {\n      boundXmin = boundX[0];\n      boundXmax = boundX[1];\n    };\n\n    /**\n     * Update boundY value\n     * @public\n     * @param {Number[]} boundY\n     */\n    this.setBoundY = function (boundY) {\n      boundYmin = boundY[0];\n      boundYmax = boundY[1];\n    };\n\n    /**\n     * Removes all events set by this instance during runtime\n     */\n    function cleanUpRuntimeEvents() {\n      // Remove all touch events added during 'onDown' as well.\n      document.removeEventListener(\n        'touchmove',\n        onMove,\n        getPassiveSupported() ? { passive: false } : false\n      );\n      document.removeEventListener('touchend', onUp);\n      document.removeEventListener('touchcancel', stopTracking);\n      document.removeEventListener(\n        'mousemove',\n        onMove,\n        getPassiveSupported() ? { passive: false } : false\n      );\n      document.removeEventListener('mouseup', onUp);\n    }\n\n    /**\n     * Add all required runtime events\n     */\n    function addRuntimeEvents() {\n      cleanUpRuntimeEvents();\n\n      // @see https://developers.google.com/web/updates/2017/01/scrolling-intervention\n      document.addEventListener(\n        'touchmove',\n        onMove,\n        getPassiveSupported() ? { passive: false } : false\n      );\n      document.addEventListener('touchend', onUp);\n      document.addEventListener('touchcancel', stopTracking);\n      document.addEventListener(\n        'mousemove',\n        onMove,\n        getPassiveSupported() ? { passive: false } : false\n      );\n      document.addEventListener('mouseup', onUp);\n    }\n\n    /**\n     * Executes the update function\n     */\n    function callUpdateCallback() {\n      updateCallback.call(sourceEl, targetX, targetY);\n    }\n\n    /**\n     * Creates a custom normalized event object from touch and mouse events\n     * @param  {Event} ev\n     * @returns {Object} with x, y, and id properties\n     */\n    function normalizeEvent(ev) {\n      if (ev.type === 'touchmove' || ev.type === 'touchstart' || ev.type === 'touchend') {\n        const touch = ev.targetTouches[0] || ev.changedTouches[0];\n        return {\n          x: touch.clientX,\n          y: touch.clientY,\n          id: touch.identifier\n        };\n      }\n      // mouse events\n      return {\n        x: ev.clientX,\n        y: ev.clientY,\n        id: null\n      };\n    }\n\n    /**\n     * Initializes movement tracking\n     * @param  {Object} ev Normalized event\n     */\n    function onDown(ev) {\n      const event = normalizeEvent(ev);\n      if (!pointerActive && !paused) {\n        pointerActive = true;\n        decelerating = false;\n        pointerId = event.id;\n\n        pointerLastX = pointerCurrentX = event.x;\n        pointerLastY = pointerCurrentY = event.y;\n        trackingPoints = [];\n        addTrackingPoint(pointerLastX, pointerLastY);\n\n        addRuntimeEvents();\n      }\n    }\n\n    /**\n     * Handles move events\n     * @param  {Object} ev Normalized event\n     */\n    function onMove(ev) {\n      ev.preventDefault();\n      const event = normalizeEvent(ev);\n\n      if (pointerActive && event.id === pointerId) {\n        pointerCurrentX = event.x;\n        pointerCurrentY = event.y;\n        addTrackingPoint(pointerLastX, pointerLastY);\n        requestTick();\n      }\n    }\n\n    /**\n     * Handles up/end events\n     * @param {Object} ev Normalized event\n     */\n    function onUp(ev) {\n      const event = normalizeEvent(ev);\n\n      if (pointerActive && event.id === pointerId) {\n        stopTracking();\n      }\n    }\n\n    /**\n     * Stops movement tracking, starts animation\n     */\n    function stopTracking() {\n      pointerActive = false;\n      addTrackingPoint(pointerLastX, pointerLastY);\n      startDecelAnim();\n\n      cleanUpRuntimeEvents();\n    }\n\n    /**\n     * Records movement for the last 100ms\n     * @param {number} x\n     * @param {number} y [description]\n     */\n    function addTrackingPoint(x, y) {\n      const time = Date.now();\n      while (trackingPoints.length > 0) {\n        if (time - trackingPoints[0].time <= 100) {\n          break;\n        }\n        trackingPoints.shift();\n      }\n\n      trackingPoints.push({ x, y, time });\n    }\n\n    /**\n     * Calculate new values, call update function\n     */\n    function updateAndRender() {\n      const pointerChangeX = pointerCurrentX - pointerLastX;\n      const pointerChangeY = pointerCurrentY - pointerLastY;\n\n      targetX += pointerChangeX * multiplier;\n      targetY += pointerChangeY * multiplier;\n\n      if (bounce) {\n        const diff = checkBounds();\n        if (diff.x !== 0) {\n          targetX -= pointerChangeX * dragOutOfBoundsMultiplier(diff.x) * multiplier;\n        }\n        if (diff.y !== 0) {\n          targetY -= pointerChangeY * dragOutOfBoundsMultiplier(diff.y) * multiplier;\n        }\n      } else {\n        checkBounds(true);\n      }\n\n      callUpdateCallback();\n\n      pointerLastX = pointerCurrentX;\n      pointerLastY = pointerCurrentY;\n      ticking = false;\n    }\n\n    /**\n     * Returns a value from around 0.5 to 1, based on distance\n     * @param {Number} val\n     */\n    function dragOutOfBoundsMultiplier(val) {\n      return 0.000005 * Math.pow(val, 2) + 0.0001 * val + 0.55;\n    }\n\n    /**\n     * prevents animating faster than current framerate\n     */\n    function requestTick() {\n      if (!ticking) {\n        requestAnimFrame(updateAndRender);\n      }\n      ticking = true;\n    }\n\n    /**\n     * Determine position relative to bounds\n     * @param {Boolean} restrict Whether to restrict target to bounds\n     */\n    function checkBounds(restrict) {\n      let xDiff = 0;\n      let yDiff = 0;\n\n      if (boundXmin !== undefined && targetX < boundXmin) {\n        xDiff = boundXmin - targetX;\n      } else if (boundXmax !== undefined && targetX > boundXmax) {\n        xDiff = boundXmax - targetX;\n      }\n\n      if (boundYmin !== undefined && targetY < boundYmin) {\n        yDiff = boundYmin - targetY;\n      } else if (boundYmax !== undefined && targetY > boundYmax) {\n        yDiff = boundYmax - targetY;\n      }\n\n      if (restrict) {\n        if (xDiff !== 0) {\n          targetX = xDiff > 0 ? boundXmin : boundXmax;\n        }\n        if (yDiff !== 0) {\n          targetY = yDiff > 0 ? boundYmin : boundYmax;\n        }\n      }\n\n      return {\n        x: xDiff,\n        y: yDiff,\n        inBounds: xDiff === 0 && yDiff === 0\n      };\n    }\n\n    /**\n     * Initialize animation of values coming to a stop\n     */\n    function startDecelAnim() {\n      const firstPoint = trackingPoints[0];\n      const lastPoint = trackingPoints[trackingPoints.length - 1];\n\n      const xOffset = lastPoint.x - firstPoint.x;\n      const yOffset = lastPoint.y - firstPoint.y;\n      const timeOffset = lastPoint.time - firstPoint.time;\n\n      const D = timeOffset / 15 / multiplier;\n\n      decVelX = xOffset / D || 0; // prevent NaN\n      decVelY = yOffset / D || 0;\n\n      const diff = checkBounds();\n\n      if (Math.abs(decVelX) > 1 || Math.abs(decVelY) > 1 || !diff.inBounds) {\n        decelerating = true;\n        requestAnimFrame(stepDecelAnim);\n      } else if (stopCallback) {\n        stopCallback(sourceEl);\n      }\n    }\n\n    /**\n     * Animates values slowing down\n     */\n    function stepDecelAnim() {\n      if (!decelerating) {\n        return;\n      }\n\n      decVelX *= friction;\n      decVelY *= friction;\n\n      targetX += decVelX;\n      targetY += decVelY;\n\n      const diff = checkBounds();\n\n      if (\n        Math.abs(decVelX) > stopThreshold\n        || Math.abs(decVelY) > stopThreshold\n        || !diff.inBounds\n      ) {\n        if (bounce) {\n          const reboundAdjust = 2.5;\n\n          if (diff.x !== 0) {\n            if (diff.x * decVelX <= 0) {\n              decVelX += diff.x * bounceDeceleration;\n            } else {\n              const adjust = diff.x > 0 ? reboundAdjust : -reboundAdjust;\n              decVelX = (diff.x + adjust) * bounceAcceleration;\n            }\n          }\n          if (diff.y !== 0) {\n            if (diff.y * decVelY <= 0) {\n              decVelY += diff.y * bounceDeceleration;\n            } else {\n              const adjust = diff.y > 0 ? reboundAdjust : -reboundAdjust;\n              decVelY = (diff.y + adjust) * bounceAcceleration;\n            }\n          }\n        } else {\n          if (diff.x !== 0) {\n            if (diff.x > 0) {\n              targetX = boundXmin;\n            } else {\n              targetX = boundXmax;\n            }\n            decVelX = 0;\n          }\n          if (diff.y !== 0) {\n            if (diff.y > 0) {\n              targetY = boundYmin;\n            } else {\n              targetY = boundYmax;\n            }\n            decVelY = 0;\n          }\n        }\n\n        callUpdateCallback();\n\n        requestAnimFrame(stepDecelAnim);\n      } else {\n        decelerating = false;\n        if (stopCallback) {\n          stopCallback(sourceEl);\n        }\n      }\n    }\n  }\n}\n\n/**\n * @see http://www.paulirish.com/2011/requestanimationframe-for-smart-animating/\n */\nconst requestAnimFrame = (function () {\n  return (\n    window.requestAnimationFrame\n    || window.webkitRequestAnimationFrame\n    || window.mozRequestAnimationFrame\n    || function (callback) {\n      window.setTimeout(callback, 1000 / 60);\n    }\n  );\n}());\n\nfunction getPassiveSupported() {\n  let passiveSupported = false;\n\n  try {\n    const options = Object.defineProperty({}, 'passive', {\n      get() {\n        passiveSupported = true;\n      }\n    });\n\n    window.addEventListener('test', null, options);\n  } catch (err) {}\n\n  getPassiveSupported = () => passiveSupported;\n  return passiveSupported;\n}\n","class MagicScroll {\n  constructor(target, speed = 80, smooth = 12, current = 0, passive = false) {\n    if (target === document) {\n      target = document.scrollingElement\n        || document.documentElement\n        || document.body.parentNode\n        || document.body;\n    } // cross browser support for document scrolling\n\n    this.speed = speed;\n    this.smooth = smooth;\n    this.moving = false;\n    this.scrollTop = current * 3000;\n    this.pos = this.scrollTop;\n    this.frame = target === document.body && document.documentElement ? document.documentElement : target; // safari is the new IE\n\n    target.addEventListener('wheel', scrolled, { passive });\n    target.addEventListener('DOMMouseScroll', scrolled, { passive });\n    const scope = this;\n    function scrolled(e) {\n      e.preventDefault(); // disable default scrolling\n\n      const delta = scope.normalizeWheelDelta(e);\n\n      scope.pos += -delta * scope.speed;\n      // scope.pos = Math.max(0, Math.min(scope.pos, 3000)); // limit scrolling\n\n      if (!scope.moving) scope.update(e);\n    }\n  }\n\n  normalizeWheelDelta(e) {\n    if (e.detail) {\n      if (e.wheelDelta) return (e.wheelDelta / e.detail / 40) * (e.detail > 0 ? 1 : -1);\n      // Opera\n      return -e.detail / 3; // Firefox\n    }\n    return e.wheelDelta / 120; // IE,Safari,Chrome\n  }\n\n  update(e) {\n    this.moving = true;\n\n    const delta = (this.pos - this.scrollTop) / this.smooth;\n\n    this.scrollTop += delta;\n\n    // this.scrollTop = Math.round(this.scrollTop);\n\n    if (this.onUpdate) {\n      this.onUpdate(delta, e);\n    }\n    const scope = this;\n    if (Math.abs(delta) > 1) {\n      requestFrame(() => {\n        scope.update();\n      });\n    } else this.moving = false;\n  }\n}\n\nexport default MagicScroll;\n\nvar requestFrame = (function () {\n  // requestAnimationFrame cross browser\n  return (\n    window.requestAnimationFrame\n    || window.webkitRequestAnimationFrame\n    || window.mozRequestAnimationFrame\n    || window.oRequestAnimationFrame\n    || window.msRequestAnimationFrame\n    || function (func) {\n      window.setTimeout(func, 1000);\n    }\n  );\n}());\n","export default (str, out) => {\n  if (!out)\n      out = [ 0, '' ]\n\n  str = String(str)\n  var num = parseFloat(str, 10)\n  out[0] = num\n  out[1] = str.match(/[\\d.\\-\\+]*\\s*(.*)/)[1] || ''\n  return out\n}","// (c) 2015 Mikola Lysenko. MIT License\n// https://github.com/mikolalysenko/to-px\n\nimport parseUnit from './parse-unit';\n\nvar PIXELS_PER_INCH = 96\n\nvar defaults = {\n  'ch': 8,\n  'ex': 7.15625,\n  'em': 16,\n  'rem': 16,\n  'in': PIXELS_PER_INCH,\n  'cm': PIXELS_PER_INCH / 2.54,\n  'mm': PIXELS_PER_INCH / 25.4,\n  'pt': PIXELS_PER_INCH / 72,\n  'pc': PIXELS_PER_INCH / 6,\n  'px': 1\n}\n\nexport default function toPX(str) {\n  if (!str) return null\n\n  if (defaults[str]) return defaults[str]\n\n  // detect number of units\n  var parts = parseUnit(str)\n  if (!isNaN(parts[0]) && parts[1]) {\n    var px = toPX(parts[1])\n    return typeof px === 'number' ? parts[0] * px : null;\n  }\n\n  return null;\n}","var rootPosition = { left: 0, top: 0 }\n\nexport default mouseEventOffset\nfunction mouseEventOffset (ev, target, out) {\n  target = target || ev.currentTarget || ev.srcElement\n  if (!Array.isArray(out)) {\n    out = [ 0, 0 ]\n  }\n  var cx = ev.clientX || 0\n  var cy = ev.clientY || 0\n  var rect = getBoundingClientOffset(target)\n  out[0] = cx - rect.left\n  out[1] = cy - rect.top\n  return out\n}\n\nfunction getBoundingClientOffset (element) {\n  if (element === window ||\n      element === document ||\n      element === document.body) {\n    return rootPosition\n  } else {\n    return element.getBoundingClientRect()\n  }\n}\n","import EventEmitter2 from 'eventemitter2';\nimport eventOffset from './mouse-event-offset';\n\nfunction distance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1]\n  return Math.sqrt(x*x + y*y)\n}\n\nexport default touchPinch;\nfunction touchPinch (target) {\n  target = target || window\n\n  var emitter = new EventEmitter2()\n  var fingers = [ null, null ]\n  var activeCount = 0\n\n  var lastDistance = 0\n  var ended = false\n  var enabled = false\n\n  // some read-only values\n  Object.defineProperties(emitter, {\n    pinching(){\n      return activeCount === 2\n    },\n\n    fingers() {\n      return fingers\n    }\n  })\n\n  enable()\n  emitter.enable = enable\n  emitter.disable = disable\n  emitter.indexOfTouch = indexOfTouch\n  return emitter\n\n  function indexOfTouch (touch) {\n    var id = touch.identifier\n    for (var i = 0; i < fingers.length; i++) {\n      if (fingers[i] &&\n        fingers[i].touch &&\n        fingers[i].touch.identifier === id) {\n        return i\n      }\n    }\n    return -1\n  }\n\n  function enable () {\n    if (enabled) return\n    enabled = true\n    target.addEventListener('touchstart', onTouchStart, false)\n    target.addEventListener('touchmove', onTouchMove, false)\n    target.addEventListener('touchend', onTouchRemoved, false)\n    target.addEventListener('touchcancel', onTouchRemoved, false)\n  }\n\n  function disable () {\n    if (!enabled) return\n    enabled = false\n    activeCount = 0\n    fingers[0] = null\n    fingers[1] = null\n    lastDistance = 0\n    ended = false\n    target.removeEventListener('touchstart', onTouchStart, false)\n    target.removeEventListener('touchmove', onTouchMove, false)\n    target.removeEventListener('touchend', onTouchRemoved, false)\n    target.removeEventListener('touchcancel', onTouchRemoved, false)\n  }\n\n  function onTouchStart (ev) {\n    for (var i = 0; i < ev.changedTouches.length; i++) {\n      var newTouch = ev.changedTouches[i]\n      var id = newTouch.identifier\n      var idx = indexOfTouch(id)\n\n      if (idx === -1 && activeCount < 2) {\n        var first = activeCount === 0\n\n        // newest and previous finger (previous may be undefined)\n        var newIndex = fingers[0] ? 1 : 0\n        var oldIndex = fingers[0] ? 0 : 1\n        var newFinger = new Finger()\n\n        // add to stack\n        fingers[newIndex] = newFinger\n        activeCount++\n\n        // update touch event & position\n        newFinger.touch = newTouch\n        eventOffset(newTouch, target, newFinger.position)\n\n        var oldTouch = fingers[oldIndex] ? fingers[oldIndex].touch : undefined\n        emitter.emit('place', newTouch, oldTouch)\n\n        if (!first) {\n          var initialDistance = computeDistance()\n          ended = false\n          emitter.emit('start', initialDistance)\n          lastDistance = initialDistance\n        }\n      }\n    }\n  }\n\n  function onTouchMove (ev) {\n    var changed = false\n    for (var i = 0; i < ev.changedTouches.length; i++) {\n      var movedTouch = ev.changedTouches[i]\n      var idx = indexOfTouch(movedTouch)\n      if (idx !== -1) {\n        changed = true\n        fingers[idx].touch = movedTouch // avoid caching touches\n        eventOffset(movedTouch, target, fingers[idx].position)\n      }\n    }\n\n    if (activeCount === 2 && changed) {\n      var currentDistance = computeDistance()\n      emitter.emit('change', currentDistance, lastDistance)\n      lastDistance = currentDistance\n    }\n  }\n\n  function onTouchRemoved (ev) {\n    for (var i = 0; i < ev.changedTouches.length; i++) {\n      var removed = ev.changedTouches[i]\n      var idx = indexOfTouch(removed)\n\n      if (idx !== -1) {\n        fingers[idx] = null\n        activeCount--\n        var otherIdx = idx === 0 ? 1 : 0\n        var otherTouch = fingers[otherIdx] ? fingers[otherIdx].touch : undefined\n        emitter.emit('lift', removed, otherTouch)\n      }\n    }\n\n    if (!ended && activeCount !== 2) {\n      ended = true\n      emitter.emit('end')\n    }\n  }\n\n  function computeDistance () {\n    if (activeCount < 2) return 0\n    return distance(fingers[0].position, fingers[1].position)\n  }\n}\n\nfunction Finger () {\n  this.position = [0, 0]\n  this.touch = null\n}\n","function getPrefixed(name) {\n\treturn window['webkit' + name] || window['moz' + name] || window['ms' + name];\n}\n\nvar lastTime = 0;\n\n// fallback for IE 7-8\nfunction timeoutDefer(fn) {\n\tvar time = +new Date(),\n\t    timeToCall = Math.max(0, 16 - (time - lastTime));\n\n\tlastTime = time + timeToCall;\n\treturn window.setTimeout(fn, timeToCall);\n}\n\nexport function bind(fn, obj) {\n\tvar slice = Array.prototype.slice;\n\n\tif (fn.bind) {\n\t\treturn fn.bind.apply(fn, slice.call(arguments, 1));\n\t}\n\n\tvar args = slice.call(arguments, 2);\n\n\treturn function () {\n\t\treturn fn.apply(obj, args.length ? args.concat(slice.call(arguments)) : arguments);\n\t};\n}\n\nexport var requestFn = window.requestAnimationFrame || getPrefixed('RequestAnimationFrame') || timeoutDefer;\nexport var cancelFn = window.cancelAnimationFrame || getPrefixed('CancelAnimationFrame') ||\n\t\tgetPrefixed('CancelRequestAnimationFrame') || function (id) { window.clearTimeout(id); };\n\nconst raf = (fn, context, immediate) =>{\n\tif (immediate && requestFn === timeoutDefer) {\n\t\tfn.call(context);\n\t} else {\n\t\treturn requestFn.call(window, bind(fn, context));\n\t}\n} \n\nraf.cancel = (id) => {\n\tif (id) {\n\t\tcancelFn.call(window, id);\n\t}\n}\n\nexport default raf;","import evPos from './ev-pos';\nimport Impetus from './impetus';\nimport wheel from './mouse-wheel';\nimport touchPinch from './touch-pinch';\nimport raf from './raf';\nimport MagicScroll from './MagicScroll';\n\nconst panzoom = (target, cb) => {\n  if (target instanceof Function) {\n    cb = target;\n    target = document.documentElement || document.body;\n  }\n\n  if (typeof target === 'string') target = document.querySelector(target);\n\n  let cursor = {\n    x: 0,\n    y: 0\n  };\n\n  const hasPassive = () => {\n    let supported = false;\n\n    try {\n      const opts = Object.defineProperty({}, 'passive', {\n        get() {\n          supported = true;\n        }\n      });\n\n      window.addEventListener('test', null, opts);\n      window.removeEventListener('test', null, opts);\n    } catch (e) {\n      supported = false;\n    }\n\n    return supported;\n  };\n\n  let impetus;\n  let magicScroll;\n\n  let initX = 0;\n  let initY = 0;\n  let init = true;\n  const initFn = function (e) {\n    init = true;\n  };\n  target.addEventListener('mousedown', initFn);\n  target.addEventListener('mousemove', e => {\n    cursor = evPos(e);\n  });\n  target.addEventListener('wheel', e => {\n    if (e) {\n      cursor = evPos(e);\n    }\n  });\n  target.addEventListener('touchstart', initFn, hasPassive() ? { passive: true } : false);\n\n  target.addEventListener(\n    'contextmenu',\n    e => {\n      e.preventDefault();\n      return false;\n    },\n    false\n  );\n\n  let lastY = 0;\n  let lastX = 0;\n  impetus = new Impetus({\n    source: target,\n    update(x, y) {\n      if (init) {\n        init = false;\n        initX = cursor.x;\n        initY = cursor.y;\n      }\n\n      const e = {\n        target,\n        type: 'mouse',\n        dx: x - lastX,\n        dy: y - lastY,\n        dz: 0,\n        x: cursor.x,\n        y: cursor.y,\n        x0: initX,\n        y0: initY,\n        isRight: cursor.isRight\n      };\n\n      lastX = x;\n      lastY = y;\n\n      schedule(e);\n    },\n    stop() {\n      const ev = {\n        target,\n        type: 'mouse',\n        dx: 0,\n        dy: 0,\n        dz: 0,\n        x: cursor.x,\n        y: cursor.y,\n        x0: initX,\n        y0: initY\n      };\n      schedule(ev);\n    },\n    multiplier: 1,\n    friction: 0.75\n  });\n\n  magicScroll = new MagicScroll(target, 80, 12, 0);\n\n  magicScroll.onUpdate = (dy, e) => {\n    schedule({\n      target,\n      type: 'mouse',\n      dx: 0,\n      dy: 0,\n      dz: dy,\n      x: cursor.x,\n      y: cursor.y,\n      x0: cursor.x,\n      y0: cursor.y\n    });\n  };\n\n  // mobile pinch zoom\n  const pinch = touchPinch(target);\n  const mult = 2;\n  let initialCoords;\n\n  pinch.on('start', curr => {\n    const f1 = pinch.fingers[0];\n    const f2 = pinch.fingers[1];\n\n    initialCoords = [\n      f2.position[0] * 0.5 + f1.position[0] * 0.5,\n      f2.position[1] * 0.5 + f1.position[1] * 0.5\n    ];\n\n    impetus && impetus.pause();\n  });\n  pinch.on('end', () => {\n    if (!initialCoords) return;\n\n    initialCoords = null;\n\n    impetus && impetus.resume();\n  });\n  pinch.on('change', (curr, prev) => {\n    if (!pinch.pinching || !initialCoords) return;\n\n    schedule({\n      target,\n      type: 'touch',\n      dx: 0,\n      dy: 0,\n      dz: -(curr - prev) * mult,\n      x: initialCoords[0],\n      y: initialCoords[1],\n      x0: initialCoords[0],\n      y0: initialCoords[0]\n    });\n  });\n\n  // schedule function to current or next frame\n  let planned;\n  let frameId;\n  function schedule(ev) {\n    if (frameId != null) {\n      if (!planned) planned = ev;\n      else {\n        planned.dx += ev.dx;\n        planned.dy += ev.dy;\n        planned.dz += ev.dz;\n\n        planned.x = ev.x;\n        planned.y = ev.y;\n      }\n\n      return;\n    }\n\n    // Firefox sometimes does not clear webgl current drawing buffer\n    // so we have to schedule callback to the next frame, not the current\n    // cb(ev)\n\n    frameId = raf(() => {\n      cb(ev);\n      frameId = null;\n      if (planned) {\n        const arg = planned;\n        planned = null;\n        schedule(arg);\n      }\n    });\n  }\n\n  return function unpanzoom() {\n    target.removeEventListener('mousedown', initFn);\n    target.removeEventListener('wheel');\n    target.removeEventListener('touchstart', initFn);\n\n    impetus.destroy();\n\n    target.removeEventListener('wheel', wheelListener);\n\n    pinch.disable();\n\n    raf.cancel(frameId);\n  };\n};\n\nexport default panzoom;\n","/**\n * Clamp value.\n * Detects proper clamp min/max.\n *\n * @param {number} a Current value to cut off\n * @param {number} min One side limit\n * @param {number} max Other side limit\n *\n * @return {number} Clamped value\n */\n\nfunction clamp(a, min, max) {\n\treturn max > min ? Math.max(Math.min(a,max),min) : Math.max(Math.min(a,min),max);\n};\n\nexport default clamp;\n","/**\n * Return quadratic length\n *\n * @module  mumath/len\n *\n */\n\nexport default function len(a, b) {\n\treturn Math.sqrt(a*a + b*b);\n};\n","/**\n * @module mumath/lerp\n */\n'use strict';\nexport default function (x, y, a) {\n\treturn x * (1.0 - a) + y * a;\n};\n","/**\n * Looping function for any framesize.\n * Like fmod.\n *\n * @module  mumath/loop\n *\n */\n\nexport default function (value, left, right) {\n\t//detect single-arg case, like mod-loop or fmod\n\tif (right === undefined) {\n\t\tright = left;\n\t\tleft = 0;\n\t}\n\n\t//swap frame order\n\tif (left > right) {\n\t\tvar tmp = right;\n\t\tright = left;\n\t\tleft = tmp;\n\t}\n\n\tvar frame = right - left;\n\n\tvalue = ((value + left) % frame) - left;\n\tif (value < left) value += frame;\n\tif (value > right) value -= frame;\n\n\treturn value;\n};\n","\n// Type definitions for almost-equal 1.1\n// Project: https://github.com/mikolalysenko/almost-equal#readme\n// Definitions by: Curtis Maddalozzo <https://github.com/cmaddalozzo>\n// Definitions: https://github.com/DefinitelyTyped/DefinitelyTyped\n\nvar abs = Math.abs;\nvar min = Math.min;\n\nfunction almostEqual(a, b, absoluteError, relativeError) {\n  var d = abs(a - b)\n  \n  if (absoluteError == null) absoluteError = almostEqual.DBL_EPSILON;\n  if (relativeError == null) relativeError = absoluteError;\n  \n  if(d <= absoluteError) {\n    return true\n  }\n  if(d <= relativeError * min(abs(a), abs(b))) {\n    return true\n  }\n  return a === b\n}\n\nexport const FLT_EPSILON = 1.19209290e-7\nexport const DBL_EPSILON = 2.2204460492503131e-16\n\nalmostEqual.FLT_EPSILON = FLT_EPSILON;\nalmostEqual.DBL_EPSILON = DBL_EPSILON;\n\nexport default almostEqual;","/**\n * Get rid of float remainder\n *\n * @module mumath/normalize\n */\n'use strict';\n\nimport { FLT_EPSILON } from './almost';\n\nexport default function(value, eps) {\n\t//ignore ints\n\tvar rem = value%1;\n\tif (!rem) return value;\n\n\tif (eps == null) eps = Number.EPSILON || FLT_EPSILON;\n\n\t//pick number’s neighbour, which is way shorter, like 0.4999999999999998 → 0.5\n\t//O(20)\n\tvar range = 5;\n\tvar len = (rem+'').length;\n\n\tfor (var i = 1; i < range; i+=.5) {\n\t\tvar left = rem - eps*i,\n\t\t\tright = rem + eps*i;\n\n\t\tvar leftStr = left+'', rightStr = right + '';\n\n\t\tif (len - leftStr.length > 2) return value - eps*i;\n\t\tif (len - rightStr.length > 2) return value + eps*i;\n\n\t\t// if (leftStr[2] != rightStr[2])\n\t}\n\n\treturn value;\n};\n","/**\n * @module  mumath/precision\n *\n * Get precision from float:\n *\n * @example\n * 1.1 → 1, 1234 → 0, .1234 → 4\n *\n * @param {number} n\n *\n * @return {number} decimap places\n */\n'use strict';\n\nimport almost from './almost';\nimport norm from './normalize';\n\nexport default function (n, eps) {\n\tn = norm(n);\n\n\tvar str = n + '';\n\n\t//1e-10 etc\n\tvar e = str.indexOf('e-');\n\tif (e >= 0) return parseInt(str.substring(e+2));\n\n\t//imperfect ints, like 3.0000000000000004 or 1.9999999999999998\n\tvar remainder = Math.abs(n % 1);\n\tvar remStr = remainder + '';\n\n\tif (almost(remainder, 1, eps) || almost(remainder, 0, eps)) return 0;\n\n\t//usual floats like .0123\n\tvar d = remStr.indexOf('.') + 1;\n\n\tif (d) return remStr.length - d;\n\n\t//regular inte\n\treturn 0;\n};\n","/**\n * Precision round\n *\n * @param {number} value\n * @param {number} step Minimal discrete to round\n *\n * @return {number}\n *\n * @example\n * toPrecision(213.34, 1) == 213\n * toPrecision(213.34, .1) == 213.3\n * toPrecision(213.34, 10) == 210\n */\n'use strict';\nimport precision from './precision';\n\nexport default function(value, step) {\n\tif (step === 0) return value;\n\tif (!step) return Math.round(value);\n\tvalue = Math.round(value / step) * step;\n\treturn parseFloat(value.toFixed(precision(step)));\n};\n","// The MIT License (MIT)\n\n// Copyright (c) 2016 angus croll\n\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n\n// The above copyright notice and this permission notice shall be included in all\n// copies or substantial portions of the Software.\n\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n// SOFTWARE.\n\n/*\n  range(0, 5); // [0, 1, 2, 3, 4]\n  range(5); // [0, 1, 2, 3, 4]\n  range(-5); // [0, -1, -2, -3, -4]\n  range(0, 20, 5) // [0, 5, 10, 15]\n  range(0, -20, -5) // [0, -5, -10, -15]\n*/\n\nexport default function range(start, stop, step) {\n  if (start != null && typeof start != 'number') {\n    throw new Error('start must be a number or null');\n  }\n  if (stop != null && typeof stop != 'number') {\n    throw new Error('stop must be a number or null');\n  }\n  if (step != null && typeof step != 'number') {\n    throw new Error('step must be a number or null');\n  }\n  if (stop == null) {\n    stop = start || 0;\n    start = 0;\n  }\n  if (step == null) {\n    step = stop > start ? 1 : -1;\n  }\n  var toReturn = [];\n  var increasing = start < stop; //← here’s the change\n  for (; increasing ? start < stop : start > stop; start += step) {\n    toReturn.push(start);\n  }\n  return toReturn;\n}","/**\n * @module mumath/order\n */\nexport default function (n) {\n\tn = Math.abs(n);\n\tvar order = Math.floor(Math.log(n) / Math.LN10 + 0.000000001);\n\treturn Math.pow(10,order);\n};\n","/**\n * Base 10 logarithm\n *\n * @module mumath/log10\n */\n'use strict';\nexport default Math.log10 || function (a) {\n\treturn Math.log(a) / Math.log(10);\n};\n","/**\n * Check if one number is multiple of other\n *\n * @module  mumath/is-multiple\n */\n\nimport almost from './almost';\n\nexport default function isMultiple(a, b, eps) {\n\tvar remainder = a % b;\n\n\tif (!eps) eps = almost.FLT_EPSILON;\n\n\tif (!remainder) return true;\n\tif (almost(0, remainder, eps, 0) || almost(Math.abs(b), Math.abs(remainder), eps, 0)) return true;\n\n\treturn false;\n}\n","/**\n * Get step out of the set\n *\n * @module mumath/step\n */\n'use strict';\n\nimport lg from './log10';\n\nexport default function (minStep, srcSteps) {\n\tvar power = Math.floor(lg(minStep));\n\n\tvar order = Math.pow(10, power);\n\tvar steps = srcSteps.map(v => v*order);\n\torder = Math.pow(10, power+1);\n\tsteps = steps.concat(srcSteps.map(v => v*order));\n\n\t//find closest scale\n\tvar step = 0;\n\tfor (var i = 0; i < steps.length; i++) {\n\t\tstep = steps[i];\n\t\tif (step >= minStep) break;\n\t}\n\n\treturn step;\n};\n","/**\n * MIT © Sindre Sorhus\n * https://github.com/sindresorhus/is-plain-obj/blob/master/index.js\n */\nexport default (value) => {\n\tif (Object.prototype.toString.call(value) !== '[object Object]') {\n\t\treturn false;\n\t}\n\n\tconst prototype = Object.getPrototypeOf(value);\n\treturn prototype === null || prototype === Object.getPrototypeOf({});\n};\n","/**\n * Composed set of all math utils, wrapped\n *\n * @module  mumath\n */\n\nexport { default as clamp } from './clamp';\nexport { default as len } from './len';\nexport { default as lerp } from './lerp';\nexport { default as mod } from './mod';\nexport { default as round } from './round';\nexport { default as range } from './range';\nexport { default as order } from './order';\nexport { default as normalize } from './normalize';\nexport { default as almost } from './almost';\nexport { default as lg } from './log10';\nexport { default as isMultiple } from './is-multiple';\nexport { default as scale } from './scale';\nexport { default as pad } from './left-pad';\nexport { default as parseUnit } from './parse-unit';\nexport { default as toPx } from './to-px';\nexport { default as isObj } from './is-plain-obj';","import EventEmitter2 from 'eventemitter2';\n\nclass Base extends EventEmitter2 {\n  constructor(options) {\n    super(options);\n    this._options = options || {};\n    Object.assign(this, options);\n  }\n}\n\nexport default Base;\n","export default alpha;\n\nfunction alpha (color, value) {\n\tlet obj = color.replace(/[^\\d,]/g, '').split(',');\n  if (value == null) value = obj[3] || 1;\n  obj[3] = value;\n\treturn 'rgba('+obj.join(',')+')';\n}\n","/* eslint-disable consistent-return */\nimport alpha from '../lib/color-alpha';\nimport {\n  range, almost, scale, isMultiple, lg\n} from '../lib/mumath/index';\n\nconst gridStyle = {\n  steps: [1, 2, 5],\n  distance: 20,\n  unit: 10,\n  lines: (state) => {\n    const coord = state.coordinate;\n    // eslint-disable-next-line no-multi-assign\n    const step = state.step = scale(coord.distance * coord.zoom, coord.steps);\n    return range(Math.floor(state.offset / step) * step,\n      Math.ceil((state.offset + state.range) / step + 1) * step, step);\n  },\n  lineColor: (state) => {\n    if (!state.lines) return;\n    const coord = state.coordinate;\n\n    const light = alpha(coord.color, 0.1);\n    const heavy = alpha(coord.color, 0.3);\n\n    const step = state.step;\n    const power = Math.ceil(lg(step));\n    const tenStep = 10 ** power;\n    const nextStep = 10 ** (power + 1);\n    const eps = step / 10;\n    const colors = state.lines.map(v => {\n      if (isMultiple(v, nextStep, eps)) return heavy;\n      if (isMultiple(v, tenStep, eps)) return light;\n      return null;\n    });\n    return colors;\n  },\n  ticks: state => {\n    if (!state.lines) return;\n    const coord = state.coordinate;\n    const step = scale(scale(state.step * 1.1, coord.steps) * 1.1, coord.steps);\n    const eps = step / 10;\n    const tickWidth = state.axisWidth * 4;\n    return state.lines.map(v => {\n      if (!isMultiple(v, step, eps)) return null;\n      if (almost(v, 0, eps)) return null;\n      return tickWidth;\n    });\n  },\n  labels: state => {\n    if (!state.lines) return;\n    const coord = state.coordinate;\n\n    const step = scale(scale(state.step * 1.1, coord.steps) * 1.1, coord.steps);\n    // let precision = clamp(Math.abs(Math.floor(lg(step))), 10, 20);\n    const eps = step / 100;\n    return state.lines.map(v => {\n      if (!isMultiple(v, step, eps)) return null;\n      if (almost(v, 0, eps)) return coord.orientation === 'y' ? null : '0';\n      v = Number((v / 100).toFixed(2));\n      return coord.format(v);\n    });\n  }\n};\n\nexport default gridStyle;\n","class Axis {\n  constructor(orientation, options) {\n    Object.assign(this, options);\n    this.orientation = orientation || 'x';\n  }\n\n  getCoords(values) {\n    const coords = [];\n    if (!values) return coords;\n    for (let i = 0; i < values.length; i += 1) {\n      const t = this.getRatio(values[i]);\n      coords.push(t);\n      coords.push(0);\n      coords.push(t);\n      coords.push(1);\n    }\n    return coords;\n  }\n\n  getRange() {\n    let len = this.width;\n    if (this.orientation === 'y') len = this.height;\n    return len * this.zoom;\n  }\n\n  getRatio(value) {\n    return (value - this.offset) / this.range;\n  }\n\n  setOffset(offset) {\n    this.offset = offset;\n  }\n\n  update(options) {\n    options = options || {};\n    Object.assign(this, options);\n\n    this.range = this.getRange();\n  }\n}\nexport default Axis;\n","import alpha from '../lib/color-alpha';\nimport Base from '../core/Base';\nimport {\n  clamp, almost, len, parseUnit, toPx, isObj\n} from '../lib/mumath/index';\nimport gridStyle from './gridStyle';\nimport Axis from './Axis';\nimport { Point } from '../geometry/Point';\n\n// constructor\nclass Grid extends Base {\n  constructor(canvas, opts) {\n    super(opts);\n    this.canvas = canvas;\n    this.context = this.canvas.getContext('2d');\n    this.state = {};\n    this.setDefaults();\n    this.update(opts);\n  }\n\n  render() {\n    this.draw();\n    return this;\n  }\n\n  getCenterCoords() {\n    let state = this.state.x;\n    let [width, height] = state.shape;\n    let [pt, pr, pb, pl] = state.padding;\n    let axisCoords = state.opposite.coordinate.getCoords(\n      [state.coordinate.axisOrigin],\n      state.opposite\n    );\n    const y = pt + axisCoords[1] * (height - pt - pb);\n    state = this.state.y;\n    [width, height] = state.shape;\n    [pt, pr, pb, pl] = state.padding;\n    axisCoords = state.opposite.coordinate.getCoords([state.coordinate.axisOrigin], state.opposite);\n    const x = pl + axisCoords[0] * (width - pr - pl);\n    return { x, y };\n  }\n\n  setSize(width, height) {\n    this.setWidth(width);\n    this.setHeight(height);\n  }\n\n  setWidth(width) {\n    this.canvas.width = width;\n  }\n\n  setHeight(height) {\n    this.canvas.height = height;\n  }\n\n  // re-evaluate lines, calc options for renderer\n  update(opts) {\n    if (!opts) opts = {};\n    const shape = [this.canvas.width, this.canvas.height];\n\n    // recalc state\n    this.state.x = this.calcCoordinate(this.axisX, shape, this);\n    this.state.y = this.calcCoordinate(this.axisY, shape, this);\n    this.state.x.opposite = this.state.y;\n    this.state.y.opposite = this.state.x;\n    this.emit('update', opts);\n    return this;\n  }\n\n  // re-evaluate lines, calc options for renderer\n  update2(center) {\n    const shape = [this.canvas.width, this.canvas.height];\n    Object.assign(this.center, center);\n    // recalc state\n    this.state.x = this.calcCoordinate(this.axisX, shape, this);\n    this.state.y = this.calcCoordinate(this.axisY, shape, this);\n    this.state.x.opposite = this.state.y;\n    this.state.y.opposite = this.state.x;\n    this.emit('update', center);\n\n    this.axisX.offset = center.x;\n    this.axisX.zoom = 1 / center.zoom;\n\n    this.axisY.offset = center.y;\n    this.axisY.zoom = 1 / center.zoom;\n  }\n\n  // get state object with calculated params, ready for rendering\n  calcCoordinate(coord, shape) {\n    const state = {\n      coordinate: coord,\n      shape,\n      grid: this\n    };\n    // calculate real offset/range\n    state.range = coord.getRange(state);\n    state.offset = clamp(\n      coord.offset - state.range * clamp(0.5, 0, 1),\n      Math.max(coord.min, -Number.MAX_VALUE + 1),\n      Math.min(coord.max, Number.MAX_VALUE) - state.range\n    );\n\n    state.zoom = coord.zoom;\n    // calc style\n    state.axisColor = typeof coord.axisColor === 'number'\n      ? alpha(coord.color, coord.axisColor)\n      : coord.axisColor || coord.color;\n\n    state.axisWidth = coord.axisWidth || coord.lineWidth;\n    state.lineWidth = coord.lineWidth;\n    state.tickAlign = coord.tickAlign;\n    state.labelColor = state.color;\n    // get padding\n    if (typeof coord.padding === 'number') {\n      state.padding = Array(4).fill(coord.padding);\n    } else if (coord.padding instanceof Function) {\n      state.padding = coord.padding(state);\n    } else {\n      state.padding = coord.padding;\n    }\n    // calc font\n    if (typeof coord.fontSize === 'number') {\n      state.fontSize = coord.fontSize;\n    } else {\n      const units = parseUnit(coord.fontSize);\n      state.fontSize = units[0] * toPx(units[1]);\n    }\n    state.fontFamily = coord.fontFamily || 'sans-serif';\n    // get lines stops, including joined list of values\n    let lines;\n    if (coord.lines instanceof Function) {\n      lines = coord.lines(state);\n    } else {\n      lines = coord.lines || [];\n    }\n    state.lines = lines;\n    // calc colors\n    if (coord.lineColor instanceof Function) {\n      state.lineColors = coord.lineColor(state);\n    } else if (Array.isArray(coord.lineColor)) {\n      state.lineColors = coord.lineColor;\n    } else {\n      let color = alpha(coord.color, coord.lineColor);\n      if (typeof coord.lineColor !== 'number') {\n        color = coord.lineColor === false || coord.lineColor == null ? null : coord.color;\n      }\n      state.lineColors = Array(lines.length).fill(color);\n    }\n    // calc ticks\n    let ticks;\n    if (coord.ticks instanceof Function) {\n      ticks = coord.ticks(state);\n    } else if (Array.isArray(coord.ticks)) {\n      ticks = coord.ticks;\n    } else {\n      const tick = coord.ticks === true || coord.ticks === true\n        ? state.axisWidth * 2 : coord.ticks || 0;\n      ticks = Array(lines.length).fill(tick);\n    }\n    state.ticks = ticks;\n    // calc labels\n    let labels;\n    if (coord.labels === true) labels = state.lines;\n    else if (coord.labels instanceof Function) {\n      labels = coord.labels(state);\n    } else if (Array.isArray(coord.labels)) {\n      labels = coord.labels;\n    } else if (isObj(coord.labels)) {\n      labels = coord.labels;\n    } else {\n      labels = Array(state.lines.length).fill(null);\n    }\n    state.labels = labels;\n    // convert hashmap ticks/labels to lines + colors\n    if (isObj(ticks)) {\n      state.ticks = Array(lines.length).fill(0);\n    }\n    if (isObj(labels)) {\n      state.labels = Array(lines.length).fill(null);\n    }\n    if (isObj(ticks)) {\n      // eslint-disable-next-line guard-for-in\n      Object.keys(ticks).forEach((value, tick) => {\n        state.ticks.push(tick);\n        state.lines.push(parseFloat(value));\n        state.lineColors.push(null);\n        state.labels.push(null);\n      });\n    }\n\n    if (isObj(labels)) {\n      Object.keys(labels).forEach((label, value) => {\n        state.labels.push(label);\n        state.lines.push(parseFloat(value));\n        state.lineColors.push(null);\n        state.ticks.push(null);\n      });\n    }\n\n    return state;\n  }\n\n  setDefaults() {\n    this.pixelRatio = window.devicePixelRatio;\n    this.autostart = true;\n    this.interactions = true;\n\n    this.defaults = Object.assign(\n      {\n        type: 'linear',\n        name: '',\n        units: '',\n        state: {},\n\n        // visible range params\n        minZoom: -Infinity,\n        maxZoom: Infinity,\n        min: -Infinity,\n        max: Infinity,\n        offset: 0,\n        origin: 0.5,\n        center: {\n          x: 0,\n          y: 0,\n          zoom: 1\n        },\n        zoom: 1,\n        zoomEnabled: true,\n        panEnabled: true,\n\n        // labels\n        labels: true,\n        fontSize: '11pt',\n        fontFamily: 'sans-serif',\n        padding: 0,\n        color: 'rgb(0,0,0,1)',\n\n        // lines params\n        lines: true,\n        tick: 8,\n        tickAlign: 0.5,\n        lineWidth: 1,\n        distance: 13,\n        style: 'lines',\n        lineColor: 0.4,\n\n        // axis params\n        axis: true,\n        axisOrigin: 0,\n        axisWidth: 2,\n        axisColor: 0.8,\n\n        // stub methods\n        // return coords for the values, redefined by axes\n        getCoords: () => [0, 0, 0, 0],\n\n        // return 0..1 ratio based on value/offset/range, redefined by axes\n        getRatio: () => 0,\n\n        // default label formatter\n        format: v => v\n      },\n      gridStyle,\n      this._options\n    );\n\n    this.axisX = new Axis('x', this.defaults);\n    this.axisY = new Axis('y', this.defaults);\n\n    this.axisX = Object.assign({}, this.defaults, {\n      orientation: 'x',\n      offset: this.center.x,\n      getCoords: (values, state) => {\n        const coords = [];\n        if (!values) return coords;\n        for (let i = 0; i < values.length; i += 1) {\n          const t = state.coordinate.getRatio(values[i], state);\n          coords.push(t);\n          coords.push(0);\n          coords.push(t);\n          coords.push(1);\n        }\n        return coords;\n      },\n      getRange: state => state.shape[0] * state.coordinate.zoom,\n      // FIXME: handle infinity case here\n      getRatio: (value, state) => (value - state.offset) / state.range\n    });\n    this.axisY = Object.assign({}, this.defaults, {\n      orientation: 'y',\n      offset: this.center.y,\n      getCoords: (values, state) => {\n        const coords = [];\n        if (!values) return coords;\n        for (let i = 0; i < values.length; i += 1) {\n          const t = state.coordinate.getRatio(values[i], state);\n          coords.push(0);\n          coords.push(t);\n          coords.push(1);\n          coords.push(t);\n        }\n        return coords;\n      },\n      getRange: state => state.shape[1] * state.coordinate.zoom,\n      getRatio: (value, state) => 1 - (value - state.offset) / state.range\n    });\n\n    Object.assign(this, this.defaults);\n    Object.assign(this, this._options);\n\n    this.center = new Point(this.center);\n  }\n\n  // draw grid to the canvas\n  draw() {\n    this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    this.drawLines(this.state.x);\n    this.drawLines(this.state.y);\n    return this;\n  }\n\n  // lines instance draw\n  drawLines(state) {\n    // draw lines and sublines\n    if (!state || !state.coordinate) return;\n\n    const ctx = this.context;\n    const [width, height] = state.shape;\n    const left = 0;\n    const top = 0;\n    const [pt, pr, pb, pl] = state.padding;\n\n    let axisRatio = state.opposite.coordinate.getRatio(state.coordinate.axisOrigin, state.opposite);\n    axisRatio = clamp(axisRatio, 0, 1);\n    const coords = state.coordinate.getCoords(state.lines, state);\n    // draw state.lines\n    ctx.lineWidth = 1; // state.lineWidth/2.;\n    for (let i = 0, j = 0; i < coords.length; i += 4, j += 1) {\n      const color = state.lineColors[j];\n      if (!color) continue;\n      ctx.strokeStyle = color;\n      ctx.beginPath();\n      const x1 = left + pl + coords[i] * (width - pr - pl);\n      const y1 = top + pt + coords[i + 1] * (height - pb - pt);\n      const x2 = left + pl + coords[i + 2] * (width - pr - pl);\n      const y2 = top + pt + coords[i + 3] * (height - pb - pt);\n      ctx.moveTo(x1, y1);\n      ctx.lineTo(x2, y2);\n      ctx.stroke();\n      ctx.closePath();\n    }\n    const normals = [];\n    for (let i = 0; i < coords.length; i += 4) {\n      const x1 = coords[i];\n      const y1 = coords[i + 1];\n      const x2 = coords[i + 2];\n      const y2 = coords[i + 3];\n      const xDif = x2 - x1;\n      const yDif = y2 - y1;\n      const dist = len(xDif, yDif);\n      normals.push(xDif / dist);\n      normals.push(yDif / dist);\n    }\n    // calc state.labels/tick coords\n    const tickCoords = [];\n    state.labelCoords = [];\n    const ticks = state.ticks;\n    for (let i = 0, j = 0, k = 0; i < normals.length; k += 1, i += 2, j += 4) {\n      const x1 = coords[j];\n      const y1 = coords[j + 1];\n      const x2 = coords[j + 2];\n      const y2 = coords[j + 3];\n      const xDif = (x2 - x1) * axisRatio;\n      const yDif = (y2 - y1) * axisRatio;\n      const tick = [\n        (normals[i] * ticks[k]) / (width - pl - pr),\n        (normals[i + 1] * ticks[k]) / (height - pt - pb)\n      ];\n      tickCoords.push(normals[i] * (xDif + tick[0] * state.tickAlign) + x1);\n      tickCoords.push(normals[i + 1] * (yDif + tick[1] * state.tickAlign) + y1);\n      tickCoords.push(normals[i] * (xDif - tick[0] * (1 - state.tickAlign)) + x1);\n      tickCoords.push(normals[i + 1] * (yDif - tick[1] * (1 - state.tickAlign)) + y1);\n      state.labelCoords.push(normals[i] * xDif + x1);\n      state.labelCoords.push(normals[i + 1] * yDif + y1);\n    }\n    // draw ticks\n    if (ticks.length) {\n      ctx.lineWidth = state.axisWidth / 2;\n      ctx.beginPath();\n      for (let i = 0, j = 0; i < tickCoords.length; i += 4, j += 1) {\n        if (almost(state.lines[j], state.opposite.coordinate.axisOrigin)) continue;\n        const x1 = left + pl + tickCoords[i] * (width - pl - pr);\n        const y1 = top + pt + tickCoords[i + 1] * (height - pt - pb);\n        const x2 = left + pl + tickCoords[i + 2] * (width - pl - pr);\n        const y2 = top + pt + tickCoords[i + 3] * (height - pt - pb);\n        ctx.moveTo(x1, y1);\n        ctx.lineTo(x2, y2);\n      }\n      ctx.strokeStyle = state.axisColor;\n      ctx.stroke();\n      ctx.closePath();\n    }\n    // draw axis\n    if (state.coordinate.axis && state.axisColor) {\n      const axisCoords = state.opposite.coordinate.getCoords(\n        [state.coordinate.axisOrigin],\n        state.opposite\n      );\n      ctx.lineWidth = state.axisWidth / 2;\n      const x1 = left + pl + clamp(axisCoords[0], 0, 1) * (width - pr - pl);\n      const y1 = top + pt + clamp(axisCoords[1], 0, 1) * (height - pt - pb);\n      const x2 = left + pl + clamp(axisCoords[2], 0, 1) * (width - pr - pl);\n      const y2 = top + pt + clamp(axisCoords[3], 0, 1) * (height - pt - pb);\n      ctx.beginPath();\n      ctx.moveTo(x1, y1);\n      ctx.lineTo(x2, y2);\n      ctx.strokeStyle = state.axisColor;\n      ctx.stroke();\n      ctx.closePath();\n    }\n    // draw state.labels\n    this.drawLabels(state);\n  }\n\n  drawLabels(state) {\n    if (state.labels) {\n      const ctx = this.context;\n      const [width, height] = state.shape;\n      const [pt, pr, pb, pl] = state.padding;\n\n      ctx.font = `300 ${state.fontSize}px ${state.fontFamily}`;\n      ctx.fillStyle = state.labelColor;\n      ctx.textBaseline = 'top';\n      const textHeight = state.fontSize;\n      const indent = state.axisWidth + 1.5;\n      const textOffset = state.tickAlign < 0.5\n        ? -textHeight - state.axisWidth * 2 : state.axisWidth * 2;\n      const isOpp = state.coordinate.orientation === 'y' && !state.opposite.disabled;\n      for (let i = 0; i < state.labels.length; i += 1) {\n        let label = state.labels[i];\n        if (label == null) continue;\n\n        if (isOpp && almost(state.lines[i], state.opposite.coordinate.axisOrigin)) continue;\n\n        const textWidth = ctx.measureText(label).width;\n\n        let textLeft = state.labelCoords[i * 2] * (width - pl - pr) + indent + pl;\n\n        if (state.coordinate.orientation === 'y') {\n          textLeft = clamp(textLeft, indent, width - textWidth - 1 - state.axisWidth);\n          label *= -1;\n        }\n\n        let textTop = state.labelCoords[i * 2 + 1] * (height - pt - pb) + textOffset + pt;\n        if (state.coordinate.orientation === 'x') {\n          textTop = clamp(textTop, 0, height - textHeight - textOffset);\n        }\n        ctx.fillText(label, textLeft, textTop);\n      }\n    }\n  }\n}\n\nexport default Grid;\n","import { Modes } from '../core/Constants';\n\nconst ModesMixin = superclass => class extends superclass {\n  /**\n     * MODES\n     */\n  setMode(mode) {\n    this.mode = mode;\n\n    switch (mode) {\n      case Modes.SELECT:\n        this.canvas.isDrawingMode = false;\n        this.canvas.interactive = true;\n        this.canvas.selection = true;\n        this.canvas.hoverCursor = 'default';\n        this.canvas.moveCursor = 'default';\n        this.canvas.setCursor('default');\n        break;\n      case Modes.GRAB:\n        this.canvas.isDrawingMode = false;\n        this.canvas.interactive = false;\n        this.canvas.selection = false;\n        this.canvas.discardActiveObject();\n        this.canvas.hoverCursor = 'move';\n        this.canvas.moveCursor = 'move';\n        this.canvas.setCursor('move');\n        break;\n      case Modes.DRAW:\n        this.canvas.isDrawingMode = true;\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  setModeAsDraw() {\n    this.setMode(Modes.DRAW);\n  }\n\n  setModeAsSelect() {\n    this.setMode(Modes.SELECT);\n  }\n\n  setModeAsGrab() {\n    this.setMode(Modes.GRAB);\n  }\n\n  isSelectMode() {\n    return this.mode === Modes.SELECT;\n  }\n\n  isGrabMode() {\n    return this.mode === Modes.GRAB;\n  }\n\n  isDrawMode() {\n    return this.mode === Modes.DRAW;\n  }\n};\n\nexport default ModesMixin;\n","'use strict';\n\n// used by apply() and isApplicationOf()\nconst _appliedMixin = '__mixwith_appliedMixin';\n\n/**\n * A function that returns a subclass of its argument.\n *\n * @example\n * const M = (superclass) => class extends superclass {\n *   getMessage() {\n *     return \"Hello\";\n *   }\n * }\n *\n * @typedef {Function} MixinFunction\n * @param {Function} superclass\n * @return {Function} A subclass of `superclass`\n */\n\n/**\n * Applies `mixin` to `superclass`.\n *\n * `apply` stores a reference from the mixin application to the unwrapped mixin\n * to make `isApplicationOf` and `hasMixin` work.\n *\n * This function is usefull for mixin wrappers that want to automatically enable\n * {@link hasMixin} support.\n *\n * @example\n * const Applier = (mixin) => wrap(mixin, (superclass) => apply(superclass, mixin));\n *\n * // M now works with `hasMixin` and `isApplicationOf`\n * const M = Applier((superclass) => class extends superclass {});\n *\n * class C extends M(Object) {}\n * let i = new C();\n * hasMixin(i, M); // true\n *\n * @function\n * @param {Function} superclass A class or constructor function\n * @param {MixinFunction} mixin The mixin to apply\n * @return {Function} A subclass of `superclass` produced by `mixin`\n */\nexport const apply = (superclass, mixin) => {\n  let application = mixin(superclass);\n  application.prototype[_appliedMixin] = unwrap(mixin);\n  return application;\n};\n\n/**\n * Returns `true` iff `proto` is a prototype created by the application of\n * `mixin` to a superclass.\n *\n * `isApplicationOf` works by checking that `proto` has a reference to `mixin`\n * as created by `apply`.\n *\n * @function\n * @param {Object} proto A prototype object created by {@link apply}.\n * @param {MixinFunction} mixin A mixin function used with {@link apply}.\n * @return {boolean} whether `proto` is a prototype created by the application of\n * `mixin` to a superclass\n */\nexport const isApplicationOf = (proto, mixin) =>\n  proto.hasOwnProperty(_appliedMixin) && proto[_appliedMixin] === unwrap(mixin);\n\n/**\n * Returns `true` iff `o` has an application of `mixin` on its prototype\n * chain.\n *\n * @function\n * @param {Object} o An object\n * @param {MixinFunction} mixin A mixin applied with {@link apply}\n * @return {boolean} whether `o` has an application of `mixin` on its prototype\n * chain\n */\nexport const hasMixin = (o, mixin) => {\n  while (o != null) {\n    if (isApplicationOf(o, mixin)) return true;\n    o = Object.getPrototypeOf(o);\n  }\n  return false;\n}\n\n\n// used by wrap() and unwrap()\nconst _wrappedMixin = '__mixwith_wrappedMixin';\n\n/**\n * Sets up the function `mixin` to be wrapped by the function `wrapper`, while\n * allowing properties on `mixin` to be available via `wrapper`, and allowing\n * `wrapper` to be unwrapped to get to the original function.\n *\n * `wrap` does two things:\n *   1. Sets the prototype of `mixin` to `wrapper` so that properties set on\n *      `mixin` inherited by `wrapper`.\n *   2. Sets a special property on `mixin` that points back to `mixin` so that\n *      it can be retreived from `wrapper`\n *\n * @function\n * @param {MixinFunction} mixin A mixin function\n * @param {MixinFunction} wrapper A function that wraps {@link mixin}\n * @return {MixinFunction} `wrapper`\n */\nexport const wrap = (mixin, wrapper) => {\n  Object.setPrototypeOf(wrapper, mixin);\n  if (!mixin[_wrappedMixin]) {\n    mixin[_wrappedMixin] = mixin;\n  }\n  return wrapper;\n};\n\n/**\n * Unwraps the function `wrapper` to return the original function wrapped by\n * one or more calls to `wrap`. Returns `wrapper` if it's not a wrapped\n * function.\n *\n * @function\n * @param {MixinFunction} wrapper A wrapped mixin produced by {@link wrap}\n * @return {MixinFunction} The originally wrapped mixin\n */\nexport const unwrap = (wrapper) => wrapper[_wrappedMixin] || wrapper;\n\nconst _cachedApplications = '__mixwith_cachedApplications';\n\n/**\n * Decorates `mixin` so that it caches its applications. When applied multiple\n * times to the same superclass, `mixin` will only create one subclass, memoize\n * it and return it for each application.\n *\n * Note: If `mixin` somehow stores properties its classes constructor (static\n * properties), or on its classes prototype, it will be shared across all\n * applications of `mixin` to a super class. It's reccomended that `mixin` only\n * access instance state.\n *\n * @function\n * @param {MixinFunction} mixin The mixin to wrap with caching behavior\n * @return {MixinFunction} a new mixin function\n */\nexport const Cached = (mixin) => wrap(mixin, (superclass) => {\n  // Get or create a symbol used to look up a previous application of mixin\n  // to the class. This symbol is unique per mixin definition, so a class will have N\n  // applicationRefs if it has had N mixins applied to it. A mixin will have\n  // exactly one _cachedApplicationRef used to store its applications.\n\n  let cachedApplications = superclass[_cachedApplications];\n  if (!cachedApplications) {\n    cachedApplications = superclass[_cachedApplications] = new Map();\n  }\n\n  let application = cachedApplications.get(mixin);\n  if (!application) {\n    application = mixin(superclass);\n    cachedApplications.set(mixin, application);\n  }\n\n  return application;\n});\n\n/**\n * Decorates `mixin` so that it only applies if it's not already on the\n * prototype chain.\n *\n * @function\n * @param {MixinFunction} mixin The mixin to wrap with deduplication behavior\n * @return {MixinFunction} a new mixin function\n */\nexport const DeDupe = (mixin) => wrap(mixin, (superclass) =>\n    (hasMixin(superclass.prototype, mixin))\n      ? superclass\n      : mixin(superclass));\n\n/**\n * Adds [Symbol.hasInstance] (ES2015 custom instanceof support) to `mixin`.\n *\n * @function\n * @param {MixinFunction} mixin The mixin to add [Symbol.hasInstance] to\n * @return {MixinFunction} the given mixin function\n */\nexport const HasInstance = (mixin) => {\n  if (Symbol && Symbol.hasInstance && !mixin[Symbol.hasInstance]) {\n    Object.defineProperty(mixin, Symbol.hasInstance, {\n      value(o) {\n        return hasMixin(o, mixin);\n      },\n    });\n  }\n  return mixin;\n};\n\n/**\n * A basic mixin decorator that applies the mixin with {@link apply} so that it\n * can be used with {@link isApplicationOf}, {@link hasMixin} and the other\n * mixin decorator functions.\n *\n * @function\n * @param {MixinFunction} mixin The mixin to wrap\n * @return {MixinFunction} a new mixin function\n */\nexport const BareMixin = (mixin) => wrap(mixin, (s) => apply(s, mixin));\n\n/**\n * Decorates a mixin function to add deduplication, application caching and\n * instanceof support.\n *\n * @function\n * @param {MixinFunction} mixin The mixin to wrap\n * @return {MixinFunction} a new mixin function\n */\nexport const Mixin = (mixin) => DeDupe(Cached(BareMixin(mixin)));\n\n/**\n * A fluent interface to apply a list of mixins to a superclass.\n *\n * ```javascript\n * class X extends mix(Object).with(A, B, C) {}\n * ```\n *\n * The mixins are applied in order to the superclass, so the prototype chain\n * will be: X->C'->B'->A'->Object.\n *\n * This is purely a convenience function. The above example is equivalent to:\n *\n * ```javascript\n * class X extends C(B(A(Object))) {}\n * ```\n *\n * @function\n * @param {Function} [superclass=Object]\n * @return {MixinBuilder}\n */\nexport const mix = (superclass) => new MixinBuilder(superclass);\n\nclass MixinBuilder {\n\n  constructor(superclass) {\n    this.superclass = superclass || class {};\n  }\n\n  /**\n   * Applies `mixins` in order to the superclass given to `mix()`.\n   *\n   * @param {Array.<Mixin>} mixins\n   * @return {Function} a subclass of `superclass` with `mixins` applied\n   */\n  with(...mixins) {\n    return mixins.reduce((c, m) => m(c), this.superclass);\n  }\n}","import panzoom from '../lib/panzoom';\nimport { clamp } from '../lib/mumath/index';\n\nimport Base from '../core/Base';\nimport { MAP, Modes } from '../core/Constants';\nimport Grid from '../grid/Grid';\nimport { Point } from '../geometry/Point';\nimport ModesMixin from './ModesMixin';\nimport { mix } from '../lib/mix';\n\nexport class Map extends mix(Base).with(ModesMixin) {\n  constructor(container, options) {\n    super(options);\n\n    this.defaults = Object.assign({}, MAP);\n\n    // set defaults\n    Object.assign(this, this.defaults);\n\n    // overwrite options\n    Object.assign(this, this._options);\n\n    this.center = new Point(this.center);\n\n    this.container = container || document.body;\n\n    const canvas = document.createElement('canvas');\n    this.container.appendChild(canvas);\n    canvas.setAttribute('id', 'indoors-map-canvas');\n\n    canvas.width = this.width || this.container.clientWidth;\n    canvas.height = this.height || this.container.clientHeight;\n\n    this.canvas = new fabric.Canvas(canvas, {\n      preserveObjectStacking: true\n    });\n    this.context = this.canvas.getContext('2d');\n\n    this.on('render', () => {\n      if (this.autostart) this.clear();\n    });\n\n    this.originX = -this.canvas.width / 2;\n    this.originY = -this.canvas.height / 2;\n\n    this.canvas.absolutePan({\n      x: this.originX,\n      y: this.originY\n    });\n\n    // this.center = {\n    //   x: this.canvas.width / 2.0,\n    //   y: this.canvas.height / 2.0\n    // };\n\n    this.x = this.center.x;\n    this.y = this.center.y;\n    this.dx = 0;\n    this.dy = 0;\n\n    try {\n      this.addFloorPlan();\n    } catch (e) {\n      console.error(e);\n    }\n    this.addGrid();\n\n    this.setMode(this.mode || Modes.GRAB);\n\n    const vm = this;\n    panzoom(this.container, e => {\n      vm.panzoom(e);\n    });\n\n    this.registerListeners();\n\n    setTimeout(() => {\n      this.emit('ready', this);\n    }, 300);\n  }\n\n  addFloorPlan() {\n    if (!this.floorplan) return;\n    const vm = this;\n    this.floorplan.on('load', img => {\n      vm.addLayer(img);\n    });\n  }\n\n  addLayer(layer) {\n    if (!layer.shape) {\n      console.error('shape is undefined');\n      return;\n    }\n    this.canvas.add(layer.shape);\n    this.canvas._objects.sort((o1, o2) => o1.zIndex - o2.zIndex);\n\n    if (layer.shape.keepOnZoom) {\n      const scale = 1.0 / this.zoom;\n      layer.shape.set('scaleX', scale);\n      layer.shape.set('scaleY', scale);\n      layer.shape.setCoords();\n      this.emit(`${layer.class}scaling`, layer);\n    }\n    if (layer.class) {\n      this.emit(`${layer.class}:added`, layer);\n    }\n\n    // this.update();\n    this.canvas.renderAll();\n  }\n\n  removeLayer(layer) {\n    if (!layer || !layer.shape) return;\n    if (layer.class) {\n      this.emit(`${layer.class}:removed`, layer);\n    }\n    this.canvas.remove(layer.shape);\n  }\n\n  addGrid() {\n    this.gridCanvas = this.cloneCanvas();\n    this.gridCanvas.setAttribute('id', 'indoors-grid-canvas');\n    this.grid = new Grid(this.gridCanvas, this);\n    this.grid.draw();\n  }\n\n  moveTo(obj, index) {\n    if (index !== undefined) {\n      obj.zIndex = index;\n    }\n    this.canvas.moveTo(obj.shape, obj.zIndex);\n  }\n\n  cloneCanvas(canvas) {\n    canvas = canvas || this.canvas;\n    const clone = document.createElement('canvas');\n    clone.width = canvas.width;\n    clone.height = canvas.height;\n    canvas.wrapperEl.appendChild(clone);\n    return clone;\n  }\n\n  setZoom(zoom) {\n    const { width, height } = this.canvas;\n    this.zoom = clamp(zoom, this.minZoom, this.maxZoom);\n    this.dx = 0;\n    this.dy = 0;\n    this.x = width / 2.0;\n    this.y = height / 2.0;\n    this.update();\n    process.nextTick(() => {\n      this.update();\n    });\n  }\n\n  getBounds() {\n    let minX = Infinity;\n    let maxX = -Infinity;\n    let minY = Infinity;\n    let maxY = -Infinity;\n\n    this.canvas.forEachObject(obj => {\n      const coords = obj.getBounds();\n\n      coords.forEach(point => {\n        minX = Math.min(minX, point.x);\n        maxX = Math.max(maxX, point.x);\n        minY = Math.min(minY, point.y);\n        maxY = Math.max(maxY, point.y);\n      });\n    });\n\n    return [new Point(minX, minY), new Point(maxX, maxY)];\n  }\n\n  fitBounds(padding = 100) {\n    this.onResize();\n\n    const { width, height } = this.canvas;\n\n    this.originX = -this.canvas.width / 2;\n    this.originY = -this.canvas.height / 2;\n\n    const bounds = this.getBounds();\n\n    this.center.x = (bounds[0].x + bounds[1].x) / 2.0;\n    this.center.y = -(bounds[0].y + bounds[1].y) / 2.0;\n\n    const boundWidth = Math.abs(bounds[0].x - bounds[1].x) + padding;\n    const boundHeight = Math.abs(bounds[0].y - bounds[1].y) + padding;\n    const scaleX = width / boundWidth;\n    const scaleY = height / boundHeight;\n\n    this.zoom = Math.min(scaleX, scaleY);\n\n    this.canvas.setZoom(this.zoom);\n\n    this.canvas.absolutePan({\n      x: this.originX + this.center.x * this.zoom,\n      y: this.originY - this.center.y * this.zoom\n    });\n\n    this.update();\n    process.nextTick(() => {\n      this.update();\n    });\n  }\n\n  setCursor(cursor) {\n    this.container.style.cursor = cursor;\n  }\n\n  reset() {\n    const { width, height } = this.canvas;\n    this.zoom = this._options.zoom || 1;\n    this.center = new Point();\n    this.originX = -this.canvas.width / 2;\n    this.originY = -this.canvas.height / 2;\n    this.canvas.absolutePan({\n      x: this.originX,\n      y: this.originY\n    });\n    this.x = width / 2.0;\n    this.y = height / 2.0;\n    this.update();\n    process.nextTick(() => {\n      this.update();\n    });\n  }\n\n  onResize(width, height) {\n    const oldWidth = this.canvas.width;\n    const oldHeight = this.canvas.height;\n\n    width = width || this.container.clientWidth;\n    height = height || this.container.clientHeight;\n\n    this.canvas.setWidth(width);\n    this.canvas.setHeight(height);\n\n    this.grid.setSize(width, height);\n\n    const dx = width / 2.0 - oldWidth / 2.0;\n    const dy = height / 2.0 - oldHeight / 2.0;\n\n    this.canvas.relativePan({\n      x: dx,\n      y: dy\n    });\n\n    this.update();\n  }\n\n  update() {\n    const canvas = this.canvas;\n\n    this.grid.update2({\n      x: this.center.x,\n      y: this.center.y,\n      zoom: this.zoom\n    });\n\n    this.emit('update', this);\n    this.grid.render();\n\n    canvas.zoomToPoint(new Point(this.x, this.y), this.zoom);\n\n    if (this.isGrabMode() || this.isRight) {\n      canvas.relativePan(new Point(this.dx, this.dy));\n      this.emit('panning');\n      this.setCursor('grab');\n    } else {\n      this.setCursor('pointer');\n    }\n\n    const objects = canvas.getObjects();\n    let hasKeepZoom = false;\n    for (let i = 0; i < objects.length; i += 1) {\n      const object = objects[i];\n      if (object.keepOnZoom) {\n        object.set('scaleX', 1.0 / this.zoom);\n        object.set('scaleY', 1.0 / this.zoom);\n        object.setCoords();\n        hasKeepZoom = true;\n        this.emit(`${object.class}scaling`, object);\n      }\n    }\n    if (hasKeepZoom) canvas.renderAll();\n  }\n\n  panzoom(e) {\n    // enable interactions\n    const { width, height } = this.canvas;\n    // shift start\n    const zoom = clamp(-e.dz, -height * 0.75, height * 0.75) / height;\n\n    const prevZoom = 1 / this.zoom;\n    let curZoom = prevZoom * (1 - zoom);\n    curZoom = clamp(curZoom, this.minZoom, this.maxZoom);\n\n    let { x, y } = this.center;\n\n    // pan\n    const oX = 0.5;\n    const oY = 0.5;\n    if (this.isGrabMode() || e.isRight) {\n      x -= prevZoom * e.dx;\n      y += prevZoom * e.dy;\n      this.setCursor('grab');\n    } else {\n      this.setCursor('pointer');\n    }\n\n    if (this.zoomEnabled) {\n      const tx = e.x / width - oX;\n      x -= width * (curZoom - prevZoom) * tx;\n      const ty = oY - e.y / height;\n      y -= height * (curZoom - prevZoom) * ty;\n    }\n    this.center.setX(x);\n    this.center.setY(y);\n    this.zoom = 1 / curZoom;\n    this.dx = e.dx;\n    this.dy = e.dy;\n    this.x = e.x0;\n    this.y = e.y0;\n    this.isRight = e.isRight;\n    console.log(this.dx, this.dy);\n    this.update();\n  }\n\n  registerListeners() {\n    const vm = this;\n\n    this.canvas.on('object:scaling', e => {\n      if (e.target.class) {\n        vm.emit(`${e.target.class}:scaling`, e.target.parent);\n        e.target.parent.emit('scaling', e.target.parent);\n        return;\n      }\n      const group = e.target;\n      if (!group.getObjects) return;\n\n      const objects = group.getObjects();\n      group.removeWithUpdate();\n      for (let i = 0; i < objects.length; i += 1) {\n        const object = objects[i];\n        object.orgYaw = object.parent.yaw || 0;\n        object.fire('moving', object.parent);\n        vm.emit(`${object.class}:moving`, object.parent);\n      }\n      vm.update();\n      vm.canvas.renderAll();\n    });\n\n    this.canvas.on('object:rotating', e => {\n      if (e.target.class) {\n        vm.emit(`${e.target.class}:rotating`, e.target.parent, e.target.angle);\n        e.target.parent.emit('rotating', e.target.parent, e.target.angle);\n        return;\n      }\n      const group = e.target;\n      if (!group.getObjects) return;\n      const objects = group.getObjects();\n      for (let i = 0; i < objects.length; i += 1) {\n        const object = objects[i];\n        if (object.class === 'marker') {\n          object._set('angle', -group.angle);\n          object.parent.yaw = -group.angle + (object.orgYaw || 0);\n          // object.orgYaw = object.parent.yaw;\n          object.fire('moving', object.parent);\n          vm.emit(`${object.class}:moving`, object.parent);\n          object.fire('rotating', object.parent);\n          vm.emit(`${object.class}:rotating`, object.parent);\n        }\n      }\n      this.update();\n    });\n\n    this.canvas.on('object:moving', e => {\n      if (e.target.class) {\n        vm.emit(`${e.target.class}:moving`, e.target.parent);\n        e.target.parent.emit('moving', e.target.parent);\n        return;\n      }\n      const group = e.target;\n      if (!group.getObjects) return;\n      const objects = group.getObjects();\n      for (let i = 0; i < objects.length; i += 1) {\n        const object = objects[i];\n        if (object.class) {\n          object.fire('moving', object.parent);\n          vm.emit(`${object.class}:moving`, object.parent);\n        }\n      }\n      this.update();\n    });\n\n    this.canvas.on('object:moved', e => {\n      if (e.target.class) {\n        vm.emit(`${e.target.class}dragend`, e);\n        vm.emit(`${e.target.class}:moved`, e.target.parent);\n        e.target.parent.emit('moved', e.target.parent);\n        this.update();\n        return;\n      }\n      const group = e.target;\n      if (!group.getObjects) return;\n      const objects = group.getObjects();\n      for (let i = 0; i < objects.length; i += 1) {\n        const object = objects[i];\n        if (object.class) {\n          object.fire('moved', object.parent);\n          vm.emit(`${object.class}:moved`, object.parent);\n        }\n      }\n      this.update();\n    });\n\n    this.canvas.on('selection:cleared', e => {\n      const objects = e.deselected;\n      if (!objects || !objects.length) return;\n      for (let i = 0; i < objects.length; i += 1) {\n        const object = objects[i];\n        if (object.class === 'marker') {\n          object._set('angle', 0);\n          object._set('scaleX', 1 / vm.zoom);\n          object._set('scaleY', 1 / vm.zoom);\n          if (object.parent) {\n            object.parent.inGroup = false;\n          }\n          object.fire('moving', object.parent);\n        }\n      }\n    });\n    this.canvas.on('selection:created', e => {\n      const objects = e.selected;\n      if (!objects || objects.length < 2) return;\n      for (let i = 0; i < objects.length; i += 1) {\n        const object = objects[i];\n        if (object.class && object.parent) {\n          object.parent.inGroup = true;\n          object.orgYaw = object.parent.yaw || 0;\n        }\n      }\n    });\n    this.canvas.on('selection:updated', e => {\n      const objects = e.selected;\n      if (!objects || objects.length < 2) return;\n      for (let i = 0; i < objects.length; i += 1) {\n        const object = objects[i];\n        if (object.class && object.parent) {\n          object.parent.inGroup = true;\n          object.orgYaw = object.parent.yaw || 0;\n        }\n      }\n    });\n\n    this.canvas.on('mouse:down', e => {\n      vm.dragObject = e.target;\n    });\n\n    this.canvas.on('mouse:move', e => {\n      if (vm.dragObject && vm.dragObject.clickable) {\n        if (vm.dragObject === e.target) {\n          vm.dragObject.dragging = true;\n        } else {\n          vm.dragObject.dragging = false;\n        }\n      }\n      this.isRight = false;\n      if ('which' in e.e) {\n        // Gecko (Firefox), WebKit (Safari/Chrome) & Opera\n        this.isRight = e.e.which === 3;\n      } else if ('button' in e.e) {\n        // IE, Opera\n        this.isRight = e.e.button === 2;\n      }\n\n      vm.emit('mouse:move', e);\n    });\n\n    this.canvas.on('mouse:up', e => {\n      this.isRight = false;\n      this.dx = 0;\n      this.dy = 0;\n\n      if (!vm.dragObject || !e.target || !e.target.selectable) {\n        e.target = null;\n        vm.emit('mouse:click', e);\n      }\n      if (vm.dragObject && vm.dragObject.clickable) {\n        if (vm.dragObject !== e.target) return;\n        if (!vm.dragObject.dragging && !vm.modeToggleByKey) {\n          vm.emit(`${vm.dragObject.class}:click`, vm.dragObject.parent);\n        }\n        vm.dragObject.dragging = false;\n      }\n      vm.dragObject = null;\n    });\n\n    window.addEventListener('resize', () => {\n      vm.onResize();\n    });\n\n    // document.addEventListener('keyup', () => {\n    //   if (this.modeToggleByKey && this.isGrabMode()) {\n    //     this.setModeAsSelect();\n    //     this.modeToggleByKey = false;\n    //   }\n    // });\n\n    // document.addEventListener('keydown', event => {\n    //   if (event.ctrlKey || event.metaKey) {\n    //     if (this.isSelectMode()) {\n    //       this.setModeAsGrab();\n    //     }\n    //     this.modeToggleByKey = true;\n    //   }\n    // });\n  }\n\n  unregisterListeners() {\n    this.canvas.off('object:moving');\n    this.canvas.off('object:moved');\n  }\n\n  getMarkerById(id) {\n    const objects = this.canvas.getObjects();\n    for (let i = 0; i < objects.length; i += 1) {\n      const obj = objects[i];\n      if (obj.class === 'marker' && obj.id === id) {\n        return obj.parent;\n      }\n    }\n    return null;\n  }\n\n  getMarkers() {\n    const list = [];\n    const objects = this.canvas.getObjects();\n    for (let i = 0; i < objects.length; i += 1) {\n      const obj = objects[i];\n      if (obj.class === 'marker') {\n        list.push(obj.parent);\n      }\n    }\n    return list;\n  }\n}\n\nexport const map = (container, options) => new Map(container, options);\n","import { Point } from '../geometry/Point';\n\nexport class Group extends fabric.Group {\n  constructor(objects, options) {\n    options = options || {};\n    super(objects, options);\n  }\n\n  getBounds() {\n    const coords = [];\n    coords.push(new Point(this.left - this.width / 2.0, this.top - this.height / 2.0));\n    coords.push(new Point(this.left + this.width / 2.0, this.top + this.height / 2.0));\n    return coords;\n  }\n}\n\nexport const group = (objects, options) => new Group(objects, options);\n\nexport default Group;\n","import Base from '../core/Base';\n\nexport class Layer extends Base {\n  constructor(options) {\n    super(options);\n    this.label = this.label !== undefined ? this.label : null;\n    this.draggable = this.draggable || false;\n    this.zIndex = this.zIndex || 1;\n    this.opacity = this.opacity || 1;\n    this.keepOnZoom = this.keepOnZoom || false;\n    this.clickable = this.clickable || false;\n\n    this.hoverCursor = this.hoverCursor || this.clickable ? 'pointer' : 'default';\n    this.moveCursor = this.moveCursor || 'move';\n\n    // this.class = this.class || this.constructor.name.toLowerCase();\n\n    this.style = {\n      zIndex: this.zIndex,\n      class: this.class,\n      parent: this,\n      keepOnZoom: this.keepOnZoom,\n      id: this.id,\n      hasControls: false,\n      hasBorders: false,\n      lockMovementX: !this.draggable,\n      lockMovementY: !this.draggable,\n      draggable: this.draggable,\n      clickable: this.clickable,\n      evented: this.clickable,\n      selectable: this.draggable,\n      hoverCursor: this.hoverCursor,\n      moveCursor: this.moveCursor\n    };\n  }\n\n  setOptions(options) {\n    if (!this.shape) return;\n    Object.keys(options).forEach(key => {\n      this.shape.set(key, options[key]);\n    });\n    if (this.shape.canvas) {\n      this.shape.canvas.renderAll();\n    }\n  }\n\n  addTo(map) {\n    if (!map) {\n      if (this._map) {\n        this._map.removeLayer(this);\n      }\n      return;\n    }\n    this._map = map;\n    this._map.addLayer(this);\n  }\n}\n\nexport const layer = options => new Layer(options);\n\nexport default Layer;\n","import { Point } from '../geometry/Point';\nimport { Group } from '../layer/Group';\nimport { Layer } from '../layer/Layer';\n\nexport class Floor extends Layer {\n  constructor(options) {\n    super(options);\n\n    this.width = this.width || -1;\n    this.height = this.height || -1;\n\n    this.position = new Point(this.position);\n\n    this.class = 'floorplan';\n\n    this.load();\n  }\n\n  load() {\n    const vm = this;\n    const index = this.url.lastIndexOf('.');\n    const ext = this.url.substr(index + 1, 3);\n\n    if (ext === 'svg') {\n      fabric.loadSVGFromURL(this.url, (objects, options) => {\n        objects = objects.filter(e => e.id !== 'grid');\n        const image = fabric.util.groupSVGElements(objects, options);\n        vm.setImage(image);\n      });\n    } else {\n      fabric.Image.fromURL(\n        this.url,\n        image => {\n          vm.setImage(image);\n        },\n        {\n          selectable: false,\n          opacity: this.opacity\n        }\n      );\n    }\n\n    this.handler = new fabric.Rect({\n      left: 0,\n      top: 0,\n      width: 20,\n      height: 20,\n      stroke: 'green',\n      fill: '',\n      hasControls: false,\n      hasBorders: false\n    });\n  }\n\n  setImage(image) {\n    if (this.shape && this.image) {\n      this.shape.remove(this.image);\n    }\n    const ratio = image.width / image.height;\n    if (this.width === -1 && this.height === -1) {\n      this.width = image.width;\n      this.height = image.height;\n    } else if (this.width === -1) {\n      this.width = this.height * ratio;\n    } else if (this.height === -1) {\n      this.height = this.width / ratio;\n    }\n    image.originalWidth = image.width;\n    image.originalHeight = image.height;\n    this.image = image.scaleToWidth(this.width, true);\n\n    this.scaleX = image.scaleX + 0;\n    this.scaleY = image.scaleY + 0;\n\n    this.drawShape();\n  }\n\n  drawShape() {\n    if (this.shape) {\n      this.shape.addWithUpdate(this.image);\n      this.emit('load', this);\n      return;\n    }\n\n    this.shape = new Group([this.image, this.handler], {\n      selectable: false,\n      draggable: false,\n      left: this.position.x,\n      top: this.position.y,\n      parent: this,\n      lockMovementX: true,\n      lockMovementY: true,\n      class: this.class,\n      zIndex: this.zIndex\n    });\n    this.emit('load', this);\n  }\n\n  setWidth(width) {\n    this.width = width;\n    this.onResize();\n  }\n\n  setHeight(height) {\n    this.height = height;\n    this.onResize();\n  }\n\n  setOpacity(opacity) {\n    this.opacity = opacity;\n    this.image.set('opacity', opacity);\n    if (this.image.canvas) {\n      this.image.canvas.renderAll();\n    }\n  }\n\n  setPosition(position) {\n    this.position = new Point(position);\n    if (!this.shape) return;\n    this.shape.set({\n      left: this.position.x,\n      top: this.position.y\n    });\n  }\n\n  setUrl(url) {\n    this.url = url;\n    this.load();\n  }\n\n  onResize(width, height) {\n    if (width !== undefined) {\n      this.width = width;\n    }\n    if (height !== undefined) {\n      this.height = height;\n    }\n\n    const ratio = this.image.width / this.image.height;\n    if (this.width === -1 && this.height === -1) {\n      this.width = this.image.width;\n      this.height = this.image.height;\n    } else if (this.width === -1) {\n      this.width = this.height / ratio;\n    } else if (this.height === -1) {\n      this.height = this.width * ratio;\n    }\n    this.image = this.image.scaleToWidth(this.width);\n    this.shape.addWithUpdate();\n  }\n}\n\nexport const floorplan = options => new Floor(options);\n","export class Line extends fabric.Line {\n  constructor(points, options) {\n    options = options || {};\n    options.strokeWidth = options.strokeWidth || 1;\n    options.class = 'line';\n    super(points, options);\n    this._strokeWidth = options.strokeWidth;\n  }\n\n  _renderStroke(ctx) {\n    const stroke = this._strokeWidth / this.canvas.getZoom();\n    this.strokeWidth = stroke > 0.01 ? stroke : 0.01;\n    super._renderStroke(ctx);\n    this.setCoords();\n  }\n}\n\nexport const line = (points, options) => new Line(points, options);\n\nexport default Line;\n","import { Layer } from './Layer';\nimport { Line } from './vector/Line';\n\nexport class Connector extends Layer {\n  constructor(start, end, options) {\n    options = options || {};\n    options.zIndex = options.zIndex || 10;\n    options.class = 'connector';\n    super(options);\n\n    if (!start || !end) {\n      console.error('start or end is missing');\n      return;\n    }\n    this.start = start;\n    this.end = end;\n    this.strokeWidth = this.strokeWidth || 1;\n\n    Object.assign(this.style, {\n      strokeWidth: this.strokeWidth,\n      stroke: this.color || 'grey',\n      fill: this.fill || false,\n      selectable: false\n    });\n\n    this.draw();\n\n    this.registerListeners();\n  }\n\n  registerListeners() {\n    const vm = this;\n    this.start.on('update:links', () => {\n      vm.shape.set({\n        x1: vm.start.position.x,\n        y1: vm.start.position.y\n      });\n    });\n\n    this.end.on('update:links', () => {\n      vm.shape.set({\n        x2: vm.end.position.x,\n        y2: vm.end.position.y\n      });\n    });\n  }\n\n  draw() {\n    this.shape = new Line(\n      [this.start.position.x, this.start.position.y, this.end.position.x, this.end.position.y],\n      this.style\n    );\n    // this.shape.setCoords();\n  }\n\n  redraw() {\n    this.shape.set({\n      x1: this.start.position.x,\n      y1: this.start.position.y,\n      x2: this.end.position.x,\n      y2: this.end.position.y\n    });\n  }\n\n  setStart(start) {\n    this.start = start;\n    this.redraw();\n  }\n\n  setEnd(end) {\n    this.end = end;\n    this.redraw();\n  }\n\n  setColor(color) {\n    this.color = color;\n    this.style.stroke = color;\n    this.shape.set('stroke', color);\n    if (this.shape.canvas) {\n      this.shape.canvas.renderAll();\n    }\n  }\n\n  setStrokeWidth(strokeWidth) {\n    this.strokeWidth = strokeWidth;\n    this.style.strokeWidth = strokeWidth;\n    this.shape.set('strokeWidth', strokeWidth);\n    if (this.shape.canvas) {\n      this.shape.canvas.renderAll();\n    }\n  }\n}\n\nexport const connector = (start, end, options) => new Connector(start, end, options);\n\nexport default Connector;\n","import { Layer } from '../Layer';\nimport { Group } from '../Group';\nimport { Point } from '../../geometry/Point';\nimport { Connector } from '../Connector';\n\nexport class Marker extends Layer {\n  constructor(position, options) {\n    options = options || {};\n    options.zIndex = options.zIndex || 100;\n    options.keepOnZoom = options.keepOnZoom === undefined ? true : options.keepOnZoom;\n    options.position = new Point(position);\n    options.rotation = options.rotation || 0;\n    options.yaw = options.yaw || 0;\n    options.clickable = options.clickable !== undefined ? options.clickable : true;\n    options.class = 'marker';\n    super(options);\n\n    const vm = this;\n\n    this.text = this.text || '';\n    this.size = this.size || 10;\n    this.textColor = this.textColor || 'black';\n    this.fill = this.fill || 'white';\n    this.stroke = this.stroke || 'red';\n\n    Object.assign(this.style, {\n      left: this.position.x,\n      top: this.position.y,\n      // selectionBackgroundColor: false,\n      angle: this.rotation,\n      yaw: this.yaw,\n      clickable: this.clickable\n    });\n\n    if (this.text) {\n      this.textObj = new fabric.Text(this.text, {\n        fontSize: this.size,\n        fill: this.textColor\n      });\n    }\n\n    if (this.icon) {\n      fabric.Image.fromURL(\n        this.icon.url,\n        image => {\n          vm.image = image.scaleToWidth(this.size);\n          this.init();\n          // vm.shape.removeWithUpdate();\n        },\n        {\n          selectable: false,\n          evented: this.evented,\n          clickable: this.clickable,\n          opacity: this.opacity\n        }\n      );\n    } else {\n      this.circle = new fabric.Circle({\n        radius: this.size,\n        strokeWidth: 2,\n        stroke: this.stroke,\n        fill: this.fill\n      });\n      this.init();\n    }\n  }\n\n  init() {\n    const objects = [];\n    if (this.image) {\n      objects.push(this.image);\n    }\n    if (this.circle) {\n      objects.push(this.circle);\n    }\n    if (this.textObj) {\n      objects.push(this.textObj);\n    }\n    this.shape = new Group(objects, this.style);\n    this.links = this.links || [];\n    this.addLinks();\n    this.registerListeners();\n\n    process.nextTick(() => {\n      this.emit('ready');\n    });\n  }\n\n  registerListeners() {\n    const vm = this;\n    this.shape.on('moving', () => {\n      vm.onShapeDrag();\n    });\n    this.shape.on('rotating', () => {\n      vm.emit('rotating');\n    });\n\n    this.shape.on('mousedown', e => {\n      vm.onShapeMouseDown(e);\n    });\n    this.shape.on('mousemove', e => {\n      vm.onShapeMouseMove(e);\n    });\n    this.shape.on('mouseup', e => {\n      vm.onShapeMouseUp(e);\n    });\n    this.shape.on('mouseover', () => {\n      vm.emit('mouseover', vm);\n    });\n    this.shape.on('mouseout', () => {\n      vm.emit('mouseout', vm);\n    });\n  }\n\n  setPosition(position) {\n    this.position = new Point(position);\n    if (!this.shape) return;\n\n    this.shape.set({\n      left: this.position.x,\n      top: this.position.y\n    });\n\n    this.emit('update:links');\n\n    if (this.shape.canvas) {\n      this.shape.canvas.renderAll();\n    }\n  }\n\n  setRotation(rotation) {\n    this.rotation = rotation;\n\n    if (!this.shape) return;\n\n    this.shape.set({\n      angle: this.rotation\n    });\n\n    if (this.shape.canvas) {\n      this.shape.canvas.renderAll();\n    }\n  }\n\n  setOptions(options) {\n    if (!this.shape) return;\n\n    Object.keys(options).forEach(key => {\n      switch (key) {\n        case 'textColor':\n          this.setTextColor(options[key]);\n          break;\n        case 'stroke':\n          this.setStroke(options[key]);\n          break;\n        case 'fill':\n          this.setColor(options[key]);\n          break;\n\n        default:\n          break;\n      }\n    });\n    if (this.shape.canvas) {\n      this.shape.canvas.renderAll();\n    }\n  }\n\n  setTextColor(color) {\n    if (this.text && this.textObj) {\n      this.textObj.setColor(color);\n      this.textObj.canvas.renderAll();\n    }\n  }\n\n  setText(text) {\n    if (this.text && this.textObj) {\n      this.textObj.set({ text });\n      this.textObj.canvas.renderAll();\n    }\n  }\n\n  setStroke(color) {\n    if (this.circle) {\n      this.circle.set('stroke', color);\n    }\n  }\n\n  setColor(color) {\n    if (this.circle) {\n      this.circle.setColor(color);\n    }\n  }\n\n  setLinks(links) {\n    this.links = links;\n    this.addLinks();\n  }\n\n  addLinks() {\n    this.connectors = [];\n    this.links.forEach(link => {\n      const connector = new Connector(this, link);\n      this.connectors.push(connector);\n    });\n\n    this.addConnectors();\n  }\n\n  addConnectors() {\n    const vm = this;\n    this.connectors.forEach(connector => {\n      vm._map.addLayer(connector);\n    });\n  }\n\n  onAdded() {\n    this.addConnectors();\n  }\n\n  onShapeDrag() {\n    const matrix = this.shape.calcTransformMatrix();\n    const [, , , , x, y] = matrix;\n    this.position = new Point(x, y);\n    this.emit('update:links');\n    this.emit('moving');\n  }\n\n  onShapeMouseDown(e) {\n    this.dragStart = e;\n  }\n\n  onShapeMouseMove(e) {\n    if (this.dragStart) {\n      this.emit('dragstart');\n\n      const a = new fabric.Point(e.pointer.x, e.pointer.y);\n      const b = new fabric.Point(this.dragStart.pointer.x, this.dragStart.pointer.y);\n      // if distance is far enough, we don't want to fire click event\n      if (a.distanceFrom(b) > 3) {\n        this.dragStart = null;\n        this.dragging = true;\n      } else {\n        // this.dragging = false;\n      }\n    }\n\n    if (this.dragging) {\n      this.emit('drag');\n    } else {\n      this.emit('hover');\n    }\n  }\n\n  onShapeMouseUp() {\n    if (!this.dragging) {\n      this.emit('click');\n    } else {\n      this.emit('moved');\n    }\n    this.dragStart = null;\n    this.dragging = false;\n  }\n}\n\nexport const marker = (position, options) => new Marker(position, options);\n","import { ICON } from '../../core/Constants';\n\nexport class Icon extends fabric.Image {\n  constructor(options) {\n    super(options);\n    this.defaults = Object.assign({}, ICON);\n    Object.assign({}, this.defaults);\n    Object.assign({}, this._options);\n  }\n}\nexport const icon = (options) => new Icon(options);\n","import { Layer } from '../Layer';\nimport { Point } from '../../geometry/Point';\nimport { Group } from '../Group';\n\nexport class Polyline extends Layer {\n  constructor(_points, options) {\n    options = options || {};\n    options.points = _points || [];\n    super(options);\n    this.lines = [];\n    this.class = 'polyline';\n    this.strokeWidth = 1;\n\n    this.lineOptions = {\n      strokeWidth: this.strokeWidth,\n      stroke: this.color || 'grey',\n      fill: this.fill || false\n    };\n\n    this.shape = new Group([], {\n      selectable: false,\n      hasControls: false,\n      class: this.class,\n      parent: this\n    });\n\n    this.setPoints(this._points);\n  }\n\n  addPoint(point) {\n    this.points.push(new Point(point));\n\n    if (this.points.length > 1) {\n      const i = this.points.length - 1;\n      const j = this.points.length - 2;\n      const p1 = this.points[i];\n      const p2 = this.points[j];\n      const line = new fabric.Line(p1.getArray().concat(p2.getArray()), this.lineOptions);\n      this.lines.push(line);\n      this.shape.addWithUpdate(line);\n    }\n  }\n\n  setStrokeWidth(strokeWidth) {\n    this.lines.forEach(line => {\n      line.setStrokeWidth(strokeWidth);\n    });\n  }\n\n  setPoints(points = []) {\n    this.removeLines();\n    this.points = [];\n    for (let i = 0; i < points.length; i += 1) {\n      const point = new Point(points[i]);\n      this.points.push(point);\n      this.addPoint();\n    }\n  }\n\n  removeLines() {\n    for (let i = 0; i < this.lines.length; i += 1) {\n      this.shape.remove(this.lines[i]);\n    }\n    this.lines = [];\n  }\n}\n\nexport const polyline = (points, options) => new Polyline(points, options);\n","export class Circle extends fabric.Circle {}\n\nexport const circle = options => new Circle(options);\n","export class Rect extends fabric.Rect {\n  constructor(points, options) {\n    options = options || {};\n    options.strokeWidth = options.strokeWidth || 1;\n    options.class = 'rect';\n    super(points, options);\n    this._strokeWidth = options.strokeWidth;\n  }\n\n  _renderStroke(ctx) {\n    this.strokeWidth = this._strokeWidth / this.canvas.getZoom();\n    super._renderStroke(ctx);\n  }\n}\n\nexport const rect = (points, options) => new Rect(points, options);\n\nexport default Rect;\n","import { Rect } from '../vector';\nimport { Layer } from '../Layer';\n\nexport class MarkerGroup extends Layer {\n  constructor(bounds, options) {\n    options = options || {};\n    options.bounds = bounds;\n    options.zIndex = options.zIndex || 50;\n    options.class = 'markergroup';\n    super(options);\n    if (!this.bounds) {\n      console.error('bounds is missing!');\n      return;\n    }\n    this.style = {\n      strokeWidth: 1,\n      stroke: this.stroke || 'black',\n      fill: this.color || '#88888822',\n      class: this.class,\n      zIndex: this.zIndex,\n      parent: this\n    };\n    this.draw();\n  }\n\n  setBounds(bounds) {\n    this.bounds = bounds;\n    this.draw();\n  }\n\n  draw() {\n    const width = this.bounds[1][0] - this.bounds[0][0];\n    const height = this.bounds[1][1] - this.bounds[0][1];\n    this.coords = {\n      left: this.bounds[0][0] + width / 2,\n      top: this.bounds[0][1] + height / 2,\n      width,\n      height\n    };\n\n    if (this.shape) {\n      this.shape.set(this.coords);\n    } else {\n      Object.assign(this.style, this.coords);\n      this.shape = new Rect(this.style);\n    }\n  }\n}\nexport const markerGroup = (bounds, options) => new MarkerGroup(bounds, options);\nexport default MarkerGroup;\n","import Base from '../core/Base';\n\nexport class Canvas extends Base {\n  constructor(container, options) {\n    super(options);\n\n    this.container = container;\n\n    const canvas = document.createElement('canvas');\n    this.container.appendChild(canvas);\n    canvas.setAttribute('id', 'indoorjs-canvas');\n\n    canvas.width = this.width || this.container.clientWidth;\n    canvas.height = this.height || this.container.clientHeight;\n\n    this.canvas = new fabric.Canvas(canvas, {\n      isDrawingMode: true,\n      freeDrawingCursor: 'none',\n      freeDrawingLineWidth: this.lineWidth\n    });\n\n    this.setLineWidth(this.lineWidth || 10);\n\n    this.addCursor();\n  }\n\n  addCursor() {\n    const canvas = this.canvas;\n    const cursorCanvas = document.createElement('canvas');\n    this.canvas.wrapperEl.appendChild(cursorCanvas);\n    cursorCanvas.setAttribute('id', 'indoorjs-cursor-canvas');\n    cursorCanvas.style.position = 'absolute';\n    cursorCanvas.style.top = '0';\n    cursorCanvas.style.pointerEvents = 'none';\n    cursorCanvas.width = this.width || this.container.clientWidth;\n    cursorCanvas.height = this.height || this.container.clientHeight;\n\n    this.cursor = new fabric.StaticCanvas(cursorCanvas);\n    const cursorOpacity = 0.5;\n    const mousecursor = new fabric.Circle({\n      left: -1000,\n      top: -1000,\n      radius: canvas.freeDrawingBrush.width / 2,\n      fill: `rgba(255,0,0,${cursorOpacity})`,\n      stroke: 'black',\n      originX: 'center',\n      originY: 'center'\n    });\n\n    this.cursor.add(mousecursor);\n    this.mousecursor = mousecursor;\n\n    canvas.on('mouse:move', evt => {\n      const mouse = canvas.getPointer(evt.e);\n      mousecursor\n        .set({\n          top: mouse.y,\n          left: mouse.x\n        })\n        .setCoords()\n        .canvas.renderAll();\n    });\n\n    canvas.on('mouse:out', () => {\n      // put circle off screen\n      mousecursor\n        .set({\n          left: -1000,\n          top: -1000\n        })\n        .setCoords()\n        .canvas.renderAll();\n    });\n  }\n\n  setColor(color) {\n    this.canvas.freeDrawingBrush.color = color;\n\n    if (!this.mousecursor) return;\n\n    this.mousecursor\n      .set({\n        left: 100,\n        top: 100,\n        fill: color\n      })\n      .setCoords()\n      .canvas.renderAll();\n  }\n\n  setLineWidth(width) {\n    this.lineWidth = width;\n    this.canvas.freeDrawingBrush.width = width;\n\n    if (!this.mousecursor) return;\n\n    this.mousecursor\n      .set({\n        left: 100,\n        top: 100,\n        radius: width / 2\n      })\n      .setCoords()\n      .canvas.renderAll();\n  }\n\n  clear() {\n    this.canvas.clear();\n  }\n}\n\nexport const canvas = (container, options) => new Canvas(container, options);\n","import fabric from 'fabric-pure-browser';\n\nimport { version } from '../package.json';\n\nconsole.log('fabricJS ', fabric.version || window.fabric.version);\nconsole.log('IndoorJS ', version);\n\nexport { version };\n\n// constants\nexport * from './core/index';\n\n// geometry\nexport * from './geometry/index';\n\n// map\nexport * from './map/index';\n\n// floorplan\nexport * from './floorplan/index';\n\n// layer\nexport * from './layer/index';\n\n// Free Drawing Canvas\nexport * from './paint/index';\n"],"names":["Point","x","y","params","length","Object","prototype","hasOwnProperty","call","console","error","fabric","point","Modes","SELECT","GRAB","DRAW","MAP","center","zoom","minZoom","maxZoom","gridEnabled","zoomEnabled","selectEnabled","mode","MARKER","position","ICON","url","size","anchor","originX","originY","lockUniScaling","lockScalingFlip","transparentCorners","centeredScaling","cornerColor","borderColor","borderOpacity","cornerOpacity","cornerStrokeColor","objectCaching","Group","selectionBackgroundColor","borderDashArray","padding","getBounds","coords","push","left","width","top","height","global","isNum","val","isNaN","ev","toElement","currentTarget","toElementBoundingRect","getBoundingClientRect","orgEv","originalEvent","hasTouches","touches","pageX","pageY","clientX","clientY","currentPoint","isRight","which","button","stopThresholdDefault","bounceDeceleration","bounceAcceleration","window","addEventListener","Impetus","source","sourceEl","document","updateCallback","update","stopCallback","stop","multiplier","friction","initialValues","boundX","boundY","bounce","boundXmin","boundXmax","boundYmin","boundYmax","pointerLastX","pointerLastY","pointerCurrentX","pointerCurrentY","pointerId","decVelX","decVelY","targetX","targetY","stopThreshold","ticking","pointerActive","paused","decelerating","trackingPoints","init","querySelector","Error","callUpdateCallback","onDown","destroy","removeEventListener","cleanUpRuntimeEvents","pause","resume","setValues","setMultiplier","setBoundX","setBoundY","onMove","getPassiveSupported","passive","onUp","stopTracking","addRuntimeEvents","normalizeEvent","type","touch","targetTouches","changedTouches","id","identifier","event","addTrackingPoint","preventDefault","requestTick","startDecelAnim","time","Date","now","shift","updateAndRender","pointerChangeX","pointerChangeY","diff","checkBounds","dragOutOfBoundsMultiplier","Math","pow","requestAnimFrame","restrict","xDiff","yDiff","undefined","inBounds","firstPoint","lastPoint","xOffset","yOffset","timeOffset","D","abs","stepDecelAnim","reboundAdjust","adjust","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","callback","setTimeout","passiveSupported","options","defineProperty","get","err","MagicScroll","target","speed","smooth","current","scrollingElement","documentElement","body","parentNode","moving","scrollTop","pos","frame","scrolled","scope","e","delta","normalizeWheelDelta","detail","wheelDelta","onUpdate","requestFrame","oRequestAnimationFrame","msRequestAnimationFrame","func","str","out","String","num","parseFloat","match","PIXELS_PER_INCH","defaults","toPX","parts","parseUnit","px","rootPosition","mouseEventOffset","srcElement","Array","isArray","cx","cy","rect","getBoundingClientOffset","element","distance","a","b","sqrt","touchPinch","emitter","EventEmitter2","fingers","activeCount","lastDistance","ended","enabled","defineProperties","pinching","enable","disable","indexOfTouch","i","onTouchStart","onTouchMove","onTouchRemoved","newTouch","idx","first","newIndex","oldIndex","newFinger","Finger","eventOffset","oldTouch","emit","initialDistance","computeDistance","changed","movedTouch","currentDistance","removed","otherIdx","otherTouch","getPrefixed","name","lastTime","timeoutDefer","fn","timeToCall","max","bind","obj","slice","apply","arguments","args","concat","requestFn","cancelFn","cancelAnimationFrame","clearTimeout","raf","context","immediate","cancel","panzoom","cb","Function","cursor","hasPassive","supported","opts","impetus","magicScroll","initX","initY","initFn","evPos","lastY","lastX","dx","dy","dz","x0","y0","schedule","pinch","mult","initialCoords","on","curr","f1","f2","prev","planned","frameId","arg","unpanzoom","wheelListener","clamp","min","len","almostEqual","absoluteError","relativeError","d","DBL_EPSILON","FLT_EPSILON","range","start","step","toReturn","increasing","log10","log","isMultiple","eps","remainder","almost","minStep","srcSteps","power","floor","lg","order","steps","map","v","value","toString","getPrototypeOf","Base","_options","assign","alpha","color","replace","split","join","gridStyle","unit","lines","state","coord","coordinate","scale","offset","ceil","lineColor","light","heavy","tenStep","nextStep","colors","ticks","tickWidth","axisWidth","labels","orientation","Number","toFixed","format","Axis","values","t","getRatio","getRange","Grid","canvas","getContext","setDefaults","draw","shape","pt","pr","pb","pl","axisCoords","opposite","getCoords","axisOrigin","setWidth","setHeight","calcCoordinate","axisX","axisY","grid","MAX_VALUE","axisColor","lineWidth","tickAlign","labelColor","fill","fontSize","units","toPx","fontFamily","lineColors","tick","isObj","keys","forEach","label","pixelRatio","devicePixelRatio","autostart","interactions","Infinity","origin","panEnabled","style","axis","clearRect","drawLines","ctx","axisRatio","j","strokeStyle","beginPath","x1","y1","x2","y2","moveTo","lineTo","stroke","closePath","normals","xDif","yDif","dist","tickCoords","labelCoords","k","drawLabels","font","fillStyle","textBaseline","textHeight","indent","textOffset","isOpp","disabled","textWidth","measureText","textLeft","textTop","fillText","ModesMixin","superclass","isDrawingMode","interactive","selection","hoverCursor","moveCursor","setCursor","discardActiveObject","setMode","mix","MixinBuilder","mixins","reduce","c","m","Map","container","createElement","appendChild","setAttribute","clientWidth","clientHeight","Canvas","preserveObjectStacking","clear","absolutePan","addFloorPlan","addGrid","vm","registerListeners","floorplan","img","addLayer","layer","add","_objects","sort","o1","o2","zIndex","keepOnZoom","set","setCoords","renderAll","remove","gridCanvas","cloneCanvas","index","clone","wrapperEl","process","minX","maxX","minY","maxY","forEachObject","onResize","bounds","boundWidth","boundHeight","scaleX","scaleY","setZoom","oldWidth","oldHeight","setSize","relativePan","update2","render","zoomToPoint","isGrabMode","objects","getObjects","hasKeepZoom","object","prevZoom","curZoom","oX","oY","tx","ty","setX","setY","parent","group","removeWithUpdate","orgYaw","yaw","fire","angle","_set","deselected","inGroup","selected","dragObject","clickable","dragging","selectable","modeToggleByKey","off","list","Layer","draggable","opacity","hasControls","hasBorders","lockMovementX","lockMovementY","evented","key","_map","removeLayer","Floor","load","lastIndexOf","ext","substr","loadSVGFromURL","filter","image","util","groupSVGElements","setImage","Image","fromURL","handler","Rect","ratio","originalWidth","originalHeight","scaleToWidth","drawShape","addWithUpdate","Line","points","strokeWidth","_strokeWidth","getZoom","line","Connector","end","redraw","connector","Marker","rotation","text","textColor","textObj","Text","icon","circle","Circle","radius","links","addLinks","onShapeDrag","onShapeMouseDown","onShapeMouseMove","onShapeMouseUp","setTextColor","setStroke","setColor","connectors","link","addConnectors","matrix","calcTransformMatrix","dragStart","pointer","distanceFrom","marker","Icon","Polyline","_points","lineOptions","setPoints","p1","p2","getArray","setStrokeWidth","removeLines","addPoint","polyline","MarkerGroup","markerGroup","freeDrawingCursor","freeDrawingLineWidth","setLineWidth","addCursor","cursorCanvas","pointerEvents","StaticCanvas","cursorOpacity","mousecursor","freeDrawingBrush","evt","mouse","getPointer","version"],"mappings":"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"}