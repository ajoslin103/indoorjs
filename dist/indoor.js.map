{"version":3,"file":"indoor.js","sources":["../src/geometry/Point.js","../src/lib/ev-pos.js","../src/lib/impetus.js","../src/lib/mumath/parse-unit.js","../src/lib/mumath/to-px.js","../src/lib/mouse-wheel.js","../node_modules/rollup-plugin-node-builtins/src/es6/events.js","../src/lib/mouse-event-offset.js","../src/lib/touch-pinch.js","../src/lib/raf.js","../src/lib/panzoom.js","../src/lib/mumath/clamp.js","../src/lib/mumath/len.js","../src/lib/mumath/lerp.js","../src/lib/mumath/mod.js","../src/lib/mumath/almost.js","../src/lib/mumath/normalize.js","../src/lib/mumath/precision.js","../src/lib/mumath/round.js","../src/lib/mumath/range.js","../src/lib/mumath/order.js","../src/lib/mumath/log10.js","../src/lib/mumath/is-multiple.js","../src/lib/mumath/scale.js","../src/lib/mumath/is-plain-obj.js","../src/lib/mumath/index.js","../src/core/Base.js","../src/core/Constants.js","../src/lib/color-alpha.js","../src/grid/gridStyle.js","../src/grid/Axis.js","../src/grid/Grid.js","../src/map/ModesMixin.js","../src/lib/mix.js","../src/map/Map.js","../src/layer/Group.js","../src/layer/Layer.js","../src/floorplan/Floorplan.js","../src/layer/vector/Line.js","../src/layer/Connector.js","../node_modules/rollup-plugin-node-globals/src/global.js","../node_modules/process-es6/browser.js","../src/layer/marker/Marker.js","../src/layer/marker/Icon.js","../src/layer/marker/MarkerGroup.js","../src/layer/vector/Polyline.js","../src/layer/vector/Circle.js","../src/Indoor.js"],"sourcesContent":["export class Point extends fabric.Point {\n  constructor(...params) {\n    let x;\n    let y;\n    if (params.length > 1) {\n      [x, y] = params;\n    } else if (params.length === 0 || !params[0]) {\n      [x, y] = [0, 0];\n    } else if (Object.prototype.hasOwnProperty.call(params[0], 'x')) {\n      x = params[0].x;\n      y = params[0].y;\n    } else if (params[0].length) {\n      [[x, y]] = params;\n    } else {\n      console.error('Parameter for Point is not valid. Use Point(x,y) or Point({x,y}) or Point([x,y])', params);\n    }\n\n    super(x, y);\n  }\n\n  setX(x) {\n    this.x = x || 0;\n  }\n\n  setY(y) {\n    this.y = y || 0;\n  }\n\n  getArray() {\n    return [this.x, this.y];\n  }\n}\n\nexport const point = (...params) => new Point(...params);\n","const isNum = function (val) {\n    return typeof val === 'number' && !isNaN(val);\n};\n\nexport default (ev, toElement) => {\n    toElement = toElement || ev.currentTarget;\n\n    const toElementBoundingRect = toElement.getBoundingClientRect();\n        const orgEv = ev.originalEvent || ev;\n        const hasTouches = ev.touches && ev.touches.length;\n        let pageX = 0;\n        let pageY = 0;\n\n    if (hasTouches) {\n        if (isNum(ev.touches[0].pageX) && isNum(ev.touches[0].pageY)) {\n            pageX = ev.touches[0].pageX;\n            pageY = ev.touches[0].pageY;\n        } else if (isNum(ev.touches[0].clientX) && isNum(ev.touches[0].clientY)) {\n            pageX = orgEv.touches[0].clientX;\n            pageY = orgEv.touches[0].clientY;\n        }\n    } else if (isNum(ev.pageX) && isNum(ev.pageY)) {\n            pageX = ev.pageX;\n            pageY = ev.pageY;\n        } else if (ev.currentPoint && isNum(ev.currentPoint.x) && isNum(ev.currentPoint.y)) {\n            pageX = ev.currentPoint.x;\n            pageY = ev.currentPoint.y;\n        }\n\n    return {\n        x: pageX - toElementBoundingRect.left,\n        y: pageY - toElementBoundingRect.top\n    };\n};","const stopThresholdDefault = 0.3;\nconst bounceDeceleration = 0.04;\nconst bounceAcceleration = 0.11;\n\n\n// fixes weird safari 10 bug where preventDefault is prevented\n// @see https://github.com/metafizzy/flickity/issues/457#issuecomment-254501356\nwindow.addEventListener('touchmove', function() {});\n\nexport default class Impetus {\n    constructor({\n        source: sourceEl = document,\n        update: updateCallback,\n        multiplier = 1,\n        friction = 0.92,\n        initialValues,\n        boundX,\n        boundY,\n        bounce = true\n    }) {\n        var boundXmin, boundXmax, boundYmin, boundYmax, pointerLastX, pointerLastY, pointerCurrentX, pointerCurrentY, pointerId, decVelX, decVelY;\n        var targetX = 0;\n        var targetY = 0;\n        var stopThreshold = stopThresholdDefault * multiplier;\n        var ticking = false;\n        var pointerActive = false;\n        var paused = false;\n        var decelerating = false;\n        var trackingPoints = [];\n\n\n        /**\n         * Initialize instance\n         */\n        (function init() {\n            sourceEl = (typeof sourceEl === 'string') ? document.querySelector(sourceEl) : sourceEl;\n            if (!sourceEl) {\n                throw new Error('IMPETUS: source not found.');\n            }\n\n            if (!updateCallback) {\n                throw new Error('IMPETUS: update function not defined.');\n            }\n\n            if (initialValues) {\n                if (initialValues[0]) {\n                    targetX = initialValues[0];\n                }\n                if (initialValues[1]) {\n                    targetY = initialValues[1];\n                }\n                callUpdateCallback();\n            }\n\n            // Initialize bound values\n            if (boundX) {\n                boundXmin = boundX[0];\n                boundXmax = boundX[1];\n            }\n            if (boundY) {\n                boundYmin = boundY[0];\n                boundYmax = boundY[1];\n            }\n\n            sourceEl.addEventListener('touchstart', onDown);\n            sourceEl.addEventListener('mousedown', onDown);\n        })();\n\n        /**\n         * In edge cases where you may need to\n         * reinstanciate Impetus on the same sourceEl\n         * this will remove the previous event listeners\n         */\n        this.destroy = function() {\n            sourceEl.removeEventListener('touchstart', onDown);\n            sourceEl.removeEventListener('mousedown', onDown);\n\n            cleanUpRuntimeEvents();\n\n            // however it won't \"destroy\" a reference\n            // to instance if you'd like to do that\n            // it returns null as a convinience.\n            // ex: `instance = instance.destroy();`\n            return null;\n        };\n\n        /**\n         * Disable movement processing\n         * @public\n         */\n        this.pause = function() {\n            cleanUpRuntimeEvents();\n\n            pointerActive = false;\n            paused = true;\n        };\n\n        /**\n         * Enable movement processing\n         * @public\n         */\n        this.resume = function() {\n            paused = false;\n        };\n\n        /**\n         * Update the current x and y values\n         * @public\n         * @param {Number} x\n         * @param {Number} y\n         */\n        this.setValues = function(x, y) {\n            if (typeof x === 'number') {\n                targetX = x;\n            }\n            if (typeof y === 'number') {\n                targetY = y;\n            }\n        };\n\n        /**\n         * Update the multiplier value\n         * @public\n         * @param {Number} val\n         */\n        this.setMultiplier = function(val) {\n            multiplier = val;\n            stopThreshold = stopThresholdDefault * multiplier;\n        };\n\n        /**\n         * Update boundX value\n         * @public\n         * @param {Number[]} boundX\n         */\n        this.setBoundX = function(boundX) {\n            boundXmin = boundX[0];\n            boundXmax = boundX[1];\n        };\n\n        /**\n         * Update boundY value\n         * @public\n         * @param {Number[]} boundY\n         */\n        this.setBoundY = function(boundY) {\n            boundYmin = boundY[0];\n            boundYmax = boundY[1];\n        };\n\n        /**\n         * Removes all events set by this instance during runtime\n         */\n        function cleanUpRuntimeEvents() {\n          // Remove all touch events added during 'onDown' as well.\n          document.removeEventListener('touchmove', onMove, getPassiveSupported() ? { passive: false } : false);\n          document.removeEventListener('touchend', onUp);\n          document.removeEventListener('touchcancel', stopTracking);\n          document.removeEventListener('mousemove', onMove, getPassiveSupported() ? { passive: false } : false);\n          document.removeEventListener('mouseup', onUp);\n        }\n\n        /**\n         * Add all required runtime events\n         */\n        function addRuntimeEvents() {\n          cleanUpRuntimeEvents();\n\n          // @see https://developers.google.com/web/updates/2017/01/scrolling-intervention\n          document.addEventListener('touchmove', onMove, getPassiveSupported() ? { passive: false } : false);\n          document.addEventListener('touchend', onUp);\n          document.addEventListener('touchcancel', stopTracking);\n          document.addEventListener('mousemove', onMove, getPassiveSupported() ? { passive: false } : false);\n          document.addEventListener('mouseup', onUp);\n        }\n\n        /**\n         * Executes the update function\n         */\n        function callUpdateCallback() {\n            updateCallback.call(sourceEl, targetX, targetY);\n        }\n\n        /**\n         * Creates a custom normalized event object from touch and mouse events\n         * @param  {Event} ev\n         * @returns {Object} with x, y, and id properties\n         */\n        function normalizeEvent(ev) {\n            if (ev.type === 'touchmove' || ev.type === 'touchstart' || ev.type === 'touchend') {\n                var touch = ev.targetTouches[0] || ev.changedTouches[0];\n                return {\n                    x: touch.clientX,\n                    y: touch.clientY,\n                    id: touch.identifier\n                };\n            } else { // mouse events\n                return {\n                    x: ev.clientX,\n                    y: ev.clientY,\n                    id: null\n                };\n            }\n        }\n\n        /**\n         * Initializes movement tracking\n         * @param  {Object} ev Normalized event\n         */\n        function onDown(ev) {\n            var event = normalizeEvent(ev);\n            if (!pointerActive && !paused) {\n                pointerActive = true;\n                decelerating = false;\n                pointerId = event.id;\n\n                pointerLastX = pointerCurrentX = event.x;\n                pointerLastY = pointerCurrentY = event.y;\n                trackingPoints = [];\n                addTrackingPoint(pointerLastX, pointerLastY);\n\n                addRuntimeEvents();\n            }\n        }\n\n        /**\n         * Handles move events\n         * @param  {Object} ev Normalized event\n         */\n        function onMove(ev) {\n            ev.preventDefault();\n            var event = normalizeEvent(ev);\n\n            if (pointerActive && event.id === pointerId) {\n                pointerCurrentX = event.x;\n                pointerCurrentY = event.y;\n                addTrackingPoint(pointerLastX, pointerLastY);\n                requestTick();\n            }\n        }\n\n        /**\n         * Handles up/end events\n         * @param {Object} ev Normalized event\n         */\n        function onUp(ev) {\n            var event = normalizeEvent(ev);\n\n            if (pointerActive && event.id === pointerId) {\n                stopTracking();\n            }\n        }\n\n        /**\n         * Stops movement tracking, starts animation\n         */\n        function stopTracking() {\n            pointerActive = false;\n            addTrackingPoint(pointerLastX, pointerLastY);\n            startDecelAnim();\n\n            cleanUpRuntimeEvents();\n        }\n\n        /**\n         * Records movement for the last 100ms\n         * @param {number} x\n         * @param {number} y [description]\n         */\n        function addTrackingPoint(x, y) {\n            var time = Date.now();\n            while (trackingPoints.length > 0) {\n                if (time - trackingPoints[0].time <= 100) {\n                    break;\n                }\n                trackingPoints.shift();\n            }\n\n            trackingPoints.push({x, y, time});\n        }\n\n        /**\n         * Calculate new values, call update function\n         */\n        function updateAndRender() {\n            var pointerChangeX = pointerCurrentX - pointerLastX;\n            var pointerChangeY = pointerCurrentY - pointerLastY;\n\n            targetX += pointerChangeX * multiplier;\n            targetY += pointerChangeY * multiplier;\n\n            if (bounce) {\n                let diff = checkBounds();\n                if (diff.x !== 0) {\n                    targetX -= pointerChangeX * dragOutOfBoundsMultiplier(diff.x) * multiplier;\n                }\n                if (diff.y !== 0) {\n                    targetY -= pointerChangeY * dragOutOfBoundsMultiplier(diff.y) * multiplier;\n                }\n            } else {\n                checkBounds(true);\n            }\n\n            callUpdateCallback();\n\n            pointerLastX = pointerCurrentX;\n            pointerLastY = pointerCurrentY;\n            ticking = false;\n        }\n\n\n        /**\n         * Returns a value from around 0.5 to 1, based on distance\n         * @param {Number} val\n         */\n        function dragOutOfBoundsMultiplier(val) {\n            return 0.000005 * Math.pow(val, 2) + 0.0001 * val + 0.55;\n        }\n\n\n        /**\n         * prevents animating faster than current framerate\n         */\n        function requestTick() {\n            if (!ticking) {\n                requestAnimFrame(updateAndRender);\n            }\n            ticking = true;\n        }\n\n\n        /**\n         * Determine position relative to bounds\n         * @param {Boolean} restrict Whether to restrict target to bounds\n         */\n        function checkBounds(restrict) {\n            var xDiff = 0;\n            var yDiff = 0;\n\n            if (boundXmin !== undefined && targetX < boundXmin) {\n                xDiff = boundXmin - targetX;\n            } else if (boundXmax !== undefined && targetX > boundXmax) {\n                xDiff = boundXmax - targetX;\n            }\n\n            if (boundYmin !== undefined && targetY < boundYmin) {\n                yDiff = boundYmin - targetY;\n            } else if (boundYmax !== undefined && targetY > boundYmax) {\n                yDiff = boundYmax - targetY;\n            }\n\n            if (restrict) {\n                if (xDiff !== 0) {\n                    targetX = (xDiff > 0) ? boundXmin : boundXmax;\n                }\n                if (yDiff !== 0) {\n                    targetY = (yDiff > 0) ? boundYmin : boundYmax;\n                }\n            }\n\n            return {\n                x: xDiff,\n                y: yDiff,\n                inBounds: xDiff === 0 && yDiff === 0\n            };\n        }\n\n\n        /**\n         * Initialize animation of values coming to a stop\n         */\n        function startDecelAnim() {\n            var firstPoint = trackingPoints[0];\n            var lastPoint = trackingPoints[trackingPoints.length - 1];\n\n            var xOffset = lastPoint.x - firstPoint.x;\n            var yOffset = lastPoint.y - firstPoint.y;\n            var timeOffset = lastPoint.time - firstPoint.time;\n\n            var D = (timeOffset / 15) / multiplier;\n\n            decVelX = (xOffset / D) || 0; // prevent NaN\n            decVelY = (yOffset / D) || 0;\n\n            var diff = checkBounds();\n\n            if ((Math.abs(decVelX) > 1 || Math.abs(decVelY) > 1) || !diff.inBounds){\n                decelerating = true;\n                requestAnimFrame(stepDecelAnim);\n            }\n        }\n\n\n        /**\n         * Animates values slowing down\n         */\n        function stepDecelAnim() {\n            if (!decelerating) {\n                return;\n            }\n\n            decVelX *= friction;\n            decVelY *= friction;\n\n            targetX += decVelX;\n            targetY += decVelY;\n\n            var diff = checkBounds();\n\n            if ((Math.abs(decVelX) > stopThreshold || Math.abs(decVelY) > stopThreshold) || !diff.inBounds) {\n\n                if (bounce) {\n                    let reboundAdjust = 2.5;\n\n                    if (diff.x !== 0) {\n                        if (diff.x * decVelX <= 0) {\n                            decVelX += diff.x * bounceDeceleration;\n                        } else {\n                            let adjust = (diff.x > 0) ? reboundAdjust : -reboundAdjust;\n                            decVelX = (diff.x + adjust) * bounceAcceleration;\n                        }\n                    }\n                    if (diff.y !== 0) {\n                        if (diff.y * decVelY <= 0) {\n                            decVelY += diff.y * bounceDeceleration;\n                        } else {\n                            let adjust = (diff.y > 0) ? reboundAdjust : -reboundAdjust;\n                            decVelY = (diff.y + adjust) * bounceAcceleration;\n                        }\n                    }\n                } else {\n                    if (diff.x !== 0) {\n                        if (diff.x > 0) {\n                            targetX = boundXmin;\n                        } else {\n                            targetX = boundXmax;\n                        }\n                        decVelX = 0;\n                    }\n                    if (diff.y !== 0) {\n                        if (diff.y > 0) {\n                            targetY = boundYmin;\n                        } else {\n                            targetY = boundYmax;\n                        }\n                        decVelY = 0;\n                    }\n                }\n\n                callUpdateCallback();\n\n                requestAnimFrame(stepDecelAnim);\n            } else {\n                decelerating = false;\n            }\n        }\n    }\n}\n\n\n\n/**\n * @see http://www.paulirish.com/2011/requestanimationframe-for-smart-animating/\n */\nconst requestAnimFrame = (function(){\n    return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || function(callback) {\n        window.setTimeout(callback, 1000 / 60);\n    };\n})();\n\n\nfunction getPassiveSupported() {\n    let passiveSupported = false;\n\n    try {\n        var options = Object.defineProperty({}, \"passive\", {\n            get: function() {\n                passiveSupported = true;\n            }\n        });\n\n        window.addEventListener(\"test\", null, options);\n    } catch(err) {}\n\n    getPassiveSupported = () => passiveSupported;\n    return passiveSupported;\n}","export default (str, out) => {\n  if (!out)\n      out = [ 0, '' ]\n\n  str = String(str)\n  var num = parseFloat(str, 10)\n  out[0] = num\n  out[1] = str.match(/[\\d.\\-\\+]*\\s*(.*)/)[1] || ''\n  return out\n}","// (c) 2015 Mikola Lysenko. MIT License\n// https://github.com/mikolalysenko/to-px\n\nimport parseUnit from './parse-unit';\n\nvar PIXELS_PER_INCH = 96\n\nvar defaults = {\n  'ch': 8,\n  'ex': 7.15625,\n  'em': 16,\n  'rem': 16,\n  'in': PIXELS_PER_INCH,\n  'cm': PIXELS_PER_INCH / 2.54,\n  'mm': PIXELS_PER_INCH / 25.4,\n  'pt': PIXELS_PER_INCH / 72,\n  'pc': PIXELS_PER_INCH / 6,\n  'px': 1\n}\n\nexport default function toPX(str) {\n  if (!str) return null\n\n  if (defaults[str]) return defaults[str]\n\n  // detect number of units\n  var parts = parseUnit(str)\n  if (!isNaN(parts[0]) && parts[1]) {\n    var px = toPX(parts[1])\n    return typeof px === 'number' ? parts[0] * px : null;\n  }\n\n  return null;\n}","\nimport toPX from './mumath/to-px';\n\nexport default mouseWheelListen\n\nfunction mouseWheelListen(element, callback, noScroll) {\n  if(typeof element === 'function') {\n    noScroll = !!callback\n    callback = element\n    element = window\n  }\n  var lineHeight = toPX('ex', element)\n  var listener = function(ev) {\n    if(noScroll) {\n      ev.preventDefault()\n    }\n    var dx = ev.deltaX || 0\n    var dy = ev.deltaY || 0\n    var dz = ev.deltaZ || 0\n    var mode = ev.deltaMode\n    var scale = 1\n    switch(mode) {\n      case 1:\n        scale = lineHeight\n      break\n      case 2:\n        scale = window.innerHeight\n      break\n    }\n    dx *= scale\n    dy *= scale\n    dz *= scale\n    if(dx || dy || dz) {\n      return callback(dx, dy, dz, ev)\n    }\n  }\n  element.addEventListener('wheel', listener)\n  return listener\n}","'use strict';\n\nvar domain;\n\n// This constructor is used to store event handlers. Instantiating this is\n// faster than explicitly calling `Object.create(null)` to get a \"clean\" empty\n// object (tested with v8 v4.9).\nfunction EventHandlers() {}\nEventHandlers.prototype = Object.create(null);\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nexport default EventEmitter;\nexport {EventEmitter};\n\n// nodejs oddity\n// require('events') === require('events').EventEmitter\nEventEmitter.EventEmitter = EventEmitter\n\nEventEmitter.usingDomains = false;\n\nEventEmitter.prototype.domain = undefined;\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\nEventEmitter.init = function() {\n  this.domain = null;\n  if (EventEmitter.usingDomains) {\n    // if there is an active domain, then attach to it.\n    if (domain.active && !(this instanceof domain.Domain)) {\n      this.domain = domain.active;\n    }\n  }\n\n  if (!this._events || this._events === Object.getPrototypeOf(this)._events) {\n    this._events = new EventHandlers();\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || isNaN(n))\n    throw new TypeError('\"n\" argument must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nfunction $getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return $getMaxListeners(this);\n};\n\n// These standalone emit* functions are used to optimize calling of event\n// handlers for fast cases because emit() itself often has a variable number of\n// arguments and can be deoptimized because of that. These functions always have\n// the same number of arguments and thus do not get deoptimized, so the code\n// inside them can execute faster.\nfunction emitNone(handler, isFn, self) {\n  if (isFn)\n    handler.call(self);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self);\n  }\n}\nfunction emitOne(handler, isFn, self, arg1) {\n  if (isFn)\n    handler.call(self, arg1);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self, arg1);\n  }\n}\nfunction emitTwo(handler, isFn, self, arg1, arg2) {\n  if (isFn)\n    handler.call(self, arg1, arg2);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self, arg1, arg2);\n  }\n}\nfunction emitThree(handler, isFn, self, arg1, arg2, arg3) {\n  if (isFn)\n    handler.call(self, arg1, arg2, arg3);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self, arg1, arg2, arg3);\n  }\n}\n\nfunction emitMany(handler, isFn, self, args) {\n  if (isFn)\n    handler.apply(self, args);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].apply(self, args);\n  }\n}\n\nEventEmitter.prototype.emit = function emit(type) {\n  var er, handler, len, args, i, events, domain;\n  var needDomainExit = false;\n  var doError = (type === 'error');\n\n  events = this._events;\n  if (events)\n    doError = (doError && events.error == null);\n  else if (!doError)\n    return false;\n\n  domain = this.domain;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    er = arguments[1];\n    if (domain) {\n      if (!er)\n        er = new Error('Uncaught, unspecified \"error\" event');\n      er.domainEmitter = this;\n      er.domain = domain;\n      er.domainThrown = false;\n      domain.emit('error', er);\n    } else if (er instanceof Error) {\n      throw er; // Unhandled 'error' event\n    } else {\n      // At least give some kind of context to the user\n      var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n      err.context = er;\n      throw err;\n    }\n    return false;\n  }\n\n  handler = events[type];\n\n  if (!handler)\n    return false;\n\n  var isFn = typeof handler === 'function';\n  len = arguments.length;\n  switch (len) {\n    // fast cases\n    case 1:\n      emitNone(handler, isFn, this);\n      break;\n    case 2:\n      emitOne(handler, isFn, this, arguments[1]);\n      break;\n    case 3:\n      emitTwo(handler, isFn, this, arguments[1], arguments[2]);\n      break;\n    case 4:\n      emitThree(handler, isFn, this, arguments[1], arguments[2], arguments[3]);\n      break;\n    // slower\n    default:\n      args = new Array(len - 1);\n      for (i = 1; i < len; i++)\n        args[i - 1] = arguments[i];\n      emitMany(handler, isFn, this, args);\n  }\n\n  if (needDomainExit)\n    domain.exit();\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  if (typeof listener !== 'function')\n    throw new TypeError('\"listener\" argument must be a function');\n\n  events = target._events;\n  if (!events) {\n    events = target._events = new EventHandlers();\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (!existing) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] = prepend ? [listener, existing] :\n                                          [existing, listener];\n    } else {\n      // If we've already got an array, just append.\n      if (prepend) {\n        existing.unshift(listener);\n      } else {\n        existing.push(listener);\n      }\n    }\n\n    // Check for listener leak\n    if (!existing.warned) {\n      m = $getMaxListeners(target);\n      if (m && m > 0 && existing.length > m) {\n        existing.warned = true;\n        var w = new Error('Possible EventEmitter memory leak detected. ' +\n                            existing.length + ' ' + type + ' listeners added. ' +\n                            'Use emitter.setMaxListeners() to increase limit');\n        w.name = 'MaxListenersExceededWarning';\n        w.emitter = target;\n        w.type = type;\n        w.count = existing.length;\n        emitWarning(w);\n      }\n    }\n  }\n\n  return target;\n}\nfunction emitWarning(e) {\n  typeof console.warn === 'function' ? console.warn(e) : console.log(e);\n}\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction _onceWrap(target, type, listener) {\n  var fired = false;\n  function g() {\n    target.removeListener(type, g);\n    if (!fired) {\n      fired = true;\n      listener.apply(target, arguments);\n    }\n  }\n  g.listener = listener;\n  return g;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  if (typeof listener !== 'function')\n    throw new TypeError('\"listener\" argument must be a function');\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      if (typeof listener !== 'function')\n        throw new TypeError('\"listener\" argument must be a function');\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      if (typeof listener !== 'function')\n        throw new TypeError('\"listener\" argument must be a function');\n\n      events = this._events;\n      if (!events)\n        return this;\n\n      list = events[type];\n      if (!list)\n        return this;\n\n      if (list === listener || (list.listener && list.listener === listener)) {\n        if (--this._eventsCount === 0)\n          this._events = new EventHandlers();\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length; i-- > 0;) {\n          if (list[i] === listener ||\n              (list[i].listener && list[i].listener === listener)) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (list.length === 1) {\n          list[0] = undefined;\n          if (--this._eventsCount === 0) {\n            this._events = new EventHandlers();\n            return this;\n          } else {\n            delete events[type];\n          }\n        } else {\n          spliceOne(list, position);\n        }\n\n        if (events.removeListener)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events;\n\n      events = this._events;\n      if (!events)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (!events.removeListener) {\n        if (arguments.length === 0) {\n          this._events = new EventHandlers();\n          this._eventsCount = 0;\n        } else if (events[type]) {\n          if (--this._eventsCount === 0)\n            this._events = new EventHandlers();\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        for (var i = 0, key; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = new EventHandlers();\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners) {\n        // LIFO order\n        do {\n          this.removeListener(type, listeners[listeners.length - 1]);\n        } while (listeners[0]);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  var evlistener;\n  var ret;\n  var events = this._events;\n\n  if (!events)\n    ret = [];\n  else {\n    evlistener = events[type];\n    if (!evlistener)\n      ret = [];\n    else if (typeof evlistener === 'function')\n      ret = [evlistener.listener || evlistener];\n    else\n      ret = unwrapListeners(evlistener);\n  }\n\n  return ret;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? Reflect.ownKeys(this._events) : [];\n};\n\n// About 1.5x faster than the two-arg version of Array#splice().\nfunction spliceOne(list, index) {\n  for (var i = index, k = i + 1, n = list.length; k < n; i += 1, k += 1)\n    list[i] = list[k];\n  list.pop();\n}\n\nfunction arrayClone(arr, i) {\n  var copy = new Array(i);\n  while (i--)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","var rootPosition = { left: 0, top: 0 }\n\nexport default mouseEventOffset\nfunction mouseEventOffset (ev, target, out) {\n  target = target || ev.currentTarget || ev.srcElement\n  if (!Array.isArray(out)) {\n    out = [ 0, 0 ]\n  }\n  var cx = ev.clientX || 0\n  var cy = ev.clientY || 0\n  var rect = getBoundingClientOffset(target)\n  out[0] = cx - rect.left\n  out[1] = cy - rect.top\n  return out\n}\n\nfunction getBoundingClientOffset (element) {\n  if (element === window ||\n      element === document ||\n      element === document.body) {\n    return rootPosition\n  } else {\n    return element.getBoundingClientRect()\n  }\n}\n","import EventEmitter from 'events';\nimport eventOffset from './mouse-event-offset';\n\nfunction distance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1]\n  return Math.sqrt(x*x + y*y)\n}\n\nexport default touchPinch;\nfunction touchPinch (target) {\n  target = target || window\n\n  var emitter = new EventEmitter()\n  var fingers = [ null, null ]\n  var activeCount = 0\n\n  var lastDistance = 0\n  var ended = false\n  var enabled = false\n\n  // some read-only values\n  Object.defineProperties(emitter, {\n    pinching(){\n      return activeCount === 2\n    },\n\n    fingers() {\n      return fingers\n    }\n  })\n\n  enable()\n  emitter.enable = enable\n  emitter.disable = disable\n  emitter.indexOfTouch = indexOfTouch\n  return emitter\n\n  function indexOfTouch (touch) {\n    var id = touch.identifier\n    for (var i = 0; i < fingers.length; i++) {\n      if (fingers[i] &&\n        fingers[i].touch &&\n        fingers[i].touch.identifier === id) {\n        return i\n      }\n    }\n    return -1\n  }\n\n  function enable () {\n    if (enabled) return\n    enabled = true\n    target.addEventListener('touchstart', onTouchStart, false)\n    target.addEventListener('touchmove', onTouchMove, false)\n    target.addEventListener('touchend', onTouchRemoved, false)\n    target.addEventListener('touchcancel', onTouchRemoved, false)\n  }\n\n  function disable () {\n    if (!enabled) return\n    enabled = false\n    activeCount = 0\n    fingers[0] = null\n    fingers[1] = null\n    lastDistance = 0\n    ended = false\n    target.removeEventListener('touchstart', onTouchStart, false)\n    target.removeEventListener('touchmove', onTouchMove, false)\n    target.removeEventListener('touchend', onTouchRemoved, false)\n    target.removeEventListener('touchcancel', onTouchRemoved, false)\n  }\n\n  function onTouchStart (ev) {\n    for (var i = 0; i < ev.changedTouches.length; i++) {\n      var newTouch = ev.changedTouches[i]\n      var id = newTouch.identifier\n      var idx = indexOfTouch(id)\n\n      if (idx === -1 && activeCount < 2) {\n        var first = activeCount === 0\n\n        // newest and previous finger (previous may be undefined)\n        var newIndex = fingers[0] ? 1 : 0\n        var oldIndex = fingers[0] ? 0 : 1\n        var newFinger = new Finger()\n\n        // add to stack\n        fingers[newIndex] = newFinger\n        activeCount++\n\n        // update touch event & position\n        newFinger.touch = newTouch\n        eventOffset(newTouch, target, newFinger.position)\n\n        var oldTouch = fingers[oldIndex] ? fingers[oldIndex].touch : undefined\n        emitter.emit('place', newTouch, oldTouch)\n\n        if (!first) {\n          var initialDistance = computeDistance()\n          ended = false\n          emitter.emit('start', initialDistance)\n          lastDistance = initialDistance\n        }\n      }\n    }\n  }\n\n  function onTouchMove (ev) {\n    var changed = false\n    for (var i = 0; i < ev.changedTouches.length; i++) {\n      var movedTouch = ev.changedTouches[i]\n      var idx = indexOfTouch(movedTouch)\n      if (idx !== -1) {\n        changed = true\n        fingers[idx].touch = movedTouch // avoid caching touches\n        eventOffset(movedTouch, target, fingers[idx].position)\n      }\n    }\n\n    if (activeCount === 2 && changed) {\n      var currentDistance = computeDistance()\n      emitter.emit('change', currentDistance, lastDistance)\n      lastDistance = currentDistance\n    }\n  }\n\n  function onTouchRemoved (ev) {\n    for (var i = 0; i < ev.changedTouches.length; i++) {\n      var removed = ev.changedTouches[i]\n      var idx = indexOfTouch(removed)\n\n      if (idx !== -1) {\n        fingers[idx] = null\n        activeCount--\n        var otherIdx = idx === 0 ? 1 : 0\n        var otherTouch = fingers[otherIdx] ? fingers[otherIdx].touch : undefined\n        emitter.emit('lift', removed, otherTouch)\n      }\n    }\n\n    if (!ended && activeCount !== 2) {\n      ended = true\n      emitter.emit('end')\n    }\n  }\n\n  function computeDistance () {\n    if (activeCount < 2) return 0\n    return distance(fingers[0].position, fingers[1].position)\n  }\n}\n\nfunction Finger () {\n  this.position = [0, 0]\n  this.touch = null\n}\n","function getPrefixed(name) {\n\treturn window['webkit' + name] || window['moz' + name] || window['ms' + name];\n}\n\nvar lastTime = 0;\n\n// fallback for IE 7-8\nfunction timeoutDefer(fn) {\n\tvar time = +new Date(),\n\t    timeToCall = Math.max(0, 16 - (time - lastTime));\n\n\tlastTime = time + timeToCall;\n\treturn window.setTimeout(fn, timeToCall);\n}\n\nexport function bind(fn, obj) {\n\tvar slice = Array.prototype.slice;\n\n\tif (fn.bind) {\n\t\treturn fn.bind.apply(fn, slice.call(arguments, 1));\n\t}\n\n\tvar args = slice.call(arguments, 2);\n\n\treturn function () {\n\t\treturn fn.apply(obj, args.length ? args.concat(slice.call(arguments)) : arguments);\n\t};\n}\n\nexport var requestFn = window.requestAnimationFrame || getPrefixed('RequestAnimationFrame') || timeoutDefer;\nexport var cancelFn = window.cancelAnimationFrame || getPrefixed('CancelAnimationFrame') ||\n\t\tgetPrefixed('CancelRequestAnimationFrame') || function (id) { window.clearTimeout(id); };\n\nconst raf = (fn, context, immediate) =>{\n\tif (immediate && requestFn === timeoutDefer) {\n\t\tfn.call(context);\n\t} else {\n\t\treturn requestFn.call(window, bind(fn, context));\n\t}\n} \n\nraf.cancel = (id) => {\n\tif (id) {\n\t\tcancelFn.call(window, id);\n\t}\n}\n\nexport default raf;","import evPos from './ev-pos';\nimport Impetus from './impetus';\nimport wheel  from './mouse-wheel';\nimport touchPinch  from './touch-pinch';\nimport raf from './raf';\n\nconsole.log('touchPinch = ', touchPinch);\nconsole.log('raf = ', raf);\n\nconst panzoom = (target, cb) =>  {\n\tif (target instanceof Function) {\n\t\tcb = target\n\t\ttarget = document.documentElement || document.body\n\t}\n\n\tif (typeof target === 'string') target = document.querySelector(target)\n\n\tlet cursor = {\n\t\tx:0,\n\t\ty:0\n\t}\n\n\tconst hasPassive = () => {\n\t\tlet supported = false\n\n\t\ttry {\n\t\t\tconst opts = Object.defineProperty({}, 'passive', {\n\t\t\t\tget() {\n\t\t\t\t\tsupported = true;\n\t\t\t\t}\n\t\t\t}); \n\n\t\t\twindow.addEventListener('test', null, opts);\n\t\t\twindow.removeEventListener('test', null, opts);\n\t\t} catch(e) {\n\t\t\tsupported = false;\n\t\t}\n\n\t\treturn supported;\n\t}\n\n\tlet impetus;\n\n\tlet initX = 0; let initY = 0; let init = true\n\tconst initFn = function (e) { init = true }\n\ttarget.addEventListener('mousedown', initFn)\n\ttarget.addEventListener('mousemove', (e)=> {\n\t\tcursor = evPos(e);\n\t});\n\ttarget.addEventListener('wheel', (e)=> {\n\t\t\n\t\tif(e) {\n\t\t\tcursor = evPos(e);\n\t\t}\n\t});\n\ttarget.addEventListener('touchstart', initFn, hasPassive() ? { passive: true } : false)\n\n\tlet lastY = 0; let lastX = 0\n\timpetus = new Impetus({\n\t\tsource: target,\n\t\tupdate (x, y) {\n\t\t\tif (init) {\n\t\t\t\tinit = false\n\t\t\t\tinitX = cursor.x\n\t\t\t\tinitY = cursor.y\n\t\t\t}\n\n\t\t\tconst e = {\n\t\t\t\ttarget,\n\t\t\t\ttype: 'mouse',\n\t\t\t\tdx: x - lastX, dy: y - lastY, dz: 0,\n\t\t\t\tx: cursor.x,\n\t\t\t\ty: cursor.y,\n\t\t\t\tx0: initX, y0: initY\n\t\t\t}\n\n\t\t\tlastX = x\n\t\t\tlastY = y\n\n\t\t\tschedule(e)\n\t\t},\n\t\tmultiplier: 1,\n\t\tfriction: .75\n\t})\n\n\t// enable zooming\n\tconst wheelListener = wheel(target, function (dx, dy, dz, e) {\n\t\te.preventDefault();\n\t\tschedule({\n\t\t\ttarget,\n\t\t\ttype: 'mouse',\n\t\t\tdx: 0, dy: 0, dz: dy,\n\t\t\tx: cursor.x,\n\t\t\ty: cursor.y,\n\t\t\tx0: cursor.x,\n\t\t\ty0: cursor.y\n\t\t})\n\t})\n\n\t// mobile pinch zoom\n\tconst pinch = touchPinch(target)\n\tconst mult = 2\n\tlet initialCoords\n\n\tpinch.on('start', function (curr) {\n\t\tconst f1 = pinch.fingers[0];\n\t\tconst f2 = pinch.fingers[1];\n\n\t\tinitialCoords = [\n\t\t\tf2.position[0] * .5 + f1.position[0] * .5,\n\t\t\tf2.position[1] * .5 + f1.position[1] * .5\n\t\t]\n\n\t\timpetus && impetus.pause()\n\t})\n\tpinch.on('end', function () {\n\t\tif (!initialCoords) return\n\n\t\tinitialCoords = null\n\n\t\timpetus && impetus.resume()\n\t})\n\tpinch.on('change', function (curr, prev) {\n\t\tif (!pinch.pinching || !initialCoords) return\n\n\t\tschedule({\n\t\t\ttarget,\n\t\t\ttype: 'touch',\n\t\t\tdx: 0, dy: 0, dz: - (curr - prev) * mult,\n\t\t\tx: initialCoords[0], y: initialCoords[1],\n\t\t\tx0: initialCoords[0], y0: initialCoords[0]\n\t\t})\n\t})\n\n\n\t// schedule function to current or next frame\n\tlet planned; let frameId\n\tfunction schedule (ev) {\n\t\tif (frameId != null) {\n\t\t\tif (!planned) planned = ev\n\t\t\telse {\n\t\t\t\tplanned.dx += ev.dx\n\t\t\t\tplanned.dy += ev.dy\n\t\t\t\tplanned.dz += ev.dz\n\n\t\t\t\tplanned.x = ev.x\n\t\t\t\tplanned.y = ev.y\n\t\t\t}\n\n\t\t\treturn\n\t\t}\n\n\t\t// Firefox sometimes does not clear webgl current drawing buffer\n\t\t// so we have to schedule callback to the next frame, not the current\n\t\t// cb(ev)\n\n\t\tframeId = raf(function () {\n\t\t\tcb(ev)\n\t\t\tframeId = null\n\t\t\tif (planned) {\n\t\t\t\tconst arg = planned\n\t\t\t\tplanned = null\n\t\t\t\tschedule(arg)\n\t\t\t}\n\t\t})\n\t}\n\n\treturn function unpanzoom () {\n\n\t\ttarget.removeEventListener('mousedown', initFn)\n\t\ttarget.removeEventListener('wheel')\n\t\ttarget.removeEventListener('touchstart', initFn)\n\n\t\timpetus.destroy()\n\n\t\ttarget.removeEventListener('wheel', wheelListener)\n\n\t\tpinch.disable()\n\n\t\traf.cancel(frameId)\n\t}\n}\n\nexport default panzoom;","/**\n * Clamp value.\n * Detects proper clamp min/max.\n *\n * @param {number} a Current value to cut off\n * @param {number} min One side limit\n * @param {number} max Other side limit\n *\n * @return {number} Clamped value\n */\n\nfunction clamp(a, min, max) {\n\treturn max > min ? Math.max(Math.min(a,max),min) : Math.max(Math.min(a,min),max);\n};\n\nexport default clamp;\n","/**\n * Return quadratic length\n *\n * @module  mumath/len\n *\n */\n\nexport default function len(a, b) {\n\treturn Math.sqrt(a*a + b*b);\n};\n","/**\n * @module mumath/lerp\n */\n'use strict';\nexport default function (x, y, a) {\n\treturn x * (1.0 - a) + y * a;\n};\n","/**\n * Looping function for any framesize.\n * Like fmod.\n *\n * @module  mumath/loop\n *\n */\n\nexport default function (value, left, right) {\n\t//detect single-arg case, like mod-loop or fmod\n\tif (right === undefined) {\n\t\tright = left;\n\t\tleft = 0;\n\t}\n\n\t//swap frame order\n\tif (left > right) {\n\t\tvar tmp = right;\n\t\tright = left;\n\t\tleft = tmp;\n\t}\n\n\tvar frame = right - left;\n\n\tvalue = ((value + left) % frame) - left;\n\tif (value < left) value += frame;\n\tif (value > right) value -= frame;\n\n\treturn value;\n};\n","\n// Type definitions for almost-equal 1.1\n// Project: https://github.com/mikolalysenko/almost-equal#readme\n// Definitions by: Curtis Maddalozzo <https://github.com/cmaddalozzo>\n// Definitions: https://github.com/DefinitelyTyped/DefinitelyTyped\n\nvar abs = Math.abs;\nvar min = Math.min;\n\nfunction almostEqual(a, b, absoluteError, relativeError) {\n  var d = abs(a - b)\n  \n  if (absoluteError == null) absoluteError = almostEqual.DBL_EPSILON;\n  if (relativeError == null) relativeError = absoluteError;\n  \n  if(d <= absoluteError) {\n    return true\n  }\n  if(d <= relativeError * min(abs(a), abs(b))) {\n    return true\n  }\n  return a === b\n}\n\nexport const FLT_EPSILON = 1.19209290e-7\nexport const DBL_EPSILON = 2.2204460492503131e-16\n\nalmostEqual.FLT_EPSILON = FLT_EPSILON;\nalmostEqual.DBL_EPSILON = DBL_EPSILON;\n\nexport default almostEqual;","/**\n * Get rid of float remainder\n *\n * @module mumath/normalize\n */\n'use strict';\n\nimport { FLT_EPSILON } from './almost';\n\nexport default function(value, eps) {\n\t//ignore ints\n\tvar rem = value%1;\n\tif (!rem) return value;\n\n\tif (eps == null) eps = Number.EPSILON || FLT_EPSILON;\n\n\t//pick number’s neighbour, which is way shorter, like 0.4999999999999998 → 0.5\n\t//O(20)\n\tvar range = 5;\n\tvar len = (rem+'').length;\n\n\tfor (var i = 1; i < range; i+=.5) {\n\t\tvar left = rem - eps*i,\n\t\t\tright = rem + eps*i;\n\n\t\tvar leftStr = left+'', rightStr = right + '';\n\n\t\tif (len - leftStr.length > 2) return value - eps*i;\n\t\tif (len - rightStr.length > 2) return value + eps*i;\n\n\t\t// if (leftStr[2] != rightStr[2])\n\t}\n\n\treturn value;\n};\n","/**\n * @module  mumath/precision\n *\n * Get precision from float:\n *\n * @example\n * 1.1 → 1, 1234 → 0, .1234 → 4\n *\n * @param {number} n\n *\n * @return {number} decimap places\n */\n'use strict';\n\nimport almost from './almost';\nimport norm from './normalize';\n\nexport default function (n, eps) {\n\tn = norm(n);\n\n\tvar str = n + '';\n\n\t//1e-10 etc\n\tvar e = str.indexOf('e-');\n\tif (e >= 0) return parseInt(str.substring(e+2));\n\n\t//imperfect ints, like 3.0000000000000004 or 1.9999999999999998\n\tvar remainder = Math.abs(n % 1);\n\tvar remStr = remainder + '';\n\n\tif (almost(remainder, 1, eps) || almost(remainder, 0, eps)) return 0;\n\n\t//usual floats like .0123\n\tvar d = remStr.indexOf('.') + 1;\n\n\tif (d) return remStr.length - d;\n\n\t//regular inte\n\treturn 0;\n};\n","/**\n * Precision round\n *\n * @param {number} value\n * @param {number} step Minimal discrete to round\n *\n * @return {number}\n *\n * @example\n * toPrecision(213.34, 1) == 213\n * toPrecision(213.34, .1) == 213.3\n * toPrecision(213.34, 10) == 210\n */\n'use strict';\nimport precision from './precision';\n\nexport default function(value, step) {\n\tif (step === 0) return value;\n\tif (!step) return Math.round(value);\n\tvalue = Math.round(value / step) * step;\n\treturn parseFloat(value.toFixed(precision(step)));\n};\n","// The MIT License (MIT)\n\n// Copyright (c) 2016 angus croll\n\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n\n// The above copyright notice and this permission notice shall be included in all\n// copies or substantial portions of the Software.\n\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n// SOFTWARE.\n\n/*\n  range(0, 5); // [0, 1, 2, 3, 4]\n  range(5); // [0, 1, 2, 3, 4]\n  range(-5); // [0, -1, -2, -3, -4]\n  range(0, 20, 5) // [0, 5, 10, 15]\n  range(0, -20, -5) // [0, -5, -10, -15]\n*/\n\nexport default function range(start, stop, step) {\n  if (start != null && typeof start != 'number') {\n    throw new Error('start must be a number or null');\n  }\n  if (stop != null && typeof stop != 'number') {\n    throw new Error('stop must be a number or null');\n  }\n  if (step != null && typeof step != 'number') {\n    throw new Error('step must be a number or null');\n  }\n  if (stop == null) {\n    stop = start || 0;\n    start = 0;\n  }\n  if (step == null) {\n    step = stop > start ? 1 : -1;\n  }\n  var toReturn = [];\n  var increasing = start < stop; //← here’s the change\n  for (; increasing ? start < stop : start > stop; start += step) {\n    toReturn.push(start);\n  }\n  return toReturn;\n}","/**\n * @module mumath/order\n */\nexport default function (n) {\n\tn = Math.abs(n);\n\tvar order = Math.floor(Math.log(n) / Math.LN10 + 0.000000001);\n\treturn Math.pow(10,order);\n};\n","/**\n * Base 10 logarithm\n *\n * @module mumath/log10\n */\n'use strict';\nexport default Math.log10 || function (a) {\n\treturn Math.log(a) / Math.log(10);\n};\n","/**\n * Check if one number is multiple of other\n *\n * @module  mumath/is-multiple\n */\n\nimport almost from './almost';\n\nexport default function isMultiple(a, b, eps) {\n\tvar remainder = a % b;\n\n\tif (!eps) eps = almost.FLT_EPSILON;\n\n\tif (!remainder) return true;\n\tif (almost(0, remainder, eps, 0) || almost(Math.abs(b), Math.abs(remainder), eps, 0)) return true;\n\n\treturn false;\n}\n","/**\n * Get step out of the set\n *\n * @module mumath/step\n */\n'use strict';\n\nimport lg from './log10';\n\nexport default function (minStep, srcSteps) {\n\tvar power = Math.floor(lg(minStep));\n\n\tvar order = Math.pow(10, power);\n\tvar steps = srcSteps.map(v => v*order);\n\torder = Math.pow(10, power+1);\n\tsteps = steps.concat(srcSteps.map(v => v*order));\n\n\t//find closest scale\n\tvar step = 0;\n\tfor (var i = 0; i < steps.length; i++) {\n\t\tstep = steps[i];\n\t\tif (step >= minStep) break;\n\t}\n\n\treturn step;\n};\n","/**\n * MIT © Sindre Sorhus\n * https://github.com/sindresorhus/is-plain-obj/blob/master/index.js\n */\nexport default (value) => {\n\tif (Object.prototype.toString.call(value) !== '[object Object]') {\n\t\treturn false;\n\t}\n\n\tconst prototype = Object.getPrototypeOf(value);\n\treturn prototype === null || prototype === Object.getPrototypeOf({});\n};\n","/**\n * Composed set of all math utils, wrapped\n *\n * @module  mumath\n */\n\nexport { default as clamp } from './clamp';\nexport { default as len } from './len';\nexport { default as lerp } from './lerp';\nexport { default as mod } from './mod';\nexport { default as round } from './round';\nexport { default as range } from './range';\nexport { default as order } from './order';\nexport { default as normalize } from './normalize';\nexport { default as almost } from './almost';\nexport { default as lg } from './log10';\nexport { default as isMultiple } from './is-multiple';\nexport { default as scale } from './scale';\nexport { default as pad } from './left-pad';\nexport { default as parseUnit } from './parse-unit';\nexport { default as toPx } from './to-px';\nexport { default as isObj } from './is-plain-obj';","import Emitter from 'events';\n\nclass Base extends Emitter {\n  constructor(options) {\n    super(options);\n    this._options = options || {};\n    Object.assign(this, options);\n  }\n}\nexport default Base;\n","import { Point } from '../geometry/Point.js';\n\nexport const Modes = {\n  SELECT: 'SELECT',\n  GRAB: 'GRAB',\n  DRAW: 'DRAW'\n};\n\nexport const MAP = {\n  center: new Point(),\n  zoom: 1,\n  minZoom: 0,\n  maxZoom: 20,\n  gridEnabled: true,\n  zoomEnabled: true,\n  selectEnabled: true,\n  mode: Modes.SELECT\n};\n\nexport const MARKER = {\n  position: new Point(),\n  minZoom: 1,\n  maxZoom: 20\n};\n\nexport const ICON = {\n  url: 'data:image/png;base64,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',\n  size: [128, 128],\n  anchor: [64, 64]\n};\n\nfabric.Object.prototype.originX = 'center';\nfabric.Object.prototype.originY = 'center';\n\nfabric.Object.prototype.lockUniScaling = true;\nfabric.Object.prototype.lockScalingFlip = true;\nfabric.Object.prototype.transparentCorners = false;\nfabric.Object.prototype.centeredScaling = true;\nfabric.Object.prototype.cornerStyle = 'circle';\nfabric.Object.prototype.cornerColor = 'blue';\nfabric.Object.prototype.borderColor = 'blue';\nfabric.Object.prototype.borderOpacity = 0.7;\nfabric.Object.prototype.cornerOpacity = 0.7;\nfabric.Object.prototype.cornerStrokeColor = 'blue';\n\nfabric.Object.prototype.borderColor = '#2dcfab';\nfabric.Object.prototype.cornerColor = '#2dcfab';\nfabric.Object.prototype.cornerStrokeColor = '#176957';\n\nfabric.Object.prototype.objectCaching = false;\nfabric.Group.prototype.objectCaching = true;\n\nfabric.Group.prototype.selectionBackgroundColor = 'rgba(45,207,171,0.25)';\n\nfabric.Object.prototype.borderDashArray = [3, 3];\n\nfabric.Object.prototype.padding = 5;\n","export default alpha;\n\nfunction alpha (color, value) {\n\tlet obj = color.replace(/[^\\d,]/g, '').split(',');\n\n  if (value == null) value = obj[3] || 1;\n  \n  obj[3] = value;\n\n\treturn 'rgba('+obj.join(',')+')';\n}\n","/* eslint-disable consistent-return */\nimport alpha from '../lib/color-alpha';\nimport {\n  range, almost, scale, isMultiple, lg\n} from '../lib/mumath/index';\n\nconst gridStyle = {\n  steps: [1, 2, 5],\n  distance: 20,\n  unit: 10,\n  lines: (state) => {\n    const coord = state.coordinate;\n    // eslint-disable-next-line no-multi-assign\n    const step = state.step = scale(coord.distance * coord.zoom, coord.steps);\n    return range(Math.floor(state.offset / step) * step,\n      Math.ceil((state.offset + state.range) / step + 1) * step, step);\n  },\n  lineColor: (state) => {\n    if (!state.lines) return;\n    const coord = state.coordinate;\n\n    const light = alpha(coord.color, 0.1);\n    const heavy = alpha(coord.color, 0.3);\n\n    const step = state.step;\n    const power = Math.ceil(lg(step));\n    const tenStep = 10 ** power;\n    const nextStep = 10 ** (power + 1);\n    const eps = step / 10;\n    const colors = state.lines.map(v => {\n      if (isMultiple(v, nextStep, eps)) return heavy;\n      if (isMultiple(v, tenStep, eps)) return light;\n      return null;\n    });\n    return colors;\n  },\n  ticks: state => {\n    if (!state.lines) return;\n    const coord = state.coordinate;\n    const step = scale(scale(state.step * 1.1, coord.steps) * 1.1, coord.steps);\n    const eps = step / 10;\n    const tickWidth = state.axisWidth * 4;\n    return state.lines.map(v => {\n      if (!isMultiple(v, step, eps)) return null;\n      if (almost(v, 0, eps)) return null;\n      return tickWidth;\n    });\n  },\n  labels: state => {\n    if (!state.lines) return;\n    const coord = state.coordinate;\n\n    const step = scale(scale(state.step * 1.1, coord.steps) * 1.1, coord.steps);\n    // let precision = clamp(Math.abs(Math.floor(lg(step))), 10, 20);\n    const eps = step / 10;\n    return state.lines.map(v => {\n      if (!isMultiple(v, step, eps)) return null;\n      if (almost(v, 0, eps)) return coord.orientation === 'y' ? null : '0';\n      v = Number((v / 10).toFixed(2));\n      return coord.format(v);\n    });\n  }\n};\n\nexport default gridStyle;\n","class Axis {\n  constructor(orientation, options) {\n    Object.assign(this, options);\n    this.orientation = orientation || 'x';\n  }\n\n  getCoords(values) {\n    const coords = [];\n    if (!values) return coords;\n    for (let i = 0; i < values.length; i += 1) {\n      const t = this.getRatio(values[i]);\n      coords.push(t);\n      coords.push(0);\n      coords.push(t);\n      coords.push(1);\n    }\n    return coords;\n  }\n\n  getRange() {\n    let len = this.width;\n    if (this.orientation === 'y') len = this.height;\n    return len * this.zoom;\n  }\n\n  getRatio(value) {\n    return (value - this.offset) / this.range;\n  }\n\n  setOffset(offset) {\n    this.offset = offset;\n  }\n\n  update(options) {\n    options = options || {};\n    Object.assign(this, options);\n\n    this.range = this.getRange();\n  }\n}\nexport default Axis;\n","import alpha from '../lib/color-alpha';\nimport Base from '../core/Base';\nimport {\n  clamp, almost, len, parseUnit, toPx, isObj\n} from '../lib/mumath/index';\nimport gridStyle from './gridStyle';\nimport Axis from './Axis';\nimport { Point } from '../geometry/Point';\n\n// constructor\nclass Grid extends Base {\n  constructor(canvas, opts) {\n    super(opts);\n    this.canvas = canvas;\n    this.context = this.canvas.getContext('2d');\n    this.state = {};\n    this.setDefaults();\n    this.update(opts);\n  }\n\n  render() {\n    this.draw();\n    return this;\n  }\n\n  getCenterCoords() {\n    let state = this.state.x;\n    let [width, height] = state.shape;\n    let [pt, pr, pb, pl] = state.padding;\n    let axisCoords = state.opposite.coordinate.getCoords(\n      [state.coordinate.axisOrigin],\n      state.opposite\n    );\n    const y = pt + axisCoords[1] * (height - pt - pb);\n    state = this.state.y;\n    [width, height] = state.shape;\n    [pt, pr, pb, pl] = state.padding;\n    axisCoords = state.opposite.coordinate.getCoords([state.coordinate.axisOrigin], state.opposite);\n    const x = pl + axisCoords[0] * (width - pr - pl);\n    return { x, y };\n  }\n\n  // re-evaluate lines, calc options for renderer\n  update(opts) {\n    if (!opts) opts = {};\n    console.log(opts);\n    const shape = [this.canvas.width, this.canvas.height];\n\n    // recalc state\n    this.state.x = this.calcCoordinate(this.axisX, shape, this);\n    this.state.y = this.calcCoordinate(this.axisY, shape, this);\n    this.state.x.opposite = this.state.y;\n    this.state.y.opposite = this.state.x;\n    this.emit('update', opts);\n    return this;\n  }\n\n  // re-evaluate lines, calc options for renderer\n  update2(center) {\n    if (!center) return;\n    const shape = [this.canvas.width, this.canvas.height];\n    Object.assign(this.center, center);\n    // recalc state\n    this.state.x = this.calcCoordinate(this.axisX, shape, this);\n    this.state.y = this.calcCoordinate(this.axisY, shape, this);\n    this.state.x.opposite = this.state.y;\n    this.state.y.opposite = this.state.x;\n    this.emit('update', center);\n\n    this.axisX.offset = center.x;\n    this.axisX.zoom = 1 / center.zoom;\n\n    this.axisY.offset = center.y;\n    this.axisY.zoom = 1 / center.zoom;\n  }\n\n  // get state object with calculated params, ready for rendering\n  calcCoordinate(coord, shape) {\n    const state = {\n      coordinate: coord,\n      shape,\n      grid: this\n    };\n    // calculate real offset/range\n    state.range = coord.getRange(state);\n    state.offset = clamp(\n      coord.offset - state.range * clamp(0.5, 0, 1),\n      Math.max(coord.min, -Number.MAX_VALUE + 1),\n      Math.min(coord.max, Number.MAX_VALUE) - state.range\n    );\n\n    state.zoom = coord.zoom;\n    // calc style\n    state.axisColor = typeof coord.axisColor === 'number'\n      ? alpha(coord.color, coord.axisColor)\n      : coord.axisColor || coord.color;\n\n    state.axisWidth = coord.axisWidth || coord.lineWidth;\n    state.lineWidth = coord.lineWidth;\n    state.tickAlign = coord.tickAlign;\n    state.labelColor = state.color;\n    // get padding\n    if (typeof coord.padding === 'number') {\n      state.padding = Array(4).fill(coord.padding);\n    } else if (coord.padding instanceof Function) {\n      state.padding = coord.padding(state);\n    } else {\n      state.padding = coord.padding;\n    }\n    // calc font\n    if (typeof coord.fontSize === 'number') {\n      state.fontSize = coord.fontSize;\n    } else {\n      const units = parseUnit(coord.fontSize);\n      state.fontSize = units[0] * toPx(units[1]);\n    }\n    state.fontFamily = coord.fontFamily || 'sans-serif';\n    // get lines stops, including joined list of values\n    let lines;\n    if (coord.lines instanceof Function) {\n      lines = coord.lines(state);\n    } else {\n      lines = coord.lines || [];\n    }\n    state.lines = lines;\n    // calc colors\n    if (coord.lineColor instanceof Function) {\n      state.lineColors = coord.lineColor(state);\n    } else if (Array.isArray(coord.lineColor)) {\n      state.lineColors = coord.lineColor;\n    } else {\n      let color = alpha(coord.color, coord.lineColor);\n      if (typeof coord.lineColor !== 'number') {\n        color = coord.lineColor === false || coord.lineColor == null ? null : coord.color;\n      }\n      state.lineColors = Array(lines.length).fill(color);\n    }\n    // calc ticks\n    let ticks;\n    if (coord.ticks instanceof Function) {\n      ticks = coord.ticks(state);\n    } else if (Array.isArray(coord.ticks)) {\n      ticks = coord.ticks;\n    } else {\n      const tick = coord.ticks === true || coord.ticks === true\n        ? state.axisWidth * 2 : coord.ticks || 0;\n      ticks = Array(lines.length).fill(tick);\n    }\n    state.ticks = ticks;\n    // calc labels\n    let labels;\n    if (coord.labels === true) labels = state.lines;\n    else if (coord.labels instanceof Function) {\n      labels = coord.labels(state);\n    } else if (Array.isArray(coord.labels)) {\n      labels = coord.labels;\n    } else if (isObj(coord.labels)) {\n      labels = coord.labels;\n    } else {\n      labels = Array(state.lines.length).fill(null);\n    }\n    state.labels = labels;\n    // convert hashmap ticks/labels to lines + colors\n    if (isObj(ticks)) {\n      state.ticks = Array(lines.length).fill(0);\n    }\n    if (isObj(labels)) {\n      state.labels = Array(lines.length).fill(null);\n    }\n    if (isObj(ticks)) {\n      // eslint-disable-next-line guard-for-in\n      Object.keys(ticks).forEach((value, tick) => {\n        state.ticks.push(tick);\n        state.lines.push(parseFloat(value));\n        state.lineColors.push(null);\n        state.labels.push(null);\n      });\n    }\n\n    if (isObj(labels)) {\n      Object.keys(labels).forEach((label, value) => {\n        state.labels.push(label);\n        state.lines.push(parseFloat(value));\n        state.lineColors.push(null);\n        state.ticks.push(null);\n      });\n    }\n\n    return state;\n  }\n\n  setDefaults() {\n    console.log(this.options);\n    this.pixelRatio = window.devicePixelRatio;\n    this.autostart = true;\n    this.interactions = true;\n\n    this.defaults = Object.assign(\n      {\n        type: 'linear',\n        name: '',\n        units: '',\n        state: {},\n\n        // visible range params\n        minZoom: -Infinity,\n        maxZoom: Infinity,\n        min: -Infinity,\n        max: Infinity,\n        offset: 0,\n        origin: 0.5,\n        center: {\n          x: 0,\n          y: 0,\n          zoom: 1\n        },\n        zoom: 1,\n        zoomEnabled: true,\n        panEnabled: true,\n\n        // labels\n        labels: true,\n        fontSize: '11pt',\n        fontFamily: 'sans-serif',\n        padding: 0,\n        color: 'rgb(0,0,0,1)',\n\n        // lines params\n        lines: true,\n        tick: 8,\n        tickAlign: 0.5,\n        lineWidth: 1,\n        distance: 13,\n        style: 'lines',\n        lineColor: 0.4,\n\n        // axis params\n        axis: true,\n        axisOrigin: 0,\n        axisWidth: 2,\n        axisColor: 0.8,\n\n        // stub methods\n        // return coords for the values, redefined by axes\n        getCoords: () => [0, 0, 0, 0],\n\n        // return 0..1 ratio based on value/offset/range, redefined by axes\n        getRatio: () => 0,\n\n        // default label formatter\n        format: v => v\n      },\n      gridStyle,\n      this._options\n    );\n\n    this.axisX = new Axis('x', this.defaults);\n    this.axisY = new Axis('y', this.defaults);\n\n    this.axisX = Object.assign({}, this.defaults, {\n      orientation: 'x',\n      offset: this.center.x,\n      getCoords: (values, state) => {\n        const coords = [];\n        if (!values) return coords;\n        for (let i = 0; i < values.length; i += 1) {\n          const t = state.coordinate.getRatio(values[i], state);\n          coords.push(t);\n          coords.push(0);\n          coords.push(t);\n          coords.push(1);\n        }\n        return coords;\n      },\n      getRange: state => state.shape[0] * state.coordinate.zoom,\n      // FIXME: handle infinity case here\n      getRatio: (value, state) => (value - state.offset) / state.range\n    });\n    this.axisY = Object.assign({}, this.defaults, {\n      orientation: 'y',\n      offset: this.center.y,\n      getCoords: (values, state) => {\n        const coords = [];\n        if (!values) return coords;\n        for (let i = 0; i < values.length; i += 1) {\n          const t = state.coordinate.getRatio(values[i], state);\n          coords.push(0);\n          coords.push(t);\n          coords.push(1);\n          coords.push(t);\n        }\n        return coords;\n      },\n      getRange: state => state.shape[1] * state.coordinate.zoom,\n      getRatio: (value, state) => 1 - (value - state.offset) / state.range\n    });\n\n    Object.assign(this, this.defaults);\n    Object.assign(this, this._options);\n\n    this.center = new Point(this.center);\n  }\n\n  // draw grid to the canvas\n  draw() {\n    this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    this.drawLines(this.state.x);\n    this.drawLines(this.state.y);\n    return this;\n  }\n\n  // lines instance draw\n  drawLines(state) {\n    // draw lines and sublines\n    if (!state || !state.coordinate) return;\n\n    const ctx = this.context;\n    const [width, height] = state.shape;\n    const left = 0;\n    const top = 0;\n    const [pt, pr, pb, pl] = state.padding;\n\n    let axisRatio = state.opposite.coordinate.getRatio(state.coordinate.axisOrigin, state.opposite);\n    axisRatio = clamp(axisRatio, 0, 1);\n    const coords = state.coordinate.getCoords(state.lines, state);\n    // draw state.lines\n    ctx.lineWidth = 1; // state.lineWidth/2.;\n    for (let i = 0, j = 0; i < coords.length; i += 4, j += 1) {\n      const color = state.lineColors[j];\n      if (!color) continue;\n      ctx.strokeStyle = color;\n      ctx.beginPath();\n      const x1 = left + pl + coords[i] * (width - pr - pl);\n      const y1 = top + pt + coords[i + 1] * (height - pb - pt);\n      const x2 = left + pl + coords[i + 2] * (width - pr - pl);\n      const y2 = top + pt + coords[i + 3] * (height - pb - pt);\n      ctx.moveTo(x1, y1);\n      ctx.lineTo(x2, y2);\n      ctx.stroke();\n      ctx.closePath();\n    }\n    const normals = [];\n    for (let i = 0; i < coords.length; i += 4) {\n      const x1 = coords[i];\n      const y1 = coords[i + 1];\n      const x2 = coords[i + 2];\n      const y2 = coords[i + 3];\n      const xDif = x2 - x1;\n      const yDif = y2 - y1;\n      const dist = len(xDif, yDif);\n      normals.push(xDif / dist);\n      normals.push(yDif / dist);\n    }\n    // calc state.labels/tick coords\n    const tickCoords = [];\n    state.labelCoords = [];\n    const ticks = state.ticks;\n    for (let i = 0, j = 0, k = 0; i < normals.length; k += 1, i += 2, j += 4) {\n      const x1 = coords[j];\n      const y1 = coords[j + 1];\n      const x2 = coords[j + 2];\n      const y2 = coords[j + 3];\n      const xDif = (x2 - x1) * axisRatio;\n      const yDif = (y2 - y1) * axisRatio;\n      const tick = [\n        (normals[i] * ticks[k]) / (width - pl - pr),\n        (normals[i + 1] * ticks[k]) / (height - pt - pb)\n      ];\n      tickCoords.push(normals[i] * (xDif + tick[0] * state.tickAlign) + x1);\n      tickCoords.push(normals[i + 1] * (yDif + tick[1] * state.tickAlign) + y1);\n      tickCoords.push(normals[i] * (xDif - tick[0] * (1 - state.tickAlign)) + x1);\n      tickCoords.push(normals[i + 1] * (yDif - tick[1] * (1 - state.tickAlign)) + y1);\n      state.labelCoords.push(normals[i] * xDif + x1);\n      state.labelCoords.push(normals[i + 1] * yDif + y1);\n    }\n    // draw ticks\n    if (ticks.length) {\n      ctx.lineWidth = state.axisWidth / 2;\n      ctx.beginPath();\n      for (let i = 0, j = 0; i < tickCoords.length; i += 4, j += 1) {\n        if (almost(state.lines[j], state.opposite.coordinate.axisOrigin)) continue;\n        const x1 = left + pl + tickCoords[i] * (width - pl - pr);\n        const y1 = top + pt + tickCoords[i + 1] * (height - pt - pb);\n        const x2 = left + pl + tickCoords[i + 2] * (width - pl - pr);\n        const y2 = top + pt + tickCoords[i + 3] * (height - pt - pb);\n        ctx.moveTo(x1, y1);\n        ctx.lineTo(x2, y2);\n      }\n      ctx.strokeStyle = state.axisColor;\n      ctx.stroke();\n      ctx.closePath();\n    }\n    // draw axis\n    if (state.coordinate.axis && state.axisColor) {\n      const axisCoords = state.opposite.coordinate.getCoords(\n        [state.coordinate.axisOrigin],\n        state.opposite\n      );\n      ctx.lineWidth = state.axisWidth / 2;\n      const x1 = left + pl + clamp(axisCoords[0], 0, 1) * (width - pr - pl);\n      const y1 = top + pt + clamp(axisCoords[1], 0, 1) * (height - pt - pb);\n      const x2 = left + pl + clamp(axisCoords[2], 0, 1) * (width - pr - pl);\n      const y2 = top + pt + clamp(axisCoords[3], 0, 1) * (height - pt - pb);\n      ctx.beginPath();\n      ctx.moveTo(x1, y1);\n      ctx.lineTo(x2, y2);\n      ctx.strokeStyle = state.axisColor;\n      ctx.stroke();\n      ctx.closePath();\n    }\n    // draw state.labels\n    this.drawLabels(state);\n  }\n\n  drawLabels(state) {\n    if (state.labels) {\n      const ctx = this.context;\n      const [width, height] = state.shape;\n      const [pt, pr, pb, pl] = state.padding;\n\n      ctx.font = `300 ${state.fontSize}px ${state.fontFamily}`;\n      ctx.fillStyle = state.labelColor;\n      ctx.textBaseline = 'top';\n      const textHeight = state.fontSize;\n      const indent = state.axisWidth + 1.5;\n      const textOffset = state.tickAlign < 0.5\n        ? -textHeight - state.axisWidth * 2 : state.axisWidth * 2;\n      const isOpp = state.coordinate.orientation === 'y' && !state.opposite.disabled;\n      for (let i = 0; i < state.labels.length; i += 1) {\n        let label = state.labels[i];\n        if (label == null) continue;\n\n        if (isOpp && almost(state.lines[i], state.opposite.coordinate.axisOrigin)) continue;\n\n        const textWidth = ctx.measureText(label).width;\n\n        let textLeft = state.labelCoords[i * 2] * (width - pl - pr) + indent + pl;\n\n        if (state.coordinate.orientation === 'y') {\n          textLeft = clamp(textLeft, indent, width - textWidth - 1 - state.axisWidth);\n          label *= -1;\n        }\n\n        let textTop = state.labelCoords[i * 2 + 1] * (height - pt - pb) + textOffset + pt;\n        if (state.coordinate.orientation === 'x') {\n          textTop = clamp(textTop, 0, height - textHeight - textOffset);\n        }\n        ctx.fillText(label, textLeft, textTop);\n      }\n    }\n  }\n}\n\nexport default Grid;\n","import { Modes } from '../core/Constants';\n\nconst ModesMixin = (superclass) => class extends superclass {\n  constructor(options) {\n    super(options);\n    console.log(options);\n  }\n\n  /**\n       * MODES\n       */\n  setMode(mode) {\n    this.mode = mode;\n\n    switch (mode) {\n      case Modes.SELECT:\n        this.canvas.isDrawingMode = false;\n        this.canvas.interactive = true;\n        this.canvas.selection = true;\n        this.canvas.hoverCursor = 'default';\n        this.canvas.moveCursor = 'default';\n        this.canvas.setCursor('default');\n        break;\n      case Modes.GRAB:\n        this.canvas.isDrawingMode = false;\n        this.canvas.interactive = false;\n        this.canvas.selection = false;\n        this.canvas.discardActiveObject();\n        this.canvas.hoverCursor = 'move';\n        this.canvas.moveCursor = 'move';\n        this.canvas.setCursor('move');\n        break;\n      case Modes.DRAW:\n        this.canvas.isDrawingMode = true;\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  setModeAsDraw() {\n    this.setMode(Modes.DRAW);\n    console.log('MODE: DRAW');\n  }\n\n  setModeAsSelect() {\n    this.setMode(Modes.SELECT);\n    console.log('MODE: SELECT');\n  }\n\n  setModeAsGrab() {\n    this.setMode(Modes.GRAB);\n    console.log('MODE: GRAB');\n  }\n\n  isSelectMode() {\n    return this.mode === Modes.SELECT;\n  }\n\n  isGrabMode() {\n    return this.mode === Modes.GRAB;\n  }\n\n  isDrawMode() {\n    return this.mode === Modes.DRAW;\n  }\n};\n\nexport default ModesMixin;\n","'use strict';\n\n// used by apply() and isApplicationOf()\nconst _appliedMixin = '__mixwith_appliedMixin';\n\n/**\n * A function that returns a subclass of its argument.\n *\n * @example\n * const M = (superclass) => class extends superclass {\n *   getMessage() {\n *     return \"Hello\";\n *   }\n * }\n *\n * @typedef {Function} MixinFunction\n * @param {Function} superclass\n * @return {Function} A subclass of `superclass`\n */\n\n/**\n * Applies `mixin` to `superclass`.\n *\n * `apply` stores a reference from the mixin application to the unwrapped mixin\n * to make `isApplicationOf` and `hasMixin` work.\n *\n * This function is usefull for mixin wrappers that want to automatically enable\n * {@link hasMixin} support.\n *\n * @example\n * const Applier = (mixin) => wrap(mixin, (superclass) => apply(superclass, mixin));\n *\n * // M now works with `hasMixin` and `isApplicationOf`\n * const M = Applier((superclass) => class extends superclass {});\n *\n * class C extends M(Object) {}\n * let i = new C();\n * hasMixin(i, M); // true\n *\n * @function\n * @param {Function} superclass A class or constructor function\n * @param {MixinFunction} mixin The mixin to apply\n * @return {Function} A subclass of `superclass` produced by `mixin`\n */\nexport const apply = (superclass, mixin) => {\n  let application = mixin(superclass);\n  application.prototype[_appliedMixin] = unwrap(mixin);\n  return application;\n};\n\n/**\n * Returns `true` iff `proto` is a prototype created by the application of\n * `mixin` to a superclass.\n *\n * `isApplicationOf` works by checking that `proto` has a reference to `mixin`\n * as created by `apply`.\n *\n * @function\n * @param {Object} proto A prototype object created by {@link apply}.\n * @param {MixinFunction} mixin A mixin function used with {@link apply}.\n * @return {boolean} whether `proto` is a prototype created by the application of\n * `mixin` to a superclass\n */\nexport const isApplicationOf = (proto, mixin) =>\n  proto.hasOwnProperty(_appliedMixin) && proto[_appliedMixin] === unwrap(mixin);\n\n/**\n * Returns `true` iff `o` has an application of `mixin` on its prototype\n * chain.\n *\n * @function\n * @param {Object} o An object\n * @param {MixinFunction} mixin A mixin applied with {@link apply}\n * @return {boolean} whether `o` has an application of `mixin` on its prototype\n * chain\n */\nexport const hasMixin = (o, mixin) => {\n  while (o != null) {\n    if (isApplicationOf(o, mixin)) return true;\n    o = Object.getPrototypeOf(o);\n  }\n  return false;\n}\n\n\n// used by wrap() and unwrap()\nconst _wrappedMixin = '__mixwith_wrappedMixin';\n\n/**\n * Sets up the function `mixin` to be wrapped by the function `wrapper`, while\n * allowing properties on `mixin` to be available via `wrapper`, and allowing\n * `wrapper` to be unwrapped to get to the original function.\n *\n * `wrap` does two things:\n *   1. Sets the prototype of `mixin` to `wrapper` so that properties set on\n *      `mixin` inherited by `wrapper`.\n *   2. Sets a special property on `mixin` that points back to `mixin` so that\n *      it can be retreived from `wrapper`\n *\n * @function\n * @param {MixinFunction} mixin A mixin function\n * @param {MixinFunction} wrapper A function that wraps {@link mixin}\n * @return {MixinFunction} `wrapper`\n */\nexport const wrap = (mixin, wrapper) => {\n  Object.setPrototypeOf(wrapper, mixin);\n  if (!mixin[_wrappedMixin]) {\n    mixin[_wrappedMixin] = mixin;\n  }\n  return wrapper;\n};\n\n/**\n * Unwraps the function `wrapper` to return the original function wrapped by\n * one or more calls to `wrap`. Returns `wrapper` if it's not a wrapped\n * function.\n *\n * @function\n * @param {MixinFunction} wrapper A wrapped mixin produced by {@link wrap}\n * @return {MixinFunction} The originally wrapped mixin\n */\nexport const unwrap = (wrapper) => wrapper[_wrappedMixin] || wrapper;\n\nconst _cachedApplications = '__mixwith_cachedApplications';\n\n/**\n * Decorates `mixin` so that it caches its applications. When applied multiple\n * times to the same superclass, `mixin` will only create one subclass, memoize\n * it and return it for each application.\n *\n * Note: If `mixin` somehow stores properties its classes constructor (static\n * properties), or on its classes prototype, it will be shared across all\n * applications of `mixin` to a super class. It's reccomended that `mixin` only\n * access instance state.\n *\n * @function\n * @param {MixinFunction} mixin The mixin to wrap with caching behavior\n * @return {MixinFunction} a new mixin function\n */\nexport const Cached = (mixin) => wrap(mixin, (superclass) => {\n  // Get or create a symbol used to look up a previous application of mixin\n  // to the class. This symbol is unique per mixin definition, so a class will have N\n  // applicationRefs if it has had N mixins applied to it. A mixin will have\n  // exactly one _cachedApplicationRef used to store its applications.\n\n  let cachedApplications = superclass[_cachedApplications];\n  if (!cachedApplications) {\n    cachedApplications = superclass[_cachedApplications] = new Map();\n  }\n\n  let application = cachedApplications.get(mixin);\n  if (!application) {\n    application = mixin(superclass);\n    cachedApplications.set(mixin, application);\n  }\n\n  return application;\n});\n\n/**\n * Decorates `mixin` so that it only applies if it's not already on the\n * prototype chain.\n *\n * @function\n * @param {MixinFunction} mixin The mixin to wrap with deduplication behavior\n * @return {MixinFunction} a new mixin function\n */\nexport const DeDupe = (mixin) => wrap(mixin, (superclass) =>\n    (hasMixin(superclass.prototype, mixin))\n      ? superclass\n      : mixin(superclass));\n\n/**\n * Adds [Symbol.hasInstance] (ES2015 custom instanceof support) to `mixin`.\n *\n * @function\n * @param {MixinFunction} mixin The mixin to add [Symbol.hasInstance] to\n * @return {MixinFunction} the given mixin function\n */\nexport const HasInstance = (mixin) => {\n  if (Symbol && Symbol.hasInstance && !mixin[Symbol.hasInstance]) {\n    Object.defineProperty(mixin, Symbol.hasInstance, {\n      value(o) {\n        return hasMixin(o, mixin);\n      },\n    });\n  }\n  return mixin;\n};\n\n/**\n * A basic mixin decorator that applies the mixin with {@link apply} so that it\n * can be used with {@link isApplicationOf}, {@link hasMixin} and the other\n * mixin decorator functions.\n *\n * @function\n * @param {MixinFunction} mixin The mixin to wrap\n * @return {MixinFunction} a new mixin function\n */\nexport const BareMixin = (mixin) => wrap(mixin, (s) => apply(s, mixin));\n\n/**\n * Decorates a mixin function to add deduplication, application caching and\n * instanceof support.\n *\n * @function\n * @param {MixinFunction} mixin The mixin to wrap\n * @return {MixinFunction} a new mixin function\n */\nexport const Mixin = (mixin) => DeDupe(Cached(BareMixin(mixin)));\n\n/**\n * A fluent interface to apply a list of mixins to a superclass.\n *\n * ```javascript\n * class X extends mix(Object).with(A, B, C) {}\n * ```\n *\n * The mixins are applied in order to the superclass, so the prototype chain\n * will be: X->C'->B'->A'->Object.\n *\n * This is purely a convenience function. The above example is equivalent to:\n *\n * ```javascript\n * class X extends C(B(A(Object))) {}\n * ```\n *\n * @function\n * @param {Function} [superclass=Object]\n * @return {MixinBuilder}\n */\nexport const mix = (superclass) => new MixinBuilder(superclass);\n\nclass MixinBuilder {\n\n  constructor(superclass) {\n    this.superclass = superclass || class {};\n  }\n\n  /**\n   * Applies `mixins` in order to the superclass given to `mix()`.\n   *\n   * @param {Array.<Mixin>} mixins\n   * @return {Function} a subclass of `superclass` with `mixins` applied\n   */\n  with(...mixins) {\n    return mixins.reduce((c, m) => m(c), this.superclass);\n  }\n}","import panzoom from '../lib/panzoom';\nimport { clamp } from '../lib/mumath/index';\n\nimport Base from '../core/Base';\nimport { MAP, Modes } from '../core/Constants';\nimport Grid from '../grid/Grid';\nimport { Point } from '../geometry/Point';\nimport ModesMixin from './ModesMixin';\nimport { mix } from '../lib/mix';\n\nexport class Map extends mix(Base).with(ModesMixin) {\n  constructor(container, options) {\n    super(options);\n\n    console.log(this);\n    this.defaults = Object.assign({}, MAP);\n\n    // set defaults\n    Object.assign(this, this.defaults);\n\n    // overwrite options\n    Object.assign(this, this._options);\n\n    this.center = new Point(this.center);\n\n    this.container = container || document.body;\n\n    const canvas = document.createElement('canvas');\n    this.container.appendChild(canvas);\n    canvas.setAttribute('id', 'indoors-map-canvas');\n\n    canvas.width = this.width || this.container.clientWidth;\n    canvas.height = this.height || this.container.clientHeight;\n\n    this.canvas = new fabric.Canvas(canvas, {\n      preserveObjectStacking: true\n    });\n    this.context = this.canvas.getContext('2d');\n\n    this.on('render', () => {\n      if (this.autostart) this.clear();\n    });\n\n    this.originX = -this.canvas.width / 2 + this._options.center.x;\n    this.originY = -this.canvas.height / 2 + this._options.center.y;\n\n    this.canvas.absolutePan({\n      x: this.originX,\n      y: this.originY\n    });\n\n    try {\n      this.addFloorPlan();\n    } catch (e) {\n      console.error(e);\n    }\n    this.addGrid();\n\n    this.setMode(this.mode || Modes.GRAB);\n\n    const vm = this;\n    panzoom(this.container, e => {\n      vm.panzoom(e);\n    });\n\n    this.registerListeners();\n\n    setTimeout(() => {\n      this.emit('ready', this);\n    }, 300);\n  }\n\n  addFloorPlan() {\n    if (!this.floorplan) return;\n    const vm = this;\n    this.floorplan.on('load', img => {\n      vm.addLayer(img);\n    });\n  }\n\n  addLayer(layer) {\n    this.canvas.add(layer.shape);\n    this.canvas._objects.sort((o1, o2) => o1.zIndex - o2.zIndex);\n\n    if (layer.shape.keepOnZoom) {\n      layer.shape._set('scaleX', 1 / this.zoom);\n      layer.shape._set('scaleY', 1 / this.zoom);\n      this.emit(`${layer.class}scaling`, layer);\n    }\n    // this.update();\n    // this.canvas.renderAll();\n  }\n\n  removeLayer(layer) {\n    this.canvas.remove(layer.shape);\n  }\n\n  addGrid() {\n    this.gridCanvas = this.cloneCanvas();\n    this.gridCanvas.setAttribute('id', 'indoors-grid-canvas');\n    this.grid = new Grid(this.gridCanvas, this);\n    this.grid.draw();\n  }\n\n  moveTo(obj, index) {\n    if (index !== undefined) {\n      obj.zIndex = index;\n    }\n    this.canvas.moveTo(obj.shape, obj.zIndex);\n  }\n\n  cloneCanvas(canvas) {\n    canvas = canvas || this.canvas;\n    const clone = document.createElement('canvas');\n    clone.width = canvas.width;\n    clone.height = canvas.height;\n    canvas.wrapperEl.appendChild(clone);\n    return clone;\n  }\n\n  update() {\n    const canvas = this.canvas;\n\n    this.grid.update2({\n      x: this.center.x,\n      y: this.center.y,\n      zoom: this.zoom\n    });\n\n    this.emit('update', this);\n    this.grid.render();\n\n    if (this.isGrabMode()) {\n      canvas.relativePan(new Point(this.dx, this.dy));\n      this.emit('panning');\n    }\n\n    canvas.zoomToPoint(new Point(this.x, this.y), this.zoom);\n\n    const objects = canvas.getObjects();\n    for (let i = 0; i < objects.length; i += 1) {\n      const object = objects[i];\n      if (object.keepOnZoom) {\n        object._set('scaleX', 1 / this.zoom);\n        object._set('scaleY', 1 / this.zoom);\n        this.emit(`${object.class}scaling`, object);\n      }\n    }\n  }\n\n  panzoom(e) {\n    // enable interactions\n    const { width, height } = this.canvas;\n    // shift start\n    const zoom = clamp(-e.dz, -height * 0.75, height * 0.75) / height;\n\n    const prevZoom = 1 / this.zoom;\n    let curZoom = prevZoom * (1 - zoom);\n    curZoom = clamp(curZoom, this.minZoom, this.maxZoom);\n\n    let { x, y } = this.center;\n\n    // pan\n    const oX = 0.5;\n    const oY = 0.5;\n    if (this.isGrabMode()) {\n      x -= prevZoom * e.dx;\n      y += prevZoom * e.dy;\n    }\n\n    if (this.zoomEnabled) {\n      const tx = e.x / width - oX;\n      x -= width * (curZoom - prevZoom) * tx;\n      const ty = oY - e.y / height;\n      y -= height * (curZoom - prevZoom) * ty;\n    }\n    this.center.setX(x);\n    this.center.setY(y);\n    this.zoom = 1 / curZoom;\n    this.dx = e.dx;\n    this.dy = e.dy;\n    this.x = e.x0;\n    this.y = e.y0;\n    this.update();\n  }\n\n  registerListeners() {\n    const vm = this;\n\n    this.canvas.on('object:scaling', e => {\n      if (e.target.class) {\n        vm.emit(`${e.target.class}:scaling`, e.target.parent);\n        return;\n      }\n      const group = e.target;\n      if (!group.getObjects) return;\n\n      const objects = group.getObjects();\n      group.removeWithUpdate();\n      for (let i = 0; i < objects.length; i += 1) {\n        const object = objects[i];\n        object.fire('moving');\n        vm.emit(`${object.class}:moving`, object.parent);\n      }\n      vm.update();\n      vm.canvas.renderAll();\n    });\n\n    this.canvas.on('object:rotating', e => {\n      if (e.target.class) {\n        vm.emit(`${e.target.class}:rotating`, e.target.parent);\n        return;\n      }\n      const group = e.target;\n      if (!group.getObjects) return;\n      const objects = group.getObjects();\n      for (let i = 0; i < objects.length; i += 1) {\n        const object = objects[i];\n        if (object.class) {\n          object._set('angle', -group.angle);\n          object.fire('moving');\n          vm.emit(`${object.class}:moving`, object.parent);\n        }\n      }\n      this.update();\n    });\n\n    this.canvas.on('object:moving', e => {\n      if (e.target.class) {\n        vm.emit(`${e.target.class}:moving`, e.target.parent);\n        return;\n      }\n      const group = e.target;\n      if (!group.getObjects) return;\n      const objects = group.getObjects();\n      for (let i = 0; i < objects.length; i += 1) {\n        const object = objects[i];\n        if (object.class) {\n          object.fire('moving');\n          vm.emit(`${object.class}:moving`, object.parent);\n        }\n      }\n      this.update();\n    });\n\n    this.canvas.on('object:moved', e => {\n      if (e.target.class) {\n        vm.emit(`${e.target.class}dragend`, e);\n      }\n      this.update();\n    });\n\n    this.canvas.on('selection:cleared', e => {\n      const objects = e.deselected;\n      for (let i = 0; i < objects.length; i += 1) {\n        const object = objects[i];\n        if (object.class) {\n          object._set('angle', 0);\n          object._set('scaleX', 1 / vm.zoom);\n          object._set('scaleY', 1 / vm.zoom);\n          object.fire('moving');\n        }\n      }\n    });\n\n    this.canvas.on('mouse:down', e => {\n      vm.dragObject = e.target;\n    });\n\n    this.canvas.on('mouse:move', e => {\n      if (vm.dragObject && vm.dragObject.clickable) {\n        if (vm.dragObject === e.target) {\n          vm.dragObject.dragging = true;\n        } else {\n          vm.dragObject.dragging = false;\n        }\n      }\n    });\n\n    this.canvas.on('mouse:up', e => {\n      if (vm.dragObject && vm.dragObject.clickable) {\n        if (vm.dragObject !== e.target) return;\n        if (!vm.dragObject.dragging && !vm.modeToggleByKey) {\n          console.log('click');\n          vm.emit(`${vm.dragObject.class}:click`, vm.dragObject.parent);\n        }\n        vm.dragObject.dragging = false;\n      }\n      vm.dragObject = null;\n    });\n\n    document.addEventListener('keyup', () => {\n      if (this.modeToggleByKey && this.isGrabMode()) {\n        this.setModeAsSelect();\n        this.modeToggleByKey = false;\n      }\n    });\n\n    document.addEventListener('keydown', event => {\n      if (event.ctrlKey || event.metaKey) {\n        if (this.isSelectMode()) {\n          this.setModeAsGrab();\n        }\n        this.modeToggleByKey = true;\n      }\n    });\n  }\n\n  unregisterListeners() {\n    this.canvas.off('object:moving');\n    this.canvas.off('object:moved');\n  }\n}\n\nexport const map = (container, options) => new Map(container, options);\n","export class Group extends fabric.Group {\n  constructor(objects, options) {\n    options = options || {};\n    super(objects, options);\n  }\n}\n\nexport const group = (objects, options) => new Group(objects, options);\n\nexport default Group;\n","import Base from '../core/Base';\n\nexport class Layer extends Base {\n  constructor(options) {\n    super(options);\n    this.label = this.label !== undefined ? this.label : null;\n    this.draggable = this.draggable || false;\n    this.zIndex = this.zIndex || 1;\n    this.opacity = this.opacity || 1;\n    this.keepOnZoom = this.keepOnZoom || false;\n    this.clickable = this.clickable || false;\n\n    this.hoverCursor = this.hoverCursor || this.clickable ? 'pointer' : 'default';\n    this.moveCursor = this.moveCursor || 'move';\n\n    this.class = this.class || this.constructor.name.toLowerCase();\n\n    this.style = {\n      zIndex: this.zIndex,\n      class: this.class,\n      parent: this,\n      keepOnZoom: this.keepOnZoom,\n      id: this.id,\n      hasControls: false,\n      hasBorders: false,\n      lockMovementX: !this.draggable,\n      lockMovementY: !this.draggable,\n      draggable: this.draggable,\n      clickable: this.clickable,\n      selectable: this.draggable,\n      hoverCursor: this.hoverCursor,\n      moveCursor: this.moveCursor\n    };\n  }\n\n  addTo(map) {\n    if (!map) {\n      if (this._map) {\n        this._map.removeLayer(this);\n      }\n      return;\n    }\n    this._map = map;\n    this._map.addLayer(this);\n  }\n}\n\nexport const layer = (options) => new Layer(options);\n\nexport default Layer;\n","import { Point } from '../geometry/Point';\nimport { Group } from '../layer/Group';\nimport { Layer } from '../layer/Layer';\n\nexport class Floorplan extends Layer {\n  constructor(options) {\n    super(options);\n\n    this.width = this.width || 'auto';\n    this.height = this.height || 'auto';\n\n    this.position = new Point(this.position);\n\n    this.class = 'floorplan';\n\n    const vm = this;\n    fabric.Image.fromURL(\n      this.url,\n      image => {\n        console.log(image);\n        const ratio = image.width / image.height;\n        if (vm.width === 'auto' && vm.height === 'auto') {\n          vm.width = image.width;\n          vm.height = image.height;\n        } else if (vm.width === 'auto') {\n          vm.width = vm.height / ratio;\n        } else if (vm.height === 'auto') {\n          vm.height = vm.width * ratio;\n        }\n        image.originalWidth = image.width;\n        image.originalHeight = image.height;\n        vm.image = image.scaleToWidth(vm.width);\n\n        vm.scaleX = image.scaleX + 0;\n        vm.scaleY = image.scaleY + 0;\n        // vm.emit('load', vm);\n\n        vm.shape = new Group([vm.image, vm.handler], {\n          selectable: false,\n          draggable: false,\n          left: vm.position.x,\n          top: vm.position.y,\n          parent: vm,\n          lockMovementX: true,\n          lockMovementY: true,\n          class: vm.class,\n          zIndex: vm.zIndex\n        });\n\n        vm.emit('load', vm);\n      },\n      {\n        selectable: false,\n        opacity: this.opacity\n      }\n    );\n\n    this.handler = new fabric.Rect({\n      left: 0,\n      top: 0,\n      width: 20,\n      height: 20,\n      stroke: 'green',\n      fill: '',\n      hasControls: false,\n      hasBorders: false\n    });\n  }\n}\n\nexport const floorplan = (options) => new Floorplan(options);\n","export class Line extends fabric.Line {\n  constructor(points, options) {\n    options = options || {};\n    options.strokeWidth = options.strokeWidth || 1;\n    super(points, options);\n    this._strokeWidth = options.strokeWidth;\n  }\n\n  _renderStroke(ctx) {\n    this.strokeWidth = this._strokeWidth / this.canvas.getZoom();\n    super._renderStroke(ctx);\n  }\n}\n\nexport const line = (points, options) => new Line(points, options);\n\nexport default Line;\n","import { Layer } from './Layer';\nimport { Line } from './vector/Line';\n\nexport class Connector extends Layer {\n  constructor(start, end, options) {\n    options = options || {};\n    options.zIndex = options.zIndex || 9;\n    super(options);\n\n    if (!start || !end) {\n      console.error('start or end is missing');\n      return;\n    }\n    this.start = start;\n    this.end = end;\n    this.strokeWidth = this.strokeWidth || 1;\n\n    Object.assign(this.style, {\n      strokeWidth: this.strokeWidth,\n      stroke: this.color || 'grey',\n      fill: this.fill || false,\n      selectable: false\n    });\n\n    this.draw();\n\n    this.registerListeners();\n  }\n\n  registerListeners() {\n    const vm = this;\n    this.start.on('update:links', () => {\n      vm.shape.set({\n        x1: vm.start.position.x,\n        y1: vm.start.position.y\n      });\n    });\n\n    this.end.on('update:links', () => {\n      vm.shape.set({\n        x2: vm.end.position.x,\n        y2: vm.end.position.y\n      });\n    });\n  }\n\n  draw() {\n    this.shape = new Line([\n      this.start.position.x,\n      this.start.position.y,\n      this.end.position.x,\n      this.end.position.y\n    ], this.style);\n    // this.shape.setCoords();\n  }\n\n  redraw() {\n    this.shape.set({\n      x1: this.start.position.x,\n      y1: this.start.position.y,\n      x2: this.end.position.x,\n      y2: this.end.position.y\n    });\n  }\n}\n\nexport const connector = (start, end, options) => new Connector(start, end, options);\n\nexport default Connector;\n","export default (typeof global !== \"undefined\" ? global :\n            typeof self !== \"undefined\" ? self :\n            typeof window !== \"undefined\" ? window : {});\n","// shim for using process in browser\n// based off https://github.com/defunctzombie/node-process/blob/master/browser.js\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\nvar cachedSetTimeout = defaultSetTimout;\nvar cachedClearTimeout = defaultClearTimeout;\nif (typeof global.setTimeout === 'function') {\n    cachedSetTimeout = setTimeout;\n}\nif (typeof global.clearTimeout === 'function') {\n    cachedClearTimeout = clearTimeout;\n}\n\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\nexport function nextTick(fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n}\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nexport var title = 'browser';\nexport var platform = 'browser';\nexport var browser = true;\nexport var env = {};\nexport var argv = [];\nexport var version = ''; // empty string to avoid regexp issues\nexport var versions = {};\nexport var release = {};\nexport var config = {};\n\nfunction noop() {}\n\nexport var on = noop;\nexport var addListener = noop;\nexport var once = noop;\nexport var off = noop;\nexport var removeListener = noop;\nexport var removeAllListeners = noop;\nexport var emit = noop;\n\nexport function binding(name) {\n    throw new Error('process.binding is not supported');\n}\n\nexport function cwd () { return '/' }\nexport function chdir (dir) {\n    throw new Error('process.chdir is not supported');\n};\nexport function umask() { return 0; }\n\n// from https://github.com/kumavis/browser-process-hrtime/blob/master/index.js\nvar performance = global.performance || {}\nvar performanceNow =\n  performance.now        ||\n  performance.mozNow     ||\n  performance.msNow      ||\n  performance.oNow       ||\n  performance.webkitNow  ||\n  function(){ return (new Date()).getTime() }\n\n// generate timestamp or delta\n// see http://nodejs.org/api/process.html#process_process_hrtime\nexport function hrtime(previousTimestamp){\n  var clocktime = performanceNow.call(performance)*1e-3\n  var seconds = Math.floor(clocktime)\n  var nanoseconds = Math.floor((clocktime%1)*1e9)\n  if (previousTimestamp) {\n    seconds = seconds - previousTimestamp[0]\n    nanoseconds = nanoseconds - previousTimestamp[1]\n    if (nanoseconds<0) {\n      seconds--\n      nanoseconds += 1e9\n    }\n  }\n  return [seconds,nanoseconds]\n}\n\nvar startTime = new Date();\nexport function uptime() {\n  var currentTime = new Date();\n  var dif = currentTime - startTime;\n  return dif / 1000;\n}\n\nexport default {\n  nextTick: nextTick,\n  title: title,\n  browser: browser,\n  env: env,\n  argv: argv,\n  version: version,\n  versions: versions,\n  on: on,\n  addListener: addListener,\n  once: once,\n  off: off,\n  removeListener: removeListener,\n  removeAllListeners: removeAllListeners,\n  emit: emit,\n  binding: binding,\n  cwd: cwd,\n  chdir: chdir,\n  umask: umask,\n  hrtime: hrtime,\n  platform: platform,\n  release: release,\n  config: config,\n  uptime: uptime\n};\n","import { Layer } from '../Layer';\nimport { Group } from '../Group';\nimport { Point } from '../../geometry/Point';\nimport { Connector } from '../Connector';\n\nexport class Marker extends Layer {\n  constructor(position, options) {\n    options = options || {};\n    options.zIndex = options.zIndex || 10;\n    options.keepOnZoom = true;\n    options.position = new Point(position);\n    options.rotation = options.rotation || 0;\n    options.clickable = options.clickable || true;\n    super(options);\n\n    const vm = this;\n\n    this.text = this.text || '';\n    this.size = this.size || 10;\n\n    Object.assign(this.style, {\n      left: this.position.x,\n      top: this.position.y,\n      selectionBackgroundColor: false,\n      angle: this.rotation\n    });\n\n    if (this.text) {\n      this.textObj = new fabric.Text(this.text, {\n        fontSize: this.size\n      });\n    }\n\n    if (this.icon) {\n      fabric.Image.fromURL(this.icon.url, image => {\n        console.log(image);\n        vm.image = image.scaleToWidth(100);\n        this.init();\n        // vm.shape.removeWithUpdate();\n      }, {\n        selectable: true,\n        opacity: this.opacity\n      });\n    } else {\n      this.circle = new fabric.Circle({\n        radius: this.size,\n        strokeWidth: 2,\n        stroke: 'red',\n        fill: 'white'\n      });\n      this.init();\n    }\n  }\n\n  init() {\n    const objects = [];\n    if (this.image) {\n      objects.push(this.image);\n    }\n    if (this.circle) {\n      objects.push(this.circle);\n    }\n    if (this.textObj) {\n      objects.push(this.textObj);\n    }\n    this.shape = new Group(objects, this.style);\n    this.links = this.links || [];\n    this.addLinks();\n    this.registerListeners();\n\n    process.nextTick(() => {\n      this.emit('ready');\n    });\n  }\n\n  registerListeners() {\n    const vm = this;\n    this.shape.on('moving', () => {\n      vm.onShapeDrag();\n    });\n\n    this.shape.on('mousedown', (e) => {\n      vm.onShapeMouseDown(e);\n    });\n    this.shape.on('mousemove', (e) => {\n      vm.onShapeMouseMove(e);\n    });\n    this.shape.on('mouseup', (e) => {\n      vm.onShapeMouseUp(e);\n    });\n  }\n\n  setPosition(position) {\n    this.position = new Point(position);\n    this.shape.set({\n      left: this.position.x,\n      top: this.position.y\n    });\n    this.emit('update:links');\n    try {\n      this.shape.canvas.renderAll();\n    } catch (e) {\n      console.error(e);\n    }\n  }\n\n  setRotation(rotation) {\n    this.rotation = rotation;\n    this.shape.set({\n      angle: this.rotation\n    });\n    try {\n      this.shape.canvas.renderAll();\n    } catch (e) {\n      console.error(e);\n    }\n  }\n\n  setLinks(links) {\n    this.links = links;\n    this.addLinks();\n  }\n\n  addLinks() {\n    this.connectors = [];\n    this.links.forEach(link => {\n      const connector = new Connector(this, link);\n      this.connectors.push(connector);\n    });\n\n    this.addConnectors();\n  }\n\n  addConnectors() {\n    const vm = this;\n    this.connectors.forEach(connector => {\n      vm._map.addLayer(connector);\n    });\n  }\n\n  onAdded() {\n    this.addConnectors();\n  }\n\n  onShapeDrag() {\n    const matrix = this.shape.calcTransformMatrix();\n    const [,,,, x, y] = matrix;\n    this.position = new Point(x, y);\n    this.emit('update:links');\n  }\n\n  onShapeMouseDown(e) {\n    console.log(e);\n    this.dragStart = e;\n  }\n\n  onShapeMouseMove(e) {\n    if (this.dragStart) {\n      this.emit('dragstart', this.dragStart);\n      this.dragging = true;\n      this.dragStart = null;\n    }\n\n    if (this.dragging) {\n      this.emit('drag', e);\n    } else {\n      this.emit('hover', e);\n    }\n  }\n\n  onShapeMouseUp(e) {\n    if (!this.dragging) {\n      this.emit('click', e);\n    } else {\n      this.emit('dragend', e);\n    }\n    this.dragStart = null;\n    this.dragging = false;\n  }\n}\n\nexport const marker = (position, options) => new Marker(position, options);\n","import { ICON } from '../../core/Constants';\n\nexport class Icon extends fabric.Image {\n  constructor(options) {\n    super(options);\n    this.defaults = Object.assign({}, ICON);\n    Object.assign({}, this.defaults);\n    Object.assign({}, this._options);\n  }\n}\nexport const icon = (options) => new Icon(options);\n","import { Group } from '../Group';\n\nexport class MarkerGroup extends Group {\n  constructor(options) {\n    options = options || {};\n    super(options);\n  }\n}\nexport const markerGroup = (options) => new MarkerGroup(options);\n","import { Layer } from '../Layer';\nimport { Point } from '../../geometry/Point';\n\nexport class Polyline extends Layer {\n  constructor(_points, options) {\n    options = options || {};\n    options.points = _points || [];\n    super(options);\n    this.lines = [];\n    this.class = 'polyline';\n    this.strokeWidth = 1;\n\n    this.lineOptions = {\n      strokeWidth: this.strokeWidth,\n      stroke: this.color || 'grey',\n      fill: this.fill || false\n    };\n\n    this.shape = new fabric.Group([], {\n      selectable: false,\n      hasControls: false,\n      class: this.class,\n      parent: this\n    });\n\n    this.setPoints(this._points);\n  }\n\n  addPoint(point) {\n    this.points.push(new Point(point));\n\n    if (this.points.length > 1) {\n      const i = this.points.length - 1;\n      const j = this.points.length - 2;\n      const p1 = this.points[i];\n      const p2 = this.points[j];\n      const line = new fabric.Line(p1.getArray().concat(p2.getArray()), this.lineOptions);\n      this.lines.push(line);\n      this.shape.addWithUpdate(line);\n    }\n  }\n\n  setStrokeWidth(strokeWidth) {\n    this.lines.forEach(line => {\n      line.setStrokeWidth(strokeWidth);\n    });\n  }\n\n  setPoints(points = []) {\n    this.removeLines();\n    this.points = [];\n    for (let i = 0; i < points.length; i += 1) {\n      const point = new Point(points[i]);\n      this.points.push(point);\n      this.addPoint();\n    }\n  }\n\n  removeLines() {\n    for (let i = 0; i < this.lines.length; i += 1) {\n      this.shape.remove(this.lines[i]);\n    }\n    this.lines = [];\n  }\n}\n\nexport const polyline = (points, options) => new Polyline(points, options);\n","export class Circle extends fabric.Circle {\n  constructor(options) {\n    super(options);\n    console.log('circle');\n  }\n}\n\nexport const circle = (options) => new Circle(options);\n","import fabric from 'fabric';\n\nimport { version } from '../package.json';\n\nconsole.log('fabricJS ', fabric.version);\n\nexport { version };\n\n// geometry\nexport * from './geometry/index';\n\n// map\nexport * from './map/index';\n\n// floorplan\nexport * from './floorplan/index';\n\n// layer\nexport * from './layer/index';\n"],"names":["Point","x","y","params","length","Object","prototype","hasOwnProperty","call","console","error","fabric","point","isNum","val","isNaN","ev","toElement","currentTarget","toElementBoundingRect","getBoundingClientRect","orgEv","originalEvent","hasTouches","touches","pageX","pageY","clientX","clientY","currentPoint","left","top","stopThresholdDefault","bounceDeceleration","bounceAcceleration","window","addEventListener","Impetus","source","sourceEl","document","updateCallback","update","multiplier","friction","initialValues","boundX","boundY","bounce","boundXmin","boundXmax","boundYmin","boundYmax","pointerLastX","pointerLastY","pointerCurrentX","pointerCurrentY","pointerId","decVelX","decVelY","targetX","targetY","stopThreshold","ticking","pointerActive","paused","decelerating","trackingPoints","init","querySelector","Error","callUpdateCallback","onDown","destroy","removeEventListener","cleanUpRuntimeEvents","pause","resume","setValues","setMultiplier","setBoundX","setBoundY","onMove","getPassiveSupported","passive","onUp","stopTracking","addRuntimeEvents","normalizeEvent","type","touch","targetTouches","changedTouches","id","identifier","event","addTrackingPoint","preventDefault","requestTick","startDecelAnim","time","Date","now","shift","push","updateAndRender","pointerChangeX","pointerChangeY","diff","checkBounds","dragOutOfBoundsMultiplier","Math","pow","requestAnimFrame","restrict","xDiff","yDiff","undefined","inBounds","firstPoint","lastPoint","xOffset","yOffset","timeOffset","D","abs","stepDecelAnim","reboundAdjust","adjust","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","callback","setTimeout","passiveSupported","options","defineProperty","get","err","str","out","String","num","parseFloat","match","PIXELS_PER_INCH","defaults","toPX","parts","parseUnit","px","mouseWheelListen","element","noScroll","lineHeight","listener","dx","deltaX","dy","deltaY","dz","deltaZ","mode","deltaMode","scale","innerHeight","rootPosition","mouseEventOffset","target","srcElement","Array","isArray","cx","cy","rect","getBoundingClientOffset","body","distance","a","b","sqrt","touchPinch","emitter","EventEmitter","fingers","activeCount","lastDistance","ended","enabled","defineProperties","pinching","enable","disable","indexOfTouch","i","onTouchStart","onTouchMove","onTouchRemoved","newTouch","idx","first","newIndex","oldIndex","newFinger","Finger","eventOffset","position","oldTouch","emit","initialDistance","computeDistance","changed","movedTouch","currentDistance","removed","otherIdx","otherTouch","getPrefixed","name","lastTime","timeoutDefer","fn","timeToCall","max","bind","obj","slice","apply","arguments","args","concat","requestFn","cancelFn","cancelAnimationFrame","clearTimeout","raf","context","immediate","cancel","log","panzoom","cb","Function","documentElement","cursor","hasPassive","supported","opts","e","impetus","initX","initY","initFn","evPos","lastY","lastX","x0","y0","schedule","wheelListener","wheel","pinch","mult","initialCoords","on","curr","f1","f2","prev","planned","frameId","arg","unpanzoom","clamp","min","len","almostEqual","absoluteError","relativeError","d","DBL_EPSILON","FLT_EPSILON","range","start","stop","step","toReturn","increasing","log10","isMultiple","eps","remainder","almost","minStep","srcSteps","power","floor","lg","order","steps","map","v","value","toString","getPrototypeOf","Base","_options","assign","Emitter","Modes","SELECT","GRAB","DRAW","MAP","center","zoom","minZoom","maxZoom","gridEnabled","zoomEnabled","selectEnabled","MARKER","ICON","url","size","anchor","originX","originY","lockUniScaling","lockScalingFlip","transparentCorners","centeredScaling","cornerStyle","cornerColor","borderColor","borderOpacity","cornerOpacity","cornerStrokeColor","objectCaching","Group","selectionBackgroundColor","borderDashArray","padding","alpha","color","replace","split","join","gridStyle","unit","lines","state","coord","coordinate","offset","ceil","lineColor","light","heavy","tenStep","nextStep","colors","ticks","tickWidth","axisWidth","labels","orientation","Number","toFixed","format","Axis","values","coords","t","getRatio","width","height","getRange","Grid","canvas","getContext","setDefaults","draw","shape","pt","pr","pb","pl","axisCoords","opposite","getCoords","axisOrigin","calcCoordinate","axisX","axisY","grid","MAX_VALUE","axisColor","lineWidth","tickAlign","labelColor","fill","fontSize","units","toPx","fontFamily","lineColors","tick","isObj","keys","forEach","label","pixelRatio","devicePixelRatio","autostart","interactions","Infinity","origin","panEnabled","style","axis","clearRect","drawLines","ctx","axisRatio","j","strokeStyle","beginPath","x1","y1","x2","y2","moveTo","lineTo","stroke","closePath","normals","xDif","yDif","dist","tickCoords","labelCoords","k","drawLabels","font","fillStyle","textBaseline","textHeight","indent","textOffset","isOpp","disabled","textWidth","measureText","textLeft","textTop","fillText","ModesMixin","superclass","isDrawingMode","interactive","selection","hoverCursor","moveCursor","setCursor","discardActiveObject","setMode","mix","MixinBuilder","mixins","reduce","c","m","Map","container","createElement","appendChild","setAttribute","clientWidth","clientHeight","Canvas","preserveObjectStacking","clear","absolutePan","addFloorPlan","addGrid","vm","registerListeners","floorplan","img","addLayer","layer","add","_objects","sort","o1","o2","zIndex","keepOnZoom","_set","remove","gridCanvas","cloneCanvas","index","clone","wrapperEl","update2","render","isGrabMode","relativePan","zoomToPoint","objects","getObjects","object","prevZoom","curZoom","oX","oY","tx","ty","setX","setY","parent","group","removeWithUpdate","fire","renderAll","angle","deselected","dragObject","clickable","dragging","modeToggleByKey","setModeAsSelect","ctrlKey","metaKey","isSelectMode","setModeAsGrab","off","Layer","draggable","opacity","constructor","toLowerCase","hasControls","hasBorders","lockMovementX","lockMovementY","selectable","_map","removeLayer","Floorplan","Image","fromURL","image","ratio","originalWidth","originalHeight","scaleToWidth","scaleX","scaleY","handler","Rect","Line","points","strokeWidth","_strokeWidth","getZoom","line","Connector","end","set","connector","global","Marker","rotation","text","textObj","Text","icon","circle","Circle","radius","links","addLinks","process","onShapeDrag","onShapeMouseDown","onShapeMouseMove","onShapeMouseUp","connectors","link","addConnectors","matrix","calcTransformMatrix","dragStart","marker","Icon","MarkerGroup","markerGroup","Polyline","_points","lineOptions","setPoints","p1","p2","getArray","addWithUpdate","setStrokeWidth","removeLines","addPoint","polyline","version"],"mappings":"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"}